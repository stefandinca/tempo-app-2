"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[443],{13316:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(3827),r=a(76853),l=a(75504);let i=[{id:"all",label:"All"},{id:"unread",label:"Unread"},{id:"schedule",label:"Schedule"},{id:"attendance",label:"Attendance"},{id:"team",label:"Team"},{id:"billing",label:"Billing"},{id:"client",label:"Client"}];function o(e){let{activeFilter:t,onFilterChange:a}=e,{getCategoryCount:o}=(0,r.useNotifications)();return(0,n.jsx)("div",{className:"overflow-x-auto scrollbar-hide -mx-4 px-4 sm:mx-0 sm:px-0",children:(0,n.jsx)("div",{className:"flex items-center gap-2 min-w-max pb-2",children:i.map(e=>{let r=t===e.id,i=o(e.id),c="all"===e.id||"unread"===e.id;return(0,n.jsxs)("button",{onClick:()=>a(e.id),className:(0,l.W)("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium transition-all whitespace-nowrap",r?"bg-primary-500 text-white shadow-sm":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:[e.label,c&&i>0&&(0,n.jsx)("span",{className:(0,l.W)("px-1.5 py-0.5 text-xs rounded-full min-w-[20px] text-center",r?"bg-white/20 text-white":"bg-neutral-200 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300"),children:i})]},e.id)})})})}},98461:function(e,t,a){a.d(t,{Z:function(){return f}});var n=a(3827),r=a(47907),l=a(97307),i=a(46578),o=a(34059),c=a(10527),s=a(11213),d=a(61524),u=a(14589),m=a(76853);let x={schedule:l.Z,attendance:i.Z,team:o.Z,billing:c.Z,client:s.Z,system:d.Z};function f(e){var t;let{notification:a,compact:l=!1,onAction:i}=e,o=(0,r.useRouter)(),{markAsRead:c}=(0,m.useNotifications)(),s=u.p[a.category];x[a.category];let d=async()=>{var e;a.read||await c(a.id);let t=null===(e=a.actions)||void 0===e?void 0:e[0];(null==t?void 0:t.type)==="navigate"&&t.route&&o.push(t.route),null==i||i()};return(0,n.jsxs)("div",{onClick:d,className:"\n        flex items-start gap-3 cursor-pointer transition-colors\n        hover:bg-neutral-50 dark:hover:bg-neutral-800/50\n        ".concat(l?"p-3":"p-4","\n        ").concat(a.read?"":"bg-primary-50/50 dark:bg-primary-900/10","\n      "),children:[(0,n.jsx)("div",{className:"flex-shrink-0 mt-1",children:a.read?(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-full border-2 ".concat(s.color.replace("text-","border-"))}):(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-full ".concat(s.color.replace("text-","bg-"))})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,n.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white ".concat("text-sm"),children:a.title}),(0,n.jsx)("span",{className:"text-xs text-neutral-400 dark:text-neutral-500 whitespace-nowrap flex-shrink-0",children:(0,u.S)(a.createdAt)})]}),(0,n.jsx)("p",{className:"text-neutral-500 dark:text-neutral-400 mt-0.5 ".concat(l?"text-xs line-clamp-1":"text-sm line-clamp-2"),children:a.message}),!l&&(null===(t=a.actions)||void 0===t?void 0:t[0])&&(0,n.jsx)("button",{className:"mt-2 text-xs font-medium ".concat(s.color," hover:underline"),children:a.actions[0].label})]})]})}},88102:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(3827),r=a(76853),l=a(98461),i=a(43345);function o(e){let{title:t,notifications:a,compact:r,onItemAction:i}=e;return 0===a.length?null:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"px-4 py-2 bg-neutral-50 dark:bg-neutral-800/50 sticky top-0 z-10",children:(0,n.jsx)("span",{className:"text-xs font-bold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:t})}),(0,n.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:a.map(e=>(0,n.jsx)(l.Z,{notification:e,compact:r,onAction:i},e.id))})]})}function c(e){let{notifications:t,compact:a=!1,showDateGroups:c=!0,onItemAction:s,emptyMessage:d="No notifications"}=e,{getGroupedNotifications:u,loading:m}=(0,r.useNotifications)();if(m)return(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})});if(0===t.length)return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-neutral-400 dark:text-neutral-500",children:[(0,n.jsx)(i.Z,{className:"w-12 h-12 mb-3"}),(0,n.jsx)("p",{className:"text-sm font-medium",children:d})]});if(!c)return(0,n.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:t.map(e=>(0,n.jsx)(l.Z,{notification:e,compact:a,onAction:s},e.id))});let x=u(t);return(0,n.jsxs)("div",{className:"divide-y divide-neutral-200 dark:divide-neutral-800",children:[(0,n.jsx)(o,{title:"Today",notifications:x.today,compact:a,onItemAction:s}),(0,n.jsx)(o,{title:"Yesterday",notifications:x.yesterday,compact:a,onItemAction:s}),(0,n.jsx)(o,{title:"This Week",notifications:x.thisWeek,compact:a,onItemAction:s}),(0,n.jsx)(o,{title:"Older",notifications:x.older,compact:a,onItemAction:s})]})}},76853:function(e,t,a){a.r(t),a.d(t,{NotificationProvider:function(){return s},useNotifications:function(){return d}});var n=a(3827),r=a(64090),l=a(58121),i=a(1221),o=a(18628);let c=(0,r.createContext)(void 0);function s(e){let{children:t}=e,{user:a}=(0,o.useAuth)(),[s,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[x,f]=(0,r.useState)(null),[h,b]=(0,r.useState)(!0),[g,p]=(0,r.useState)(null),[v,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!a){d([]),m(!1);return}m(!0);let e=(0,l.IO)((0,l.hJ)(i.db,"notifications"),(0,l.ar)("recipientId","==",a.uid),(0,l.Xo)("createdAt","desc"),(0,l.b9)(20)),t=(0,l.cf)(e,e=>{d(e.docs.map(e=>{var t,a,n;return{id:e.id,...e.data(),createdAt:(null===(n=e.data().createdAt)||void 0===n?void 0:null===(a=n.toDate)||void 0===a?void 0:null===(t=a.call(n))||void 0===t?void 0:t.toISOString())||e.data().createdAt}})),m(!1),f(null),b(20===e.docs.length),p(e.docs[e.docs.length-1]||null)},e=>{console.error("Error fetching notifications:",e),f(e.message),m(!1)});return()=>t()},[a]);let k=(0,r.useMemo)(()=>s.filter(e=>!e.read).length,[s]),w=(0,r.useCallback)(async e=>{await (0,l.r7)((0,l.JU)(i.db,"notifications",e),{read:!0,readAt:l.EK.now()})},[]),N=(0,r.useCallback)(async()=>{let e=s.filter(e=>!e.read);await Promise.all(e.map(e=>(0,l.r7)((0,l.JU)(i.db,"notifications",e.id),{read:!0,readAt:l.EK.now()})))},[s]),j=(0,r.useCallback)(e=>"all"===e?s:"unread"===e?s.filter(e=>!e.read):s.filter(t=>t.category===e),[s]),C=(0,r.useCallback)(e=>"all"===e?s.length:"unread"===e?s.filter(e=>!e.read).length:s.filter(t=>t.category===e).length,[s]),A=(0,r.useCallback)(e=>{let t=e||s,a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate()),r=new Date(n.getTime()-864e5),l=new Date(n.getTime()-6048e5),i={today:[],yesterday:[],thisWeek:[],older:[]};return t.forEach(e=>{let t=new Date(e.createdAt);t>=n?i.today.push(e):t>=r?i.yesterday.push(e):t>=l?i.thisWeek.push(e):i.older.push(e)}),i},[s]),S=(0,r.useCallback)(async()=>{if(!a||!g||!h)return;let e=(0,l.IO)((0,l.hJ)(i.db,"notifications"),(0,l.ar)("recipientId","==",a.uid),(0,l.Xo)("createdAt","desc"),(0,l.TQ)(g),(0,l.b9)(20)),t=await (0,l.PL)(e),n=t.docs.map(e=>{var t,a,n;return{id:e.id,...e.data(),createdAt:(null===(n=e.data().createdAt)||void 0===n?void 0:null===(a=n.toDate)||void 0===a?void 0:null===(t=a.call(n))||void 0===t?void 0:t.toISOString())||e.data().createdAt}});d(e=>[...e,...n]),b(20===t.docs.length),p(t.docs[t.docs.length-1]||null)},[a,g,h]);return(0,n.jsx)(c.Provider,{value:{notifications:s,unreadCount:k,loading:u,error:x,markAsRead:w,markAllAsRead:N,loadMore:S,hasMore:h,isDropdownOpen:v,setDropdownOpen:y,filterByCategory:j,getGroupedNotifications:A,getCategoryCount:C},children:t})}function d(){let e=(0,r.useContext)(c);if(!e)throw Error("useNotifications must be used within NotificationProvider");return e}},14589:function(e,t,a){a.d(t,{S:function(){return r},p:function(){return n}});let n={schedule:{label:"Schedule",color:"text-primary-500",bgColor:"bg-primary-100 dark:bg-primary-900/30",iconName:"Calendar"},attendance:{label:"Attendance",color:"text-success-500",bgColor:"bg-success-100 dark:bg-success-900/30",iconName:"CheckCircle"},team:{label:"Team",color:"text-purple-500",bgColor:"bg-purple-100 dark:bg-purple-900/30",iconName:"Users"},billing:{label:"Billing",color:"text-warning-500",bgColor:"bg-warning-100 dark:bg-warning-900/30",iconName:"CreditCard"},client:{label:"Client",color:"text-teal-500",bgColor:"bg-teal-100 dark:bg-teal-900/30",iconName:"User"},system:{label:"System",color:"text-error-500",bgColor:"bg-error-100 dark:bg-error-900/30",iconName:"AlertTriangle"}};function r(e){let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/1e3),n=Math.floor(a/60),r=Math.floor(n/60),l=Math.floor(r/24);return a<60?"Just now":n<60?"".concat(n,"m ago"):r<24?"".concat(r,"h ago"):1===l?"Yesterday":l<7?"".concat(l,"d ago"):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}}]);