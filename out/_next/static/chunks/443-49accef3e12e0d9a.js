"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[443],{13316:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(3827),l=a(20854),r=a(75504);let i=[{id:"all",label:"All"},{id:"unread",label:"Unread"},{id:"schedule",label:"Schedule"},{id:"attendance",label:"Attendance"},{id:"team",label:"Team"},{id:"billing",label:"Billing"},{id:"client",label:"Client"}];function o(e){let{activeFilter:t,onFilterChange:a}=e,{getCategoryCount:o}=(0,l.useNotifications)();return(0,n.jsx)("div",{className:"overflow-x-auto scrollbar-hide -mx-4 px-4 sm:mx-0 sm:px-0",children:(0,n.jsx)("div",{className:"flex items-center gap-2 min-w-max pb-2",children:i.map(e=>{let l=t===e.id,i=o(e.id),c="all"===e.id||"unread"===e.id;return(0,n.jsxs)("button",{onClick:()=>a(e.id),className:(0,r.W)("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium transition-all whitespace-nowrap",l?"bg-primary-500 text-white shadow-sm":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:[e.label,c&&i>0&&(0,n.jsx)("span",{className:(0,r.W)("px-1.5 py-0.5 text-xs rounded-full min-w-[20px] text-center",l?"bg-white/20 text-white":"bg-neutral-200 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300"),children:i})]},e.id)})})})}},98461:function(e,t,a){a.d(t,{Z:function(){return f}});var n=a(3827),l=a(47907),r=a(97307),i=a(46578),o=a(34059),c=a(10527),s=a(11213),d=a(61524),u=a(14589),m=a(20854);let g={schedule:r.Z,attendance:i.Z,team:o.Z,billing:c.Z,client:s.Z,system:d.Z};function f(e){var t;let{notification:a,compact:r=!1,onAction:i}=e,o=(0,l.useRouter)(),{markAsRead:c}=(0,m.useNotifications)(),s=u.p[a.category];g[a.category];let d=async()=>{var e;a.read||await c(a.id);let t=null===(e=a.actions)||void 0===e?void 0:e[0];(null==t?void 0:t.type)==="navigate"&&t.route&&o.push(t.route),null==i||i()};return(0,n.jsxs)("div",{onClick:d,className:"\n        flex items-start gap-3 cursor-pointer transition-colors\n        hover:bg-neutral-50 dark:hover:bg-neutral-800/50\n        ".concat(r?"p-3":"p-4","\n        ").concat(a.read?"":"bg-primary-50/50 dark:bg-primary-900/10","\n      "),children:[(0,n.jsx)("div",{className:"flex-shrink-0 mt-1",children:a.read?(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-full border-2 ".concat(s.color.replace("text-","border-"))}):(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-full ".concat(s.color.replace("text-","bg-"))})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,n.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white ".concat("text-sm"),children:a.title}),(0,n.jsx)("span",{className:"text-xs text-neutral-400 dark:text-neutral-500 whitespace-nowrap flex-shrink-0",children:(0,u.S)(a.createdAt)})]}),(0,n.jsx)("p",{className:"text-neutral-500 dark:text-neutral-400 mt-0.5 ".concat(r?"text-xs line-clamp-1":"text-sm line-clamp-2"),children:a.message}),!r&&(null===(t=a.actions)||void 0===t?void 0:t[0])&&(0,n.jsx)("button",{className:"mt-2 text-xs font-medium ".concat(s.color," hover:underline"),children:a.actions[0].label})]})]})}},88102:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(3827),l=a(20854),r=a(98461),i=a(43345);function o(e){let{title:t,notifications:a,compact:l,onItemAction:i}=e;return 0===a.length?null:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"px-4 py-2 bg-neutral-50 dark:bg-neutral-800/50 sticky top-0 z-10",children:(0,n.jsx)("span",{className:"text-xs font-bold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:t})}),(0,n.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:a.map(e=>(0,n.jsx)(r.Z,{notification:e,compact:l,onAction:i},e.id))})]})}function c(e){let{notifications:t,compact:a=!1,showDateGroups:c=!0,onItemAction:s,emptyMessage:d="No notifications"}=e,{getGroupedNotifications:u,loading:m}=(0,l.useNotifications)();if(m)return(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})});if(0===t.length)return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-neutral-400 dark:text-neutral-500",children:[(0,n.jsx)(i.Z,{className:"w-12 h-12 mb-3"}),(0,n.jsx)("p",{className:"text-sm font-medium",children:d})]});if(!c)return(0,n.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:t.map(e=>(0,n.jsx)(r.Z,{notification:e,compact:a,onAction:s},e.id))});let g=u(t);return(0,n.jsxs)("div",{className:"divide-y divide-neutral-200 dark:divide-neutral-800",children:[(0,n.jsx)(o,{title:"Today",notifications:g.today,compact:a,onItemAction:s}),(0,n.jsx)(o,{title:"Yesterday",notifications:g.yesterday,compact:a,onItemAction:s}),(0,n.jsx)(o,{title:"This Week",notifications:g.thisWeek,compact:a,onItemAction:s}),(0,n.jsx)(o,{title:"Older",notifications:g.older,compact:a,onItemAction:s})]})}},20854:function(e,t,a){a.r(t),a.d(t,{NotificationProvider:function(){return d},useNotifications:function(){return u}});var n=a(3827),l=a(64090),r=a(58121),i=a(1221),o=a(18628),c=a(10207);let s=(0,l.createContext)(void 0);function d(e){let{children:t}=e,{user:a}=function(){let e=(0,o.useAuth)(),t=(0,c.Sp)();return(null==e?void 0:e.user)&&!e.loading?{user:e.user,isParent:!1,isStaff:!0,loading:!1}:(null==t?void 0:t.user)&&t.isAuthenticated&&!t.loading?{user:t.user,isParent:!0,isStaff:!1,loading:!1}:{user:null,isParent:!1,isStaff:!1,loading:(null==e?void 0:e.loading)||(null==t?void 0:t.loading)||!1}}(),[d,u]=(0,l.useState)([]),[m,g]=(0,l.useState)(!0),[f,x]=(0,l.useState)(null),[h,p]=(0,l.useState)(!0),[b,v]=(0,l.useState)(null),[y,w]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!a){u([]),g(!1);return}g(!0);let e=(0,r.IO)((0,r.hJ)(i.db,"notifications"),(0,r.ar)("recipientId","==",a.uid),(0,r.Xo)("createdAt","desc"),(0,r.b9)(20)),t=(0,r.cf)(e,e=>{u(e.docs.map(e=>{var t,a,n;return{id:e.id,...e.data(),createdAt:(null===(n=e.data().createdAt)||void 0===n?void 0:null===(a=n.toDate)||void 0===a?void 0:null===(t=a.call(n))||void 0===t?void 0:t.toISOString())||e.data().createdAt}})),g(!1),x(null),p(20===e.docs.length),v(e.docs[e.docs.length-1]||null)},e=>{console.error("Error fetching notifications:",e),x(e.message),g(!1)});return()=>t()},[a]);let k=(0,l.useMemo)(()=>d.filter(e=>!e.read).length,[d]),N=(0,l.useCallback)(async e=>{await (0,r.r7)((0,r.JU)(i.db,"notifications",e),{read:!0,readAt:r.EK.now()})},[]),j=(0,l.useCallback)(async()=>{let e=d.filter(e=>!e.read);await Promise.all(e.map(e=>(0,r.r7)((0,r.JU)(i.db,"notifications",e.id),{read:!0,readAt:r.EK.now()})))},[d]),S=(0,l.useCallback)(e=>"all"===e?d:"unread"===e?d.filter(e=>!e.read):d.filter(t=>t.category===e),[d]),A=(0,l.useCallback)(e=>"all"===e?d.length:"unread"===e?d.filter(e=>!e.read).length:d.filter(t=>t.category===e).length,[d]),C=(0,l.useCallback)(e=>{let t=e||d,a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate()),l=new Date(n.getTime()-864e5),r=new Date(n.getTime()-6048e5),i={today:[],yesterday:[],thisWeek:[],older:[]};return t.forEach(e=>{let t=new Date(e.createdAt);t>=n?i.today.push(e):t>=l?i.yesterday.push(e):t>=r?i.thisWeek.push(e):i.older.push(e)}),i},[d]),I=(0,l.useCallback)(async()=>{if(!a||!b||!h)return;let e=(0,r.IO)((0,r.hJ)(i.db,"notifications"),(0,r.ar)("recipientId","==",a.uid),(0,r.Xo)("createdAt","desc"),(0,r.TQ)(b),(0,r.b9)(20)),t=await (0,r.PL)(e),n=t.docs.map(e=>{var t,a,n;return{id:e.id,...e.data(),createdAt:(null===(n=e.data().createdAt)||void 0===n?void 0:null===(a=n.toDate)||void 0===a?void 0:null===(t=a.call(n))||void 0===t?void 0:t.toISOString())||e.data().createdAt}});u(e=>[...e,...n]),p(20===t.docs.length),v(t.docs[t.docs.length-1]||null)},[a,b,h]);return(0,n.jsx)(s.Provider,{value:{notifications:d,unreadCount:k,loading:m,error:f,markAsRead:N,markAllAsRead:j,loadMore:I,hasMore:h,isDropdownOpen:y,setDropdownOpen:w,filterByCategory:S,getGroupedNotifications:C,getCategoryCount:A},children:t})}function u(){let e=(0,l.useContext)(s);if(!e)throw Error("useNotifications must be used within NotificationProvider");return e}},10207:function(e,t,a){a.d(t,{Sp:function(){return d},gx:function(){return s}});var n=a(3827),l=a(64090),r=a(27065),i=a(1221),o=a(58121);let c=(0,l.createContext)(void 0);function s(e){let{children:t}=e,[a,s]=(0,l.useState)(null),[d,u]=(0,l.useState)(null),[m,g]=(0,l.useState)(null),[f,x]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=(0,r.Aj)(i.I,async e=>{if(null==e?void 0:e.isAnonymous){s(e);let t=localStorage.getItem("parent_client_id"),a=localStorage.getItem("parent_client_name"),n=localStorage.getItem("parent_uid");t&&n===e.uid?(u(t),g(a)):(u(null),g(null))}else s(null),u(null),g(null);x(!1)});return()=>e()},[]);let h=(0,l.useCallback)(async(e,t)=>{try{let a=i.I.currentUser;a&&a.isAnonymous||(a=(await (0,r.XB)(i.I)).user);let n=(0,o.JU)(i.db,"clients",e);await (0,o.r7)(n,{parentUids:(0,o.vr)(a.uid)}),localStorage.setItem("parent_uid",a.uid),localStorage.setItem("parent_client_id",e),localStorage.setItem("parent_client_name",t),s(a),u(e),g(t),console.log("[ParentAuth] Successfully authenticated parent with UID:",a.uid)}catch(e){throw console.error("[ParentAuth] Error authenticating:",e),e}},[]),p=(0,l.useCallback)(async()=>{try{localStorage.removeItem("parent_uid"),localStorage.removeItem("parent_client_id"),localStorage.removeItem("parent_client_name"),localStorage.removeItem("parent_client_code"),await (0,r.w7)(i.I),s(null),u(null),g(null)}catch(e){console.error("[ParentAuth] Error signing out:",e)}},[]);return(0,n.jsx)(c.Provider,{value:{user:a,clientId:d,clientName:m,loading:f,isAuthenticated:null!==a&&null!==d,authenticateWithCode:h,signOut:p},children:t})}function d(){return(0,l.useContext)(c)}},14589:function(e,t,a){a.d(t,{S:function(){return l},p:function(){return n}});let n={schedule:{label:"Schedule",color:"text-primary-500",bgColor:"bg-primary-100 dark:bg-primary-900/30",iconName:"Calendar"},attendance:{label:"Attendance",color:"text-success-500",bgColor:"bg-success-100 dark:bg-success-900/30",iconName:"CheckCircle"},team:{label:"Team",color:"text-purple-500",bgColor:"bg-purple-100 dark:bg-purple-900/30",iconName:"Users"},billing:{label:"Billing",color:"text-warning-500",bgColor:"bg-warning-100 dark:bg-warning-900/30",iconName:"CreditCard"},client:{label:"Client",color:"text-teal-500",bgColor:"bg-teal-100 dark:bg-teal-900/30",iconName:"User"},system:{label:"System",color:"text-error-500",bgColor:"bg-error-100 dark:bg-error-900/30",iconName:"AlertTriangle"}};function l(e){let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/1e3),n=Math.floor(a/60),l=Math.floor(n/60),r=Math.floor(l/24);return a<60?"Just now":n<60?"".concat(n,"m ago"):l<24?"".concat(l,"h ago"):1===r?"Yesterday":r<7?"".concat(r,"d ago"):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}}]);