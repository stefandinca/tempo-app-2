(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4582],{26427:function(e,t,r){Promise.resolve().then(r.bind(r,67002))},67002:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return e6}});var a=r(3827),s=r(64090),l=r(47907),n=r(58121),i=r(1221),d=r(53879),o=r(96399),c=r(29295),x=r(18469),m=r(50489),u=r(8792),h=r(75504),p=r(18628),g=r(19685);let b=[{id:"overview",label:"Overview"},{id:"evaluations",label:"Evaluations"},{id:"programs",label:"Programs"},{id:"plan",label:"Plan"},{id:"docs",label:"Docs"}];function v(e){let{client:t,activeTab:r,onTabChange:v,onEdit:j}=e,{userRole:f}=(0,p.useAuth)(),{success:N,error:k}=(0,g.useToast)(),w=(0,l.useRouter)(),[y,C]=(0,s.useState)(!1),S=(0,s.useRef)(null),Z="Admin"===f,D=Z||"Coordinator"===f;(0,s.useEffect)(()=>{let e=e=>{S.current&&!S.current.contains(e.target)&&C(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let P=async()=>{try{let e=(0,n.JU)(i.db,"clients",t.id);await (0,n.r7)(e,{isArchived:!t.isArchived}),N(t.isArchived?"Client restored":"Client archived"),C(!1)}catch(e){console.error(e),k("Failed to update status")}},A=async()=>{if(confirm("Are you sure you want to PERMANENTLY delete ".concat(t.name,"? This cannot be undone.")))try{await (0,n.oe)((0,n.JU)(i.db,"clients",t.id)),N("Client deleted forever"),w.push("/clients/")}catch(e){console.error(e),k("Failed to delete client")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(u.default,{href:"/clients/",className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(d.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:t.name}),t.isArchived&&(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-warning-100 text-warning-700 dark:bg-warning-900/30 dark:text-warning-400 text-[10px] font-bold uppercase rounded-md flex items-center gap-1",children:[(0,a.jsx)(o.Z,{className:"w-3 h-3"}),"Archived"]})]})]}),D&&(0,a.jsxs)("div",{className:"flex items-center gap-2 relative",ref:S,children:[(0,a.jsxs)("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 border border-neutral-200 dark:border-neutral-800 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors text-sm font-medium",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4"}),"Edit Profile"]}),(0,a.jsx)("button",{onClick:()=>C(!y),className:(0,h.W)("p-2 rounded-lg border border-neutral-200 dark:border-neutral-800 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",y&&"bg-neutral-100 dark:bg-neutral-800"),children:(0,a.jsx)(x.Z,{className:"w-5 h-5 text-neutral-500"})}),y&&(0,a.jsx)("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:(0,a.jsxs)("div",{className:"p-1",children:[(0,a.jsxs)("button",{onClick:P,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),t.isArchived?"Restore Client":"Archive Client"]}),Z&&(0,a.jsxs)("button",{onClick:A,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 rounded-lg transition-colors",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Delete Permanently"]})]})})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 border-b border-neutral-200 dark:border-neutral-800 overflow-x-auto scrollbar-hide",children:b.map(e=>(0,a.jsxs)("button",{onClick:()=>v(e.id),className:(0,h.W)("px-6 py-3 text-sm font-medium transition-all relative whitespace-nowrap",r===e.id?"text-primary-600 dark:text-primary-400":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[e.label,r===e.id&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"})]},e.id))})]})}var j=r(11213),f=r(85904),N=r(90684),k=r(89142),w=r(65),y=r(20933),C=r(80037),S=r(23416),Z=r(40834),D=r(97307),P=r(18994),A=r(26490),E=r(26503),W=r(69475),I=r(92379),L=r(37805),T=r(2335),F=r(89006),M=r(50171);function B(e){var t;let{client:l,pendingAction:d,onActionHandled:o}=e,{data:c}=(0,T.lU)(),{data:x,loading:m}=(0,T.we)(l.id),{evaluations:p,loading:b}=(0,F.F3)(l.id),{success:v,error:B}=(0,g.useToast)(),[O,z]=(0,s.useState)(!1),[R,U]=(0,s.useState)(!1),[V,G]=(0,s.useState)(!1),J=(c||[]).find(e=>e.id===l.assignedTherapistId),H=e=>new Date(e?e.seconds?1e3*e.seconds:e:0),_=(null==x?void 0:x.length)||0,q=(null==x?void 0:x.filter(e=>"completed"===e.status))||[],K=q.filter(e=>"present"===e.attendance).length,Y=q.length>0?Math.round(K/q.length*100):0,Q=(null===(t=l.programIds)||void 0===t?void 0:t.length)||0,$=new Date,X=(x||[]).filter(e=>H(e.startTime)>=$).sort((e,t)=>H(e.startTime).getTime()-H(t.startTime).getTime()).slice(0,3),ee=async()=>{z(!0);try{let e=l.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),t="".concat(e,"-").concat(Math.floor(1e3+9e3*Math.random()));await (0,n.r7)((0,n.JU)(i.db,"clients",l.id),{clientCode:t}),v("New access code generated!")}catch(e){console.error(e),B("Failed to generate code")}finally{z(!1)}},et=async()=>{G(!0);try{let{default:e}=await Promise.resolve().then(r.bind(r,92493)),{default:t}=await Promise.resolve().then(r.bind(r,25264)),a=new e,s=a.internal.pageSize.getWidth();if(a.setFontSize(20),a.setFont("helvetica","bold"),a.text("Client Progress Report",s/2,20,{align:"center"}),a.setFontSize(12),a.setFont("helvetica","normal"),a.text("Client: ".concat(l.name),20,35),a.text("Generated: ".concat(new Date().toLocaleDateString()),20,42),J&&a.text("Therapist: ".concat(J.name),20,49),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Summary Statistics",20,65),a.setFontSize(11),a.setFont("helvetica","normal"),a.text("Total Sessions: ".concat(_),25,75),a.text("Completed Sessions: ".concat(q.length),25,82),a.text("Attendance Rate: ".concat(Y,"%"),25,89),a.text("Active Programs: ".concat(Q),25,96),x&&x.length>0){a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Session History",20,115);let e=x.sort((e,t)=>H(t.startTime).getTime()-H(e.startTime).getTime()).slice(0,20).map(e=>[H(e.startTime).toLocaleDateString(),e.type||e.title||"Session",e.status||"N/A",e.attendance||"N/A"]);t(a,{startY:120,head:[["Date","Type","Status","Attendance"]],body:e,theme:"striped",headStyles:{fillColor:[74,144,226]},styles:{fontSize:9}})}a.save("".concat(l.name.replace(/\s+/g,"_"),"_Report_").concat(new Date().toISOString().split("T")[0],".pdf")),v("Report generated successfully!")}catch(e){console.error("Error generating report:",e),B("Failed to generate report")}finally{G(!1)}};return(0,s.useEffect)(()=>{"generate-report"!==d||m||(et(),null==o||o())},[d,m]),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-in fade-in duration-500",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Contact Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Parent / Guardian"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium",children:l.parentName||"Not provided"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Phone Number"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 text-neutral-400"}),l.phone?(0,a.jsx)("a",{href:"tel:".concat(l.phone),className:"font-medium hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:l.phone}):(0,a.jsx)("span",{className:"font-medium",children:"Not provided"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Email Address"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium",children:l.parentEmail||"Not provided"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Birth Date"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(k.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium",children:l.birthDate?new Date(l.birthDate).toLocaleDateString("ro-RO",{day:"2-digit",month:"long",year:"numeric"}):"Not provided"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)(w.Z,{className:"w-5 h-5 text-warning-500"}),"Medical Information & Notes"]}),(0,a.jsx)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl border border-neutral-100 dark:border-neutral-800",children:(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed italic",children:["“",l.medicalInfo||"No medical alerts or clinical notes provided for this client.","”"]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Assigned Therapy Team"}),J?(0,a.jsxs)(u.default,{href:"/team/",className:"flex items-center gap-4 p-3 border border-neutral-100 dark:border-neutral-800 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors w-fit pr-8 group",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:J.color},children:J.initials}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-neutral-900 dark:text-white group-hover:text-primary-600 transition-colors",children:J.name}),(0,a.jsx)("p",{className:"text-sm text-primary-600 dark:text-primary-400 font-medium",children:J.role})]})]}):(0,a.jsx)("p",{className:"text-sm text-neutral-500 italic",children:"No therapist assigned yet."})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm overflow-hidden relative",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:(0,a.jsx)(y.Z,{className:"w-20 h-24"})}),(0,a.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)(y.Z,{className:"w-5 h-5 text-primary-500"}),"Portal Access"]}),l.clientCode?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800 rounded-xl border border-neutral-100 dark:border-neutral-800 text-center",children:[(0,a.jsx)("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mb-1",children:"Current Access Code"}),(0,a.jsx)("p",{className:"text-2xl font-mono font-bold text-primary-600 tracking-wider uppercase",children:l.clientCode})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(!l.clientCode)return;let e=window.location.origin,t=e.includes("localhost")?"/parent":"/v2/parent",r="".concat(e).concat(t,"/?code=").concat(l.clientCode);navigator.clipboard.writeText(r),U(!0),v("Invite link copied to clipboard!"),setTimeout(()=>U(!1),2e3)},className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 rounded-xl text-sm font-bold hover:opacity-90 transition-all",children:[R?(0,a.jsx)(C.Z,{className:"w-4 h-4"}):(0,a.jsx)(S.Z,{className:"w-4 h-4"}),R?"Copied!":"Copy Invite Link"]}),(0,a.jsx)("button",{onClick:ee,disabled:O,className:"p-2.5 border border-neutral-200 dark:border-neutral-800 rounded-xl text-neutral-500 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all disabled:opacity-50",title:"Reset Code",children:(0,a.jsx)(Z.Z,{className:(0,h.W)("w-5 h-5",O&&"animate-spin")})})]}),(0,a.jsx)("p",{className:"text-[10px] text-neutral-500 text-center leading-relaxed",children:"Parents can access the portal using this code or by clicking the unique invite link."})]}):(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"py-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-500 mb-4",children:"Portal access is not yet configured for this client."}),(0,a.jsxs)("button",{onClick:ee,disabled:O,className:"w-full flex items-center justify-center gap-2 py-3 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-all shadow-lg shadow-primary-500/20 disabled:opacity-70",children:[O?(0,a.jsx)(Z.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(y.Z,{className:"w-5 h-5"}),"Generate Access Code"]})]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Quick Stats"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Total Sessions"})]}),(0,a.jsx)("span",{className:"font-bold text-neutral-900 dark:text-white",children:m?(0,a.jsx)(P.Z,{className:"w-3 h-3 animate-spin"}):_})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Attendance Rate"})]}),(0,a.jsx)("span",{className:(0,h.W)("font-bold",Y>=90?"text-success-600":Y>=75?"text-warning-600":"text-error-600"),children:m?(0,a.jsx)(P.Z,{className:"w-3 h-3 animate-spin"}):"".concat(Y,"%")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Active Programs"})]}),(0,a.jsx)("span",{className:"font-bold text-primary-600",children:Q})]})]}),(0,a.jsxs)("button",{onClick:et,disabled:V||m,className:"w-full mt-4 flex items-center justify-center gap-2 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all disabled:opacity-50",children:[V?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(W.Z,{className:"w-4 h-4"}),V?"Generating...":"Generate Report"]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)(I.Z,{className:"w-5 h-5 text-primary-500"}),"Latest Evaluation"]}),b?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(P.Z,{className:"w-6 h-6 animate-spin text-neutral-300"})}):p.length>0?(()=>{let e=p.find(e=>"completed"===e.status)||p[0],t=p.find((e,t)=>t>0&&"completed"===e.status);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-2",children:(0,a.jsx)(M.Z,{evaluation:e,previousEvaluation:t,size:"sm",showLegend:!1})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:e.type}),(0,a.jsx)("p",{className:"text-xs text-neutral-400",children:new Date(e.completedAt||e.updatedAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,h.W)("text-2xl font-bold",e.overallPercentage>=70?"text-success-600":e.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[e.overallPercentage,"%"]}),(0,a.jsx)("p",{className:"text-xs text-neutral-400",children:"completed"===e.status?"Completed":"In Progress"})]})]}),(0,a.jsxs)(u.default,{href:"/clients/profile?id=".concat(l.id,"&tab=evaluations"),className:"w-full flex items-center justify-center gap-2 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all",children:["View All Evaluations",(0,a.jsx)(L.Z,{className:"w-4 h-4"})]})]})})():(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-500 mb-4",children:"No evaluations yet"}),(0,a.jsxs)(u.default,{href:"/clients/profile?id=".concat(l.id,"&tab=evaluations"),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-xl text-sm font-bold transition-colors",children:[(0,a.jsx)(I.Z,{className:"w-4 h-4"}),"Start Evaluation"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Upcoming Schedule"}),m?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(P.Z,{className:"w-6 h-6 animate-spin text-neutral-300"})}):X.length>0?(0,a.jsxs)("div",{className:"space-y-3",children:[X.map(e=>{let t=H(e.startTime),r=t.toDateString()===new Date().toDateString();return(0,a.jsxs)("div",{className:"p-3 bg-primary-50 dark:bg-primary-900/20 rounded-xl border border-primary-100 dark:border-primary-900/50",children:[(0,a.jsx)("p",{className:"text-xs font-bold text-primary-600 dark:text-primary-400 uppercase",children:r?"Today":t.toLocaleDateString("en-US",{weekday:"long"})}),(0,a.jsx)("p",{className:"text-sm font-bold text-neutral-900 dark:text-white mt-1",children:e.type}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",e.duration," min"]})]},e.id)}),(0,a.jsx)("button",{className:"w-full py-2 text-sm font-bold text-primary-600 dark:text-primary-400 hover:underline",children:"View full calendar"})]}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-sm text-neutral-500 italic",children:"No upcoming sessions found."})})]})]})]})}var O=r(70094),z=r(14562);function R(e){let{client:t}=e,{data:r,loading:s}=(0,T.b$)(),l=(r||[]).filter(e=>{var r;return null===(r=t.programIds)||void 0===r?void 0:r.includes(e.id)});return s?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,a.jsx)(P.Z,{className:"w-10 h-10 animate-spin mb-4"}),(0,a.jsx)("p",{children:"Loading programs..."})]}):(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Assigned Programs"}),(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-xl text-sm font-bold transition-colors",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),"Assign Program"]})]}),l.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm hover:border-primary-500/50 transition-all group",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-50 dark:bg-primary-900/20 rounded-xl flex items-center justify-center text-primary-600 group-hover:bg-primary-100 dark:group-hover:bg-primary-900/40 transition-colors",children:(0,a.jsx)(z.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-1 line-clamp-2",children:e.description||"No description provided for this program."}),(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs font-medium px-2 py-1 bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 rounded-lg",children:"Status: Active"}),(0,a.jsx)("button",{className:"text-sm font-bold text-primary-600 hover:underline",children:"View Details"})]})]})]})},e.id))}):(0,a.jsxs)("div",{className:"py-20 text-center bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(z.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"No programs assigned"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-1 max-w-sm mx-auto",children:"This client doesn't have any therapy programs assigned yet. Click the button above to start assigning programs."})]})]})}var U=r(56227),V=r(64178),G=r(85159),J=r(23441),H=r(46578),_=r(52235),q=r(28670);function K(e){let{isOpen:t,onClose:r,clientId:l,existingPlan:d}=e,{success:o,error:c}=(0,g.useToast)(),{data:x,loading:u}=(0,T.b$)(),[p,b]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[f,N]=(0,s.useState)(""),[k,w]=(0,s.useState)({name:"",startDate:"",endDate:"",programIds:[],status:"active"});(0,s.useEffect)(()=>{if(d)w({name:d.name,startDate:d.startDate,endDate:d.endDate,programIds:d.programIds,status:d.status});else{let e=new Date,t=new Date;t.setMonth(t.getMonth()+3),w({name:"",startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0],programIds:[],status:"active"})}N("")},[d,t]);let y=(x||[]).filter(e=>e.title.toLowerCase().includes(f.toLowerCase())||(e.description||"").toLowerCase().includes(f.toLowerCase())),S=e=>{w(t=>({...t,programIds:t.programIds.includes(e)?t.programIds.filter(t=>t!==e):[...t.programIds,e]}))},Z=()=>k.name.trim()?k.startDate?k.endDate?new Date(k.endDate)<=new Date(k.startDate)?"End date must be after start date":0===k.programIds.length?"Select at least one program":null:"End date is required":"Start date is required":"Plan name is required",D=async e=>{e.preventDefault();let t=Z();if(t){c(t);return}b(!0);try{let e={name:k.name.trim(),startDate:k.startDate,endDate:k.endDate,programIds:k.programIds,status:k.status,...d?{}:{createdAt:new Date().toISOString()}};if(d){let t=(0,n.JU)(i.db,"clients",l,"interventionPlans",d.id);await (0,n.r7)(t,e),o("Plan updated successfully")}else await (0,n.ET)((0,n.hJ)(i.db,"clients",l,"interventionPlans"),e),o("Plan created successfully");r()}catch(e){console.error(e),c(d?"Failed to update plan":"Failed to create plan")}finally{b(!1)}},A=async()=>{if(d&&confirm('Delete "'.concat(d.name,'"? This action cannot be undone.'))){j(!0);try{await (0,n.oe)((0,n.JU)(i.db,"clients",l,"interventionPlans",d.id)),o("Plan deleted"),r()}catch(e){console.error(e),c("Failed to delete plan")}finally{j(!1)}}};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-lg bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 text-primary-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(U.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:d?"Edit Intervention Plan":"Create Intervention Plan"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:d?"Modify plan details":"Set up programs for this client"})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800",children:(0,a.jsx)(_.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("form",{onSubmit:D,className:"flex-1 overflow-y-auto p-6 space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Plan Name ",(0,a.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",required:!0,placeholder:"e.g. Q1 2026 Intervention",className:"w-full px-3 py-2.5 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500",value:k.name,onChange:e=>w({...k,name:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Start Date ",(0,a.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,a.jsx)("input",{type:"date",required:!0,className:"w-full px-3 py-2.5 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500",value:k.startDate,onChange:e=>w({...k,startDate:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["End Date ",(0,a.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,a.jsx)("input",{type:"date",required:!0,className:"w-full px-3 py-2.5 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500",value:k.endDate,onChange:e=>w({...k,endDate:e.target.value})})]})]}),d&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Status"}),(0,a.jsx)("div",{className:"flex gap-2",children:["active","draft","completed"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>w({...k,status:e}),className:(0,h.W)("flex-1 py-2 rounded-lg text-sm font-medium transition-all border capitalize",k.status===e?"active"===e?"bg-success-500 border-success-600 text-white":"draft"===e?"bg-warning-500 border-warning-600 text-white":"bg-neutral-500 border-neutral-600 text-white":"bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700 text-neutral-600 dark:text-neutral-400"),children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Select Programs ",(0,a.jsx)("span",{className:"text-error-500",children:"*"}),(0,a.jsxs)("span",{className:"ml-2 text-xs text-neutral-500 font-normal",children:["(",k.programIds.length," selected)"]})]}),(0,a.jsxs)("div",{className:"relative mb-3",children:[(0,a.jsx)(q.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search programs...",className:"w-full pl-9 pr-4 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 text-sm",value:f,onChange:e=>N(e.target.value)})]}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-1.5 pr-1",children:u?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(P.Z,{className:"w-6 h-6 animate-spin text-primary-500"})}):0===y.length?(0,a.jsx)("p",{className:"text-center py-4 text-sm text-neutral-500",children:"No programs found"}):y.map(e=>{let t=k.programIds.includes(e.id);return(0,a.jsxs)("div",{onClick:()=>S(e.id),className:(0,h.W)("flex items-center gap-3 p-2.5 rounded-lg border cursor-pointer transition-all",t?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-neutral-200 dark:border-neutral-700 hover:border-primary-300"),children:[(0,a.jsx)("div",{className:(0,h.W)("w-5 h-5 rounded border flex items-center justify-center flex-shrink-0",t?"bg-primary-500 border-primary-500 text-white":"border-neutral-300 dark:border-neutral-600"),children:t&&(0,a.jsx)(C.Z,{className:"w-3 h-3"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white truncate flex items-center gap-1.5",children:[(0,a.jsx)(z.Z,{className:"w-3 h-3 text-neutral-400 flex-shrink-0"}),e.title]}),e.description&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 truncate",children:e.description})]})]},e.id)})})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[d&&(0,a.jsx)("button",{type:"button",onClick:A,disabled:v,className:"p-2.5 border border-error-200 dark:border-error-800 text-error-600 rounded-xl hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors disabled:opacity-50",children:v?(0,a.jsx)(P.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(m.Z,{className:"w-5 h-5"})}),(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 font-bold transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:p,className:"flex-1 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-all flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:p?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):d?"Save Changes":"Create Plan"})]})]})]})]}):null}function Y(e){let{client:t,pendingAction:r,onActionHandled:l}=e,{data:d,loading:o,activePlan:x}=(0,T.Rn)(t.id),{data:m}=(0,T.b$)(),{success:u,error:p}=(0,g.useToast)(),[b,v]=(0,s.useState)(!1),[j,f]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{"create-plan"!==r||o||(v(!0),null==l||l())},[r,o,l]);let w=d.filter(e=>"completed"===e.status),y=d.filter(e=>"draft"===e.status),C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),S=e=>{let t=new Date(e),r=new Date;return Math.ceil((t.getTime()-r.getTime())/864e5)},Z=async e=>{if(confirm('End "'.concat(e.name,'"? This will mark the plan as completed.')))try{let r=(0,n.JU)(i.db,"clients",t.id,"interventionPlans",e.id);await (0,n.r7)(r,{status:"completed"}),u("Plan marked as completed")}catch(e){console.error(e),p("Failed to update plan")}},E=async e=>{if(x&&x.id!==e.id){if(!confirm("There's already an active plan. Activating this will end \"".concat(x.name,'". Continue?')))return;let e=(0,n.JU)(i.db,"clients",t.id,"interventionPlans",x.id);await (0,n.r7)(e,{status:"completed"})}try{let r=(0,n.JU)(i.db,"clients",t.id,"interventionPlans",e.id);await (0,n.r7)(r,{status:"active"}),u("Plan activated")}catch(e){console.error(e),p("Failed to activate plan")}};return o?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[x?(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:(0,a.jsx)(U.Z,{className:"w-6 h-6 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:x.name}),(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400 text-xs font-bold rounded-full flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 bg-success-500 rounded-full animate-pulse"}),"Active"]})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5",children:"Intervention Plan"})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("button",{onClick:()=>f(x),className:"p-2 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-neutral-500"})})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 mb-6 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:[C(x.startDate)," → ",C(x.endDate)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:(0,h.W)("text-sm font-medium",7>=S(x.endDate)?"text-warning-600":"text-neutral-600 dark:text-neutral-400"),children:S(x.endDate)>0?"".concat(S(x.endDate)," days remaining"):"Plan ended"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-xs font-semibold text-neutral-500 uppercase tracking-wider mb-3",children:["Programs (",x.programIds.length,")"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:x.programIds.map(e=>{var t;return(null===(t=m.find(t=>t.id===e))||void 0===t?void 0:t.title)||e}).filter(Boolean).map((e,t)=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300 text-sm font-medium rounded-lg",children:[(0,a.jsx)(z.Z,{className:"w-3.5 h-3.5"}),e]},t))})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-100 dark:border-neutral-800",children:[(0,a.jsx)("button",{onClick:()=>f(x),className:"flex-1 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 font-medium transition-colors text-sm",children:"Edit Plan"}),(0,a.jsx)("button",{onClick:()=>Z(x),className:"flex-1 py-2.5 bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 rounded-xl font-medium transition-colors text-sm hover:bg-neutral-800 dark:hover:bg-neutral-100",children:"End Plan"})]})]})}):(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 p-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(V.Z,{className:"w-8 h-8 text-neutral-400"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No Active Intervention Plan"}),(0,a.jsx)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-6",children:"Create a plan to automatically assign programs to this client's therapy sessions."}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"inline-flex items-center gap-2 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-primary-500/20",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),"Create Intervention Plan"]})]}),y.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider",children:["Draft Plans (",y.length,")"]}),y.map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-xl border border-neutral-200 dark:border-neutral-800 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-neutral-100 dark:bg-neutral-800 rounded-lg flex items-center justify-center",children:(0,a.jsx)(V.Z,{className:"w-5 h-5 text-neutral-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[C(e.startDate)," → ",C(e.endDate)," \xb7 ",e.programIds.length," programs"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>f(e),className:"px-3 py-1.5 text-xs font-medium text-neutral-600 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>E(e),className:"px-3 py-1.5 text-xs font-medium bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Activate"})]})]})},e.id))]}),x&&(0,a.jsxs)("button",{onClick:()=>v(!0),className:"w-full py-3 border-2 border-dashed border-neutral-200 dark:border-neutral-700 rounded-xl text-neutral-500 hover:border-primary-300 hover:text-primary-600 transition-colors font-medium flex items-center justify-center gap-2",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),"Create New Plan"]}),w.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>k(!N),className:"flex items-center gap-2 text-sm font-semibold text-neutral-500 uppercase tracking-wider hover:text-neutral-700 transition-colors",children:[(0,a.jsxs)("span",{children:["Plan History (",w.length,")"]}),N?(0,a.jsx)(G.Z,{className:"w-4 h-4"}):(0,a.jsx)(J.Z,{className:"w-4 h-4"})]}),N&&(0,a.jsx)("div",{className:"space-y-2 animate-in slide-in-from-top-2 duration-200",children:w.map(e=>(0,a.jsx)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-4 border border-neutral-100 dark:border-neutral-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-neutral-200 dark:bg-neutral-700 rounded-lg flex items-center justify-center",children:(0,a.jsx)(H.Z,{className:"w-4 h-4 text-neutral-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[C(e.startDate)," → ",C(e.endDate)," \xb7 ",e.programIds.length," programs"]})]})]}),(0,a.jsx)("span",{className:"text-xs text-neutral-400 font-medium",children:"Completed"})]})},e.id))})]}),(0,a.jsx)(K,{isOpen:b||!!j,onClose:()=>{v(!1),f(null)},clientId:t.id,existingPlan:j})]})}var Q=r(65561),$=r(80031),X=r(77329),ee=r(3428),et=r(10632),er=r(61172),ea=r(37841),es=r(44715),el=r(51930),en=r(24905);function ei(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}var ed=r(12228);let eo=[{id:"assessment",label:"Assessment",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},{id:"report",label:"Report",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},{id:"consent",label:"Consent Form",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"},{id:"other",label:"Other",color:"bg-neutral-100 text-neutral-700 dark:bg-neutral-800 dark:text-neutral-400"}];function ec(e){return e.includes("pdf")?(0,a.jsx)(W.Z,{className:"w-5 h-5"}):e.includes("image")?(0,a.jsx)(Q.Z,{className:"w-5 h-5"}):e.includes("sheet")||e.includes("excel")?(0,a.jsx)($.Z,{className:"w-5 h-5"}):e.includes("presentation")||e.includes("powerpoint")?(0,a.jsx)(X.Z,{className:"w-5 h-5"}):(0,a.jsx)(ee.Z,{className:"w-5 h-5"})}function ex(e){var t;let{client:r}=e,{user:l,userData:d}=(0,p.useAuth)(),{success:o,error:c}=(0,g.useToast)(),{documents:u,loading:b,uploadDocument:v,deleteDocument:j,toggleParentAccess:f}=function(e){let[t,r]=(0,s.useState)([]),[a,l]=(0,s.useState)(!0),[d,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(!e){l(!1);return}let t=(0,n.IO)((0,n.hJ)(i.db,"clients",e,"documents"),(0,n.Xo)("uploadedAt","desc")),a=(0,n.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),r(t),l(!1)},e=>{console.error("Error fetching documents:",e),o(e.message),l(!1)});return()=>a()},[e]),{documents:t,loading:a,error:d,uploadDocument:async(t,r,a)=>{if(!e)return null;try{let s=Date.now(),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),d="clients/".concat(e,"/documents/").concat(s,"_").concat(l),o=(0,en.iH)(i.tO,d);return new Promise((s,l)=>{let c=(0,en.B0)(o,t);c.on("state_changed",e=>{let t=e.bytesTransferred/e.totalBytes*100;null==a||a(t)},e=>{console.error("Upload error:",e),l(e)},async()=>{let a=await (0,en.Jt)(c.snapshot.ref),l={name:r.name,fileName:t.name,fileType:t.type,fileSize:t.size,storagePath:d,downloadUrl:a,uploadedBy:r.uploadedBy,uploadedByName:r.uploadedByName,uploadedAt:(0,n.Bt)(),category:r.category,description:r.description||"",sharedWithParent:r.sharedWithParent},o=await (0,n.ET)((0,n.hJ)(i.db,"clients",e,"documents"),l);s({id:o.id,...l})})})}catch(e){throw console.error("Error uploading document:",e),e}},deleteDocument:async t=>{if(e)try{let r=(0,en.iH)(i.tO,t.storagePath);await (0,en.oq)(r),await (0,n.oe)((0,n.JU)(i.db,"clients",e,"documents",t.id))}catch(e){throw console.error("Error deleting document:",e),e}},toggleParentAccess:async(t,r)=>{if(e)try{await (0,n.r7)((0,n.JU)(i.db,"clients",e,"documents",t),{sharedWithParent:r})}catch(e){throw console.error("Error updating document access:",e),e}}}}(r.id),[N,k]=(0,s.useState)(!1),[w,y]=(0,s.useState)(0),[C,S]=(0,s.useState)(!1),[Z,D]=(0,s.useState)(null),[A,E]=(0,s.useState)(""),[W,I]=(0,s.useState)("other"),[L,T]=(0,s.useState)(""),[F,M]=(0,s.useState)(!0),[B,z]=(0,s.useState)(null),[R,U]=(0,s.useState)("all"),V=(0,s.useRef)(null),G=async()=>{if(Z&&A.trim()){S(!0),y(0);try{let t=await v(Z,{name:A.trim(),category:W,description:L.trim(),sharedWithParent:F,uploadedBy:(null==l?void 0:l.uid)||"",uploadedByName:(null==d?void 0:d.name)||(null==l?void 0:l.email)||"Unknown"},e=>y(e));if(F&&t){var e;let a=(null===(e=eo.find(e=>e.id===W))||void 0===e?void 0:e.label)||"Document";try{await (0,ed.co)(r.id,{documentId:t.id,documentName:A.trim(),documentCategory:a,sharedByName:(null==d?void 0:d.name)||(null==l?void 0:l.email)||"Your therapy team",triggeredByUserId:(null==l?void 0:l.uid)||""})}catch(e){console.error("Failed to send notification:",e)}}o("Document uploaded successfully"),q(),k(!1)}catch(e){c("Failed to upload document")}finally{S(!1)}}},J=async e=>{if(confirm('Are you sure you want to delete "'.concat(e.name,'"? This cannot be undone.')))try{await j(e),o("Document deleted"),z(null)}catch(e){c("Failed to delete document")}},H=async e=>{let t=!e.sharedWithParent;try{if(await f(e.id,t),t){var a;let t=(null===(a=eo.find(t=>t.id===e.category))||void 0===a?void 0:a.label)||"Document";try{await (0,ed.co)(r.id,{documentId:e.id,documentName:e.name,documentCategory:t,sharedByName:(null==d?void 0:d.name)||(null==l?void 0:l.email)||"Your therapy team",triggeredByUserId:(null==l?void 0:l.uid)||""})}catch(e){console.error("Failed to send notification:",e)}}o(e.sharedWithParent?"Document hidden from parent":"Document shared with parent"),z(null)}catch(e){c("Failed to update document access")}},q=()=>{D(null),E(""),I("other"),T(""),M(!0),y(0),V.current&&(V.current.value="")},K="all"===R?u:u.filter(e=>e.category===R);return b?(0,a.jsxs)("div",{className:"py-20 flex flex-col items-center justify-center",children:[(0,a.jsx)(P.Z,{className:"w-8 h-8 animate-spin text-primary-500 mb-4"}),(0,a.jsx)("p",{className:"text-neutral-500",children:"Loading documents..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Documents"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[u.length," document",1!==u.length?"s":""," • ",u.filter(e=>e.sharedWithParent).length," shared with parent"]})]}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors",children:[(0,a.jsx)(et.Z,{className:"w-4 h-4"}),"Upload Document"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>U("all"),className:(0,h.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors","all"===R?"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-400":"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:"All"}),eo.map(e=>(0,a.jsx)("button",{onClick:()=>U(e.id),className:(0,h.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",R===e.id?e.color:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:e.label},e.id))]}),0===K.length?(0,a.jsxs)("div",{className:"py-16 text-center bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(er.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"No documents"}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm mt-1 mb-6",children:"all"===R?"Upload documents for this client to get started.":"No ".concat(null===(t=eo.find(e=>e.id===R))||void 0===t?void 0:t.label.toLowerCase()," documents found.")}),"all"===R&&(0,a.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),"Upload First Document"]})]}):(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:(0,a.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:K.map(e=>{var t,r;let s=eo.find(t=>t.id===e.category);return(0,a.jsx)("div",{className:"p-4 hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-neutral-100 dark:bg-neutral-800 rounded-lg flex items-center justify-center text-neutral-500 flex-shrink-0",children:ec(e.fileType)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-medium text-neutral-900 dark:text-white truncate",children:e.name}),(0,a.jsx)("span",{className:(0,h.W)("px-2 py-0.5 text-xs font-medium rounded-full",null==s?void 0:s.color),children:null==s?void 0:s.label}),e.sharedWithParent&&(0,a.jsxs)("span",{className:"flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:[(0,a.jsx)(ea.Z,{className:"w-3 h-3"}),"Parent"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-neutral-500",children:[(0,a.jsx)("span",{children:ei(e.fileSize)}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e.uploadedByName}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:(null===(r=e.uploadedAt)||void 0===r?void 0:null===(t=r.toDate)||void 0===t?void 0:t.call(r))?new Date(e.uploadedAt.toDate()).toLocaleDateString():"Just now"})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-1 truncate",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,a.jsx)("a",{href:e.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",title:"Download",children:(0,a.jsx)(es.Z,{className:"w-4 h-4 text-neutral-500"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>z(B===e.id?null:e.id),className:(0,h.W)("p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",B===e.id&&"bg-neutral-100 dark:bg-neutral-800"),children:(0,a.jsx)(x.Z,{className:"w-4 h-4 text-neutral-500"})}),B===e.id&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>z(null)}),(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl shadow-xl z-20 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:(0,a.jsxs)("div",{className:"p-1",children:[(0,a.jsx)("button",{onClick:()=>H(e),className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:e.sharedWithParent?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(el.Z,{className:"w-4 h-4"}),"Hide from Parent"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ea.Z,{className:"w-4 h-4"}),"Share with Parent"]})}),(0,a.jsxs)("button",{onClick:()=>J(e),className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 rounded-lg transition-colors",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Delete"]})]})})]})]})]})]})},e.id)})})}),N&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>!C&&k(!1)}),(0,a.jsxs)("div",{className:"relative w-full max-w-md bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl animate-in fade-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Upload Document"}),(0,a.jsx)("button",{onClick:()=>!C&&k(!1),disabled:C,className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors disabled:opacity-50",children:(0,a.jsx)(_.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"File"}),(0,a.jsx)("input",{ref:V,type:"file",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(r.size>10485760){c("File size must be less than 10MB");return}D(r),E(r.name.replace(/\.[^/.]+$/,""))}},disabled:C,className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.png,.jpg,.jpeg,.gif"}),Z?(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-xl",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-lg flex items-center justify-center text-primary-600",children:ec(Z.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:Z.name}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:ei(Z.size)})]}),(0,a.jsx)("button",{onClick:()=>{D(null),V.current&&(V.current.value="")},disabled:C,className:"p-1 rounded hover:bg-neutral-200 dark:hover:bg-neutral-700",children:(0,a.jsx)(_.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=V.current)||void 0===e?void 0:e.click()},disabled:C,className:"w-full p-6 border-2 border-dashed border-neutral-300 dark:border-neutral-700 rounded-xl hover:border-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/10 transition-colors",children:[(0,a.jsx)(et.Z,{className:"w-8 h-8 text-neutral-400 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-600 dark:text-neutral-400",children:"Click to select a file"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"PDF, Word, Excel, PowerPoint, Images (max 10MB)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Document Name"}),(0,a.jsx)("input",{type:"text",value:A,onChange:e=>E(e.target.value),disabled:C,placeholder:"e.g., Initial Assessment Report",className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Category"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:eo.map(e=>(0,a.jsx)("button",{onClick:()=>I(e.id),disabled:C,className:(0,h.W)("px-3 py-2 text-sm font-medium rounded-lg transition-colors",W===e.id?e.color:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:e.label},e.id))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description (optional)"}),(0,a.jsx)("textarea",{value:L,onChange:e=>T(e.target.value),disabled:C,placeholder:"Brief description of the document...",rows:2,className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-xl resize-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-50"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-xl cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:F,onChange:e=>M(e.target.checked),disabled:C,className:"w-5 h-5 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"Share with parent"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Parent can view and download this document"})]})]}),C&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Uploading..."}),(0,a.jsxs)("span",{className:"font-medium",children:[Math.round(w),"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:"".concat(w,"%")}})})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 p-4 border-t border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("button",{onClick:()=>{q(),k(!1)},disabled:C,className:"flex-1 px-4 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl font-medium hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:G,disabled:!Z||!A.trim()||C,className:"flex-1 px-4 py-2.5 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(et.Z,{className:"w-4 h-4"}),"Upload"]})})]})]})]})]})}var em=r(29733);function eu(e){let{clientId:t,clientName:r,onStartNew:l,onContinue:n,onView:i,onReEvaluate:d}=e,{evaluations:o,loading:c,error:u}=(0,F.F3)(t),{deleteEvaluation:p,saving:b}=(0,F.bm)(),{success:v,error:j}=(0,g.useToast)(),[f,N]=(0,s.useState)(null),[k,w]=(0,s.useState)(null),y=async e=>{if(confirm("Are you sure you want to delete this evaluation? This cannot be undone.")){w(e);try{await p(t,e),v("Evaluation deleted")}catch(e){console.error("Failed to delete evaluation:",e),j("Failed to delete evaluation")}finally{w(null),N(null)}}},C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),S=o.filter(e=>"in_progress"===e.status),D=o.filter(e=>"completed"===e.status);return c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):u?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-error-500",children:u})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("button",{onClick:l,className:"w-full py-4 border-2 border-dashed border-primary-300 dark:border-primary-700 rounded-2xl text-primary-600 dark:text-primary-400 hover:border-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-all font-medium flex items-center justify-center gap-2",children:[(0,a.jsx)(O.Z,{className:"w-5 h-5"}),"Start New ABLLS Evaluation"]}),S.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),"In Progress (",S.length,")"]}),S.map(e=>(0,a.jsxs)("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-warning-100 dark:bg-warning-900/30 flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-6 h-6 text-warning-600 dark:text-warning-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-neutral-900 dark:text-white",children:[e.type," Evaluation"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Started ",C(e.createdAt)," \xb7 ",e.overallPercentage,"% scored"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>n(e.id),className:"px-4 py-2 bg-warning-600 hover:bg-warning-700 text-white rounded-lg font-medium text-sm transition-colors flex items-center gap-2",children:["Continue",(0,a.jsx)(L.Z,{className:"w-4 h-4"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-warning-100 dark:hover:bg-warning-900/30 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:k===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[k===e.id?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]}),(0,a.jsx)("div",{className:"mt-3 h-1.5 bg-warning-200 dark:bg-warning-900/50 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-warning-500 transition-all",style:{width:"".concat(e.overallPercentage,"%")}})})]},e.id))]}),D.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"w-4 h-4"}),"Completed (",D.length,")"]}),D.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-4 hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-success-100 dark:bg-success-900/30 flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-6 h-6 text-success-600 dark:text-success-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-neutral-900 dark:text-white",children:[e.type," Evaluation"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Completed ",C(e.completedAt||e.updatedAt)]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,h.W)("text-2xl font-bold",e.overallPercentage>=70?"text-success-600":e.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[e.overallPercentage,"%"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400",children:[e.overallScore,"/",e.overallMaxScore]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>i(e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",title:"View details",children:(0,a.jsx)(ea.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,a.jsx)("button",{onClick:()=>d(e),className:"p-2 rounded-lg hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors",title:"Start re-evaluation",children:(0,a.jsx)(Z.Z,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:k===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[k===e.id?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-24 h-24 flex-shrink-0",children:(0,a.jsx)(M.E,{evaluation:e})}),(0,a.jsx)("div",{className:"flex-1 grid grid-cols-9 gap-1",children:Object.entries(e.categorySummaries||{}).sort((e,t)=>{let[r]=e,[a]=t;return r.localeCompare(a)}).slice(0,9).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"h-8 rounded bg-neutral-100 dark:bg-neutral-800 overflow-hidden",title:"".concat(r.categoryName,": ").concat(r.percentage,"%"),children:(0,a.jsx)("div",{className:(0,h.W)("h-full transition-all",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{height:"".concat(r.percentage,"%")}})}),(0,a.jsx)("span",{className:"text-[10px] text-neutral-400 mt-1",children:t})]},t)})})]})]},e.id))]}),0===o.length&&(0,a.jsxs)("div",{className:"text-center py-12 bg-neutral-50 dark:bg-neutral-800/50 rounded-2xl",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-8 h-8 text-neutral-400"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No Evaluations Yet"}),(0,a.jsxs)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-6",children:["Start an ABLLS evaluation to assess ",r,"'s skills and track progress over time."]}),(0,a.jsxs)("button",{onClick:l,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-primary-500/20",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),"Start First Evaluation"]})]})]})}var eh=r(49108),ep=r(98998),eg=r(70699),eb=r(30438),ev=r(15282);function ej(e){let{category:t,scores:r,previousScores:l,onScoreChange:n,readOnly:i=!1}=e,[d,o]=(0,s.useState)(null),[c,x]=(0,s.useState)(""),m=e=>{var t;i||(x((null===(t=r[e])||void 0===t?void 0:t.note)||""),o(d===e?null:e))},u=e=>{var t,a,s,l;let i=null!==(s=null===(t=r[e])||void 0===t?void 0:t.score)&&void 0!==s?s:0,d=null!==(l=null===(a=r[e])||void 0===a?void 0:a.isNA)&&void 0!==l&&l;n(e,i,c||void 0,d),o(null)},p=e=>{if(!l||!l[e]||!r[e])return null;let t=l[e].score,a=r[e].score;return a>t?"improved":a<t?"regressed":"same"};return(0,a.jsx)("div",{className:"space-y-3",children:t.items.map(e=>{var t;let s=r[e.id],g=null==s?void 0:s.score,b=null==s?void 0:s.isNA,v=!!(null==s?void 0:s.note),j=null==l?void 0:null===(t=l[e.id])||void 0===t?void 0:t.score,f=p(e.id);return(0,a.jsx)("div",{className:(0,h.W)("p-4 rounded-xl border transition-all",b?"bg-neutral-100 dark:bg-neutral-800/20 border-dashed border-neutral-300 opacity-75":void 0!==g?"bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-100 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-bold text-primary-600 dark:text-primary-400",children:e.id})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white mb-3",children:e.text}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,0,null==s?void 0:s.note,!b),disabled:i,title:"Not Applicable",className:(0,h.W)("px-3 h-10 rounded-lg font-bold text-xs transition-all",b?"bg-neutral-500 text-white shadow-lg":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200"),children:"N/A"}),[0,1,2].map(t=>{let r=g===t&&!b,l=ev.t3[t];return(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,t,null==s?void 0:s.note,!1),disabled:i,title:l.description,className:(0,h.W)("w-10 h-10 rounded-lg font-bold text-sm transition-all",i&&"cursor-default",r?"error"===l.color?"bg-error-500 text-white shadow-lg shadow-error-500/30":"warning"===l.color?"bg-warning-500 text-white shadow-lg shadow-warning-500/30":"bg-success-500 text-white shadow-lg shadow-success-500/30":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:t},t)}),!i&&(0,a.jsx)("button",{onClick:()=>m(e.id),className:(0,h.W)("p-2 rounded-lg transition-colors ml-2",v?"bg-primary-100 dark:bg-primary-900/30 text-primary-600":"bg-neutral-100 dark:bg-neutral-800 text-neutral-400 hover:text-neutral-600"),title:v?"Edit note":"Add note",children:(0,a.jsx)(eb.Z,{className:"w-5 h-5"})}),void 0!==j&&(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-neutral-400",children:"Previous:"}),(0,a.jsx)("span",{className:(0,h.W)("text-xs font-medium px-2 py-0.5 rounded",0===j&&"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400",1===j&&"bg-warning-100 text-warning-700 dark:bg-warning-900/30 dark:text-warning-400",2===j&&"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400"),children:j}),f&&"same"!==f&&(0,a.jsx)("span",{className:(0,h.W)("text-xs font-medium","improved"===f&&"text-success-600","regressed"===f&&"text-error-600"),children:"improved"===f?"↑":"↓"})]}),i&&v&&(0,a.jsx)("div",{className:"ml-auto",children:(0,a.jsx)(eb.Z,{className:"w-4 h-4 text-primary-500"})})]}),d===e.id&&(0,a.jsxs)("div",{className:"mt-3 animate-in slide-in-from-top-2 duration-200",children:[(0,a.jsx)("textarea",{value:c,onChange:e=>x(e.target.value),placeholder:"Add a note about this score...",className:"w-full px-3 py-2 text-sm bg-neutral-100 dark:bg-neutral-800 border-none rounded-lg focus:ring-2 focus:ring-primary-500 resize-none",rows:2,autoFocus:!0}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,a.jsx)("button",{onClick:()=>o(null),className:"px-3 py-1.5 text-xs font-medium text-neutral-600 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{onClick:()=>u(e.id),className:"px-3 py-1.5 text-xs font-medium bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-1",children:[(0,a.jsx)(C.Z,{className:"w-3 h-3"}),"Save Note"]})]})]}),v&&d!==e.id&&(0,a.jsx)("div",{className:"mt-2 p-2 bg-primary-50 dark:bg-primary-900/20 rounded-lg",children:(0,a.jsx)("p",{className:"text-xs text-primary-700 dark:text-primary-300 italic",children:r[e.id].note})})]})]})},e.id)})})}function ef(e){let{isOpen:t,onClose:r,clientId:l,clientName:n,evaluationId:i,previousEvaluation:d}=e,{user:o,userData:c}=(0,p.useAuth)(),{success:x,error:m}=(0,g.useToast)(),{saving:u,createEvaluation:b,saveEvaluationProgress:v,completeEvaluation:j}=(0,F.bm)(),[f,N]=(0,s.useState)(0),[k,w]=(0,s.useState)({}),[y,S]=(0,s.useState)(i||null),[Z,D]=(0,s.useState)(!1),[A,E]=(0,s.useState)(!1),W=(0,s.useRef)(!1),{evaluation:I,loading:T}=(0,F.S6)(l,y||"");(0,s.useEffect)(()=>{t&&(async()=>{if(i)S(i);else if(!y&&!W.current){W.current=!0,D(!0);try{let e=await b(l,(null==o?void 0:o.uid)||"",(null==c?void 0:c.name)||"Unknown",null==d?void 0:d.id);S(e),x("Evaluation started")}catch(e){console.error("Failed to create evaluation:",e),m("Failed to start evaluation"),r()}finally{D(!1)}}})()},[t,i,l]),(0,s.useEffect)(()=>{I&&w(I.scores||{})},[I]),(0,s.useEffect)(()=>{t||(N(0),w({}),S(i||null),E(!1),W.current=!1)},[t,i]);let M=F.s7[f],B=(0,s.useCallback)((e,t,r,a)=>{w(s=>({...s,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==a&&{isNA:a},...void 0!==r&&""!==r&&{note:r}}})),E(!0)},[]),O=Object.keys(k).length,z=Math.round(O/F.gl*100),R=e=>{let t=F.s7[e];return{scored:t.items.filter(e=>void 0!==k[e.id]).length,total:t.items.length}},U=async()=>{if(y)try{await v(l,y,k),E(!1),x("Progress saved")}catch(e){console.error("Failed to save progress:",e),m("Failed to save progress")}},V=async()=>{if(y&&(!(O<F.gl)||window.confirm("You have scored ".concat(O," of ").concat(F.gl," items. ")+"Do you want to complete the evaluation anyway?")))try{await j(l,y,k),x("Evaluation completed!"),r()}catch(e){console.error("Failed to complete evaluation:",e),m("Failed to complete evaluation")}},G=()=>{if(A&&window.confirm("You have unsaved changes. Do you want to save before closing?")){U().then(()=>r());return}r()},J=e=>{e>=0&&e<F.s7.length&&N(e)};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:G}),(0,a.jsxs)("div",{className:"relative w-full max-w-4xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:d?"Re-evaluation":"ABLLS Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[n,d&&(0,a.jsxs)("span",{className:"ml-2 text-primary-600",children:["(comparing with ",new Date(d.completedAt||d.createdAt).toLocaleDateString(),")"]})]})]}),(0,a.jsx)("button",{onClick:G,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(_.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Overall Progress"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-primary-600",children:[O," / ",F.gl," items (",z,"%)"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:"".concat(z,"%")}})})]}),(0,a.jsx)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800 overflow-x-auto",children:(0,a.jsx)("div",{className:"flex gap-2 min-w-max",children:F.s7.map((e,t)=>{let{scored:r,total:s}=R(t),l=r===s,n=t===f;return(0,a.jsxs)("button",{onClick:()=>J(t),className:(0,h.W)("px-3 py-1.5 rounded-lg text-sm font-medium transition-all flex items-center gap-1.5",n?"bg-primary-600 text-white":l?"bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400":r>0?"bg-warning-100 dark:bg-warning-900/30 text-warning-700 dark:text-warning-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:[(0,a.jsx)("span",{children:e.key}),l&&!n&&(0,a.jsx)(C.Z,{className:"w-3 h-3"})]},e.key)})})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:Z||T?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:[M.key,". ",M.name]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[R(f).scored," of"," ",R(f).total," items scored"]})]}),(0,a.jsxs)("div",{className:"mb-6 p-3 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl flex flex-wrap gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-error-500 text-white flex items-center justify-center font-bold",children:"0"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Not observed"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-warning-500 text-white flex items-center justify-center font-bold",children:"1"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Emerging (with prompts)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-success-500 text-white flex items-center justify-center font-bold",children:"2"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Mastered (independent)"})]})]}),(0,a.jsx)(ej,{category:M,scores:k,previousScores:null==d?void 0:d.scores,onScoreChange:B})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("button",{onClick:()=>J(f-1),disabled:0===f,className:(0,h.W)("px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",0===f?"text-neutral-400 cursor-not-allowed":"text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800"),children:[(0,a.jsx)(eh.Z,{className:"w-4 h-4"}),"Previous"]})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[A&&(0,a.jsxs)("span",{className:"text-xs text-warning-600 flex items-center gap-1",children:[(0,a.jsx)(ep.Z,{className:"w-3 h-3"}),"Unsaved changes"]}),(0,a.jsxs)("button",{onClick:U,disabled:u||!A,className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2 disabled:opacity-50",children:[u?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(eg.Z,{className:"w-4 h-4"}),"Save Draft"]}),f===F.s7.length-1?(0,a.jsxs)("button",{onClick:V,disabled:u,className:"px-6 py-2 rounded-lg text-sm font-medium bg-success-600 hover:bg-success-700 text-white transition-colors flex items-center gap-2 disabled:opacity-50",children:[u?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(C.Z,{className:"w-4 h-4"}),"Complete Evaluation"]}):(0,a.jsxs)("button",{onClick:()=>J(f+1),className:"px-6 py-2 rounded-lg text-sm font-medium bg-primary-600 hover:bg-primary-700 text-white transition-colors flex items-center gap-2",children:["Next",(0,a.jsx)(L.Z,{className:"w-4 h-4"})]})]})]})]})]}):null}var eN=r(57284),ek=r(10775),ew=r(27271),ey=r(95200),eC=r(18025);function eS(e){let{currentEvaluation:t,previousEvaluation:r}=e,l=(0,s.useMemo)(()=>{let e=t.overallPercentage-r.overallPercentage,a=Object.keys(t.categorySummaries||{}).map(e=>{var a,s,l,n,i,d;let o=(null===(s=t.categorySummaries)||void 0===s?void 0:null===(a=s[e])||void 0===a?void 0:a.percentage)||0,c=(null===(n=r.categorySummaries)||void 0===n?void 0:null===(l=n[e])||void 0===l?void 0:l.percentage)||0;return{key:e,name:(null===(d=t.categorySummaries)||void 0===d?void 0:null===(i=d[e])||void 0===i?void 0:i.categoryName)||e,current:o,previous:c,change:o-c}}).sort((e,t)=>e.key.localeCompare(t.key)),s=a.filter(e=>e.change>0).length,l=a.filter(e=>e.change<0).length,n=a.filter(e=>0===e.change).length;return{overallChange:e,categoryChanges:a,improved:s,declined:l,unchanged:n}},[t,r]),n=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,a.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wider mb-2",children:"Previous"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-neutral-600 dark:text-neutral-400",children:[r.overallPercentage,"%"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2 text-xs text-neutral-500",children:[(0,a.jsx)(D.Z,{className:"w-3 h-3"}),n(r.completedAt||r.updatedAt)]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(eC.Z,{className:"w-6 h-6 text-neutral-300 dark:text-neutral-600 hidden md:block"}),(0,a.jsxs)("div",{className:(0,h.W)("mt-2 px-4 py-2 rounded-xl text-center",l.overallChange>0?"bg-success-100 dark:bg-success-900/30":l.overallChange<0?"bg-error-100 dark:bg-error-900/30":"bg-neutral-100 dark:bg-neutral-800"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[l.overallChange>0?(0,a.jsx)(em.Z,{className:"w-5 h-5 text-success-600"}):l.overallChange<0?(0,a.jsx)(ek.Z,{className:"w-5 h-5 text-error-600"}):(0,a.jsx)(ew.Z,{className:"w-5 h-5 text-neutral-500"}),(0,a.jsxs)("span",{className:(0,h.W)("text-2xl font-bold",l.overallChange>0?"text-success-600":l.overallChange<0?"text-error-600":"text-neutral-500"),children:[l.overallChange>0?"+":"",l.overallChange,"%"]})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"Overall Change"})]})]}),(0,a.jsxs)("div",{className:"bg-primary-50 dark:bg-primary-900/20 rounded-xl p-4 text-center border border-primary-200 dark:border-primary-800",children:[(0,a.jsx)("p",{className:"text-xs text-primary-600 dark:text-primary-400 uppercase tracking-wider mb-2",children:"Current"}),(0,a.jsxs)("p",{className:(0,h.W)("text-3xl font-bold",t.overallPercentage>=70?"text-success-600":t.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[t.overallPercentage,"%"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2 text-xs text-neutral-500",children:[(0,a.jsx)(D.Z,{className:"w-3 h-3"}),n(t.completedAt||t.updatedAt)]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-success-50 dark:bg-success-900/20 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-success-600",children:l.improved}),(0,a.jsx)("p",{className:"text-xs text-success-600/70",children:"Categories Improved"})]}),(0,a.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-500",children:l.unchanged}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Unchanged"})]}),(0,a.jsxs)("div",{className:"bg-error-50 dark:bg-error-900/20 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-error-600",children:l.declined}),(0,a.jsx)("p",{className:"text-xs text-error-600/70",children:"Need Attention"})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 rounded-xl p-4 border border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-neutral-900 dark:text-white mb-4",children:"Visual Comparison"}),(0,a.jsx)(M.Z,{evaluation:t,previousEvaluation:r,size:"md",showLegend:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-neutral-900 dark:text-white mb-3",children:"Category Breakdown"}),(0,a.jsx)("div",{className:"space-y-2",children:l.categoryChanges.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-white dark:bg-neutral-800/50 rounded-xl border border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("div",{className:(0,h.W)("w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white text-sm",e.current>=70?"bg-success-500":e.current>=40?"bg-warning-500":"bg-error-500"),children:e.key}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white truncate",children:e.name}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,a.jsx)("div",{className:"flex-1 h-1.5 bg-neutral-100 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,h.W)("h-full transition-all",e.current>=70?"bg-success-500":e.current>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(e.current,"%")}})})})]}),(0,a.jsxs)("div",{className:"text-right flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"text-xs text-neutral-400",children:[e.previous,"%"]}),(0,a.jsx)(eC.Z,{className:"w-3 h-3 text-neutral-300"}),(0,a.jsxs)("span",{className:(0,h.W)("text-sm font-bold",e.current>=70?"text-success-600":e.current>=40?"text-warning-600":"text-error-600"),children:[e.current,"%"]}),(0,a.jsxs)("span",{className:(0,h.W)("text-xs font-medium px-1.5 py-0.5 rounded",e.change>0?"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400":e.change<0?"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400":"bg-neutral-100 text-neutral-500 dark:bg-neutral-800"),children:[e.change>0?"+":"",e.change,"%"]})]})]},e.key))})]})]})}var eZ=r(48953),eD=r(60141),eP=r(20168),eA=r(48170);function eE(e){let{goals:t,title:r="Suggested IEP Goals",emptyMessage:l="No emerging skills identified for goal development."}=e,[n,i]=(0,s.useState)(!1),[d,o]=(0,s.useState)(null),[c,x]=(0,s.useState)(!1),m=async e=>{let t="Goal: ".concat(e.goalText,"\n\nShort-term Objective: ").concat(e.shortTermObjective,"\n\nTarget Skill: ").concat(e.itemDescription,"\nCriteria: ").concat(e.targetCriteria);try{await navigator.clipboard.writeText(t),o(e.id),setTimeout(()=>o(null),2e3)}catch(e){console.error("Failed to copy:",e)}},u=async()=>{let e=t.map((e,t)=>"Goal ".concat(t+1,": ").concat(e.skillCode," - ").concat(e.skillArea,"\n").concat(e.goalText,"\n\nShort-term Objective:\n").concat(e.shortTermObjective,"\n\nTarget Skill: ").concat(e.itemDescription,"\n")).join("\n---\n\n");try{await navigator.clipboard.writeText(e),x(!0),setTimeout(()=>x(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};if(0===t.length)return(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl text-center",children:[(0,a.jsx)(ey.Z,{className:"w-8 h-8 text-neutral-300 dark:text-neutral-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:l})]});let p=t.reduce((e,t)=>{let r=t.skillCode||t.skillArea;return e[r]||(e[r]={name:t.skillArea,goals:[]}),e[r].goals.push(t),e},{});return(0,a.jsxs)("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>i(!n),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-amber-100/50 dark:hover:bg-amber-900/30 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-amber-100 dark:bg-amber-800/50 rounded-lg flex items-center justify-center",children:(0,a.jsx)(ey.Z,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:r}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:[t.length," emerging skill",1!==t.length?"s":""," identified for IEP development"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 text-xs font-bold rounded-full",children:t.length}),n?(0,a.jsx)(G.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(J.Z,{className:"w-5 h-5 text-neutral-400"})]})]}),n&&(0,a.jsxs)("div",{className:"border-t border-amber-200 dark:border-amber-800",children:[(0,a.jsx)("div",{className:"px-4 py-2 bg-amber-100/50 dark:bg-amber-900/30 flex justify-end",children:(0,a.jsx)("button",{onClick:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-amber-700 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-800 rounded-lg transition-colors",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.Z,{className:"w-4 h-4"}),"Copied All!"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"w-4 h-4"}),"Copy All Goals"]})})}),(0,a.jsx)("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:Object.entries(p).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 text-xs font-bold rounded",children:t}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:r.name})]}),r.goals.map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-800 rounded-lg p-3 border border-amber-100 dark:border-neutral-700",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-xs font-medium text-neutral-500",children:e.itemId})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mb-2",children:e.itemDescription}),(0,a.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-900 rounded p-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:"Goal:"}),(0,a.jsx)("p",{className:"text-sm text-neutral-800 dark:text-neutral-200",children:e.goalText})]})]}),(0,a.jsx)("button",{onClick:()=>m(e),className:(0,h.W)("p-2 rounded-lg transition-colors flex-shrink-0",d===e.id?"bg-success-100 dark:bg-success-900/30 text-success-600":"hover:bg-neutral-100 dark:hover:bg-neutral-700 text-neutral-400"),title:"Copy goal",children:d===e.id?(0,a.jsx)(C.Z,{className:"w-4 h-4"}):(0,a.jsx)(S.Z,{className:"w-4 h-4"})})]})},e.id))]},t)})}),(0,a.jsx)("div",{className:"px-4 py-2 bg-amber-100/50 dark:bg-amber-900/30 border-t border-amber-200 dark:border-amber-800",children:(0,a.jsxs)("p",{className:"text-xs text-neutral-500 flex items-center gap-1",children:[(0,a.jsx)(W.Z,{className:"w-3 h-3"}),"Goals are auto-generated from emerging skills (scored 0.5 in VB-MAPP, 1 in ABLLS)"]})})]})]})}function eW(e){let{isOpen:t,onClose:r,clientId:l,clientData:n,evaluationId:i,previousEvaluation:d,onReEvaluate:o}=e,{evaluation:c,loading:x}=(0,F.S6)(l,i),{evaluations:m}=(0,F.F3)(l),[u,p]=(0,s.useState)(null),[g,b]=(0,s.useState)("summary");if(!t)return null;let v=(null==c?void 0:c.categorySummaries)?Object.entries(c.categorySummaries).sort((e,t)=>{let[r]=e,[a]=t;return r.localeCompare(a)}):[],f=e=>{var t,r;if(!(null==d?void 0:null===(t=d.categorySummaries)||void 0===t?void 0:t[e])||!(null==c?void 0:null===(r=c.categorySummaries)||void 0===r?void 0:r[e]))return null;let a=d.categorySummaries[e].percentage,s=c.categorySummaries[e].percentage-a;return{diff:s,trend:s>0?"up":s<0?"down":"same"}},N=d&&(null==c?void 0:c.overallPercentage)!==void 0?c.overallPercentage-d.overallPercentage:null,k=n.birthDate?(0,eD.Fw)(n.birthDate):null,w=c?(0,eP.tk)(c.overallPercentage):null,y=(null==c?void 0:c.categorySummaries)?(0,eP.kE)(c.categorySummaries):[],C=(null==c?void 0:c.categorySummaries)?(0,eP.Qc)(c.categorySummaries):{},S=c?(0,eA.Ep)(c,n.name||"Client",F.s7):[];return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-4xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"ABLLS Evaluation Results"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:n.name})]}),d&&(0,a.jsxs)("div",{className:"flex items-center bg-neutral-100 dark:bg-neutral-800 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>b("summary"),className:(0,h.W)("flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors","summary"===g?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(W.Z,{className:"w-4 h-4"}),"Summary"]}),(0,a.jsxs)("button",{onClick:()=>b("comparison"),className:(0,h.W)("flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors","comparison"===g?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(eN.Z,{className:"w-4 h-4"}),"Compare"]})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(_.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:x||!c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):"comparison"===g&&d?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eS,{currentEvaluation:c,previousEvaluation:d})}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(D.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:new Date(c.completedAt||c.updatedAt).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Evaluator"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:c.evaluatorName})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(U.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Version"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:c.version})]})]}),k&&(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(A.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Client Age"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:(0,eD.KD)(k)})]})]})]}),(0,a.jsx)("div",{className:"p-6 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/30 dark:to-primary-900/10 rounded-2xl border border-primary-200 dark:border-primary-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-primary-600 dark:text-primary-400 mb-1",children:"Overall Score"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-5xl font-bold",c.overallPercentage>=70?"text-success-600":c.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[c.overallPercentage,"%"]}),(0,a.jsxs)("span",{className:"text-neutral-500",children:["(",c.overallScore," / ",c.overallMaxScore," points)"]})]}),null!==N&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[N>0?(0,a.jsx)(em.Z,{className:"w-4 h-4 text-success-600"}):N<0?(0,a.jsx)(ek.Z,{className:"w-4 h-4 text-error-600"}):(0,a.jsx)(ew.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:(0,h.W)("text-sm font-medium",N>0?"text-success-600":N<0?"text-error-600":"text-neutral-500"),children:[N>0?"+":"",N,"% since last evaluation"]})]})]}),(0,a.jsx)("div",{className:"hidden md:block w-40 h-40 bg-white/50 dark:bg-neutral-800/50 rounded-xl overflow-hidden",children:(0,a.jsx)(M.E,{evaluation:c})})]})}),w&&(0,a.jsx)("div",{className:(0,h.W)("p-4 rounded-xl border","excellent"===w.level?"bg-success-50 border-success-200 dark:bg-success-900/20 dark:border-success-800":"good"===w.level?"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":"moderate"===w.level?"bg-warning-50 border-warning-200 dark:bg-warning-900/20 dark:border-warning-800":"bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ep.Z,{className:(0,h.W)("w-5 h-5 mt-0.5 flex-shrink-0","excellent"===w.level?"text-success-600":"good"===w.level?"text-blue-600":"moderate"===w.level?"text-warning-600":"text-orange-600")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:["Clinical Interpretation: ",w.title]}),(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mt-1",children:w.description}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-800 dark:text-neutral-200 mt-2",children:w.recommendation}),w.interventionHours&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1 italic",children:w.interventionHours})]})]})}),y.length>0&&(0,a.jsx)("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ey.Z,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:"Priority Intervention Areas"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:"Focus treatment on these categories for maximum impact:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:y.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white dark:bg-neutral-800 rounded-lg text-sm border border-amber-200 dark:border-amber-700",children:[(0,a.jsx)("span",{className:"font-bold text-amber-700 dark:text-amber-400",children:e.key}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-300",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-neutral-500",children:["(",e.percentage,"%)"]})]},e.key))}),S.length>0&&(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-3",children:[S.length," emerging skills identified for IEP goal development"]})]})]})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Skills Overview"}),(0,a.jsx)(M.Z,{evaluation:c,previousEvaluation:d,size:"lg",showLegend:!!d}),d&&(0,a.jsxs)("p",{className:"text-xs text-center text-neutral-500 mt-2",children:["Comparing with evaluation from ",new Date(d.completedAt||d.updatedAt).toLocaleDateString()]})]}),S.length>0&&(0,a.jsx)(eE,{goals:S,title:"Suggested IEP Goals",emptyMessage:"No emerging skills identified for goal development."}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Domain Analysis"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(C).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800 rounded-xl border border-neutral-100 dark:border-neutral-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-800 dark:text-neutral-200 text-sm",children:t}),(0,a.jsxs)("span",{className:(0,h.W)("text-sm font-bold",r.percentage>=80?"text-success-600":r.percentage>=60?"text-blue-600":r.percentage>=40?"text-warning-600":"text-error-600"),children:[r.percentage,"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-200 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,h.W)("h-full rounded-full transition-all",r.percentage>=80?"bg-success-500":r.percentage>=60?"bg-blue-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(r.percentage,"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-2",children:["Categories: ",r.categories.join(", ")]})]},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Category Breakdown"}),(0,a.jsx)("div",{className:"space-y-2",children:v.map(e=>{let[t,r]=e,s=f(t),l=u===t,n=F.s7.find(e=>e.key===t);return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-xl overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>p(l?null:t),className:"w-full p-4 flex items-center gap-4 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors",children:[(0,a.jsx)("div",{className:(0,h.W)("w-10 h-10 rounded-lg flex items-center justify-center font-bold text-white",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),children:t}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-medium text-neutral-900 dark:text-white",children:r.categoryName}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-sm font-bold",r.percentage>=70?"text-success-600":r.percentage>=40?"text-warning-600":"text-error-600"),children:[r.percentage,"%"]}),s&&(0,a.jsxs)("span",{className:(0,h.W)("text-xs font-medium px-1.5 py-0.5 rounded","up"===s.trend?"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400":"down"===s.trend?"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400":"bg-neutral-100 text-neutral-500 dark:bg-neutral-800"),children:[s.diff>0?"+":"",s.diff,"%"]})]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,h.W)("h-full transition-all",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(r.percentage,"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:[r.scoredItems,"/",r.totalItems," items \xb7 ",r.totalScore,"/",r.maxPossibleScore," points"]})]}),l?(0,a.jsx)(G.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(J.Z,{className:"w-5 h-5 text-neutral-400"})]}),l&&n&&(0,a.jsx)("div",{className:"border-t border-neutral-200 dark:border-neutral-700 p-4 bg-neutral-50 dark:bg-neutral-900/50",children:(0,a.jsx)(ej,{category:n,scores:c.scores,previousScores:null==d?void 0:d.scores,onScoreChange:()=>{},readOnly:!0})})]},t)})})]})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:"Close"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{c&&(0,eZ.G)(c,n,d,m)},className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2",children:[(0,a.jsx)(es.Z,{className:"w-4 h-4"}),"Clinical PDF"]}),(0,a.jsxs)("button",{onClick:()=>(0,eZ.G)(c,n,d,m,!0),className:"px-4 py-2 rounded-lg text-sm font-medium border border-primary-200 text-primary-700 hover:bg-primary-50 transition-colors flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"}),"Parent Version"]}),o&&(0,a.jsxs)("button",{onClick:o,className:"px-4 py-2 rounded-lg text-sm font-medium bg-primary-600 hover:bg-primary-700 text-white transition-colors flex items-center gap-2",children:[(0,a.jsx)(Z.Z,{className:"w-4 h-4"}),"Start Re-evaluation"]})]})]})]})]})}var eI=r(77819),eL=r(94830),eT=r(38333),eF=r(23356),eM=r(22983),eB=r(96528),eO=r(6541),ez=r(51161),eR=r(66363),eU=r(98964);let eV={A:"#ef4444",B:"#f97316",C:"#f59e0b",D:"#eab308",E:"#84cc16",F:"#22c55e",G:"#10b981",H:"#14b8a6",I:"#06b6d4",J:"#0ea5e9",K:"#3b82f6",L:"#6366f1",M:"#8b5cf6",N:"#a855f7",O:"#d946ef",P:"#ec4899",Q:"#f43f5e",R:"#78716c"};function eG(e){let{evaluations:t,clientName:r}=e,[l,n]=(0,s.useState)([]),[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)("area"),x=(0,s.useMemo)(()=>t.filter(e=>"completed"===e.status).sort((e,t)=>new Date(e.completedAt||e.createdAt).getTime()-new Date(t.completedAt||t.createdAt).getTime()),[t]),m=(0,s.useMemo)(()=>x.map(e=>{let t=new Date(e.completedAt||e.createdAt),r={date:t.toISOString(),dateLabel:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}),overall:e.overallPercentage,evaluationId:e.id};return Object.entries(e.categorySummaries||{}).forEach(e=>{let[t,a]=e;r[t]=a.percentage}),r}),[x]),u=(0,s.useMemo)(()=>{if(x.length<2)return null;let e=x[0],t=x[x.length-1],r=t.overallPercentage-e.overallPercentage,a=[];return Object.keys(t.categorySummaries||{}).forEach(r=>{var s,l,n,i;let d=(null===(l=e.categorySummaries)||void 0===l?void 0:null===(s=l[r])||void 0===s?void 0:s.percentage)||0,o=(null===(i=t.categorySummaries)||void 0===i?void 0:null===(n=i[r])||void 0===n?void 0:n.percentage)||0;a.push({key:r,name:t.categorySummaries[r].categoryName,change:o-d})}),a.sort((e,t)=>t.change-e.change),{overallChange:r,totalEvaluations:x.length,mostImproved:a.slice(0,3),needsAttention:a.filter(e=>e.change<0).slice(-3).reverse(),timespan:{start:new Date(e.completedAt||e.createdAt),end:new Date(t.completedAt||t.createdAt)}}},[x]),p=e=>{n(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},g=e=>{let{active:t,payload:r,label:s}=e;return t&&r&&r.length?(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800 px-4 py-3 rounded-xl shadow-lg border border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white text-sm mb-2",children:s}),(0,a.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"overall"===e.name?"Overall":e.name})]}),(0,a.jsxs)("span",{className:"font-bold",style:{color:e.color},children:[e.value,"%"]})]},t))})]}):null};return 0===x.length?(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-8 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center",children:(0,a.jsx)(em.Z,{className:"w-8 h-8 text-neutral-400"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No Progress Data Yet"}),(0,a.jsx)("p",{className:"text-neutral-500 max-w-sm mx-auto",children:"Complete at least one evaluation to start tracking progress over time."})]}):1===x.length?(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-8 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center",children:(0,a.jsx)(D.Z,{className:"w-8 h-8 text-primary-500"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"One Evaluation Completed"}),(0,a.jsx)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-4",children:"Complete a re-evaluation to see progress trends and comparisons."}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-neutral-100 dark:bg-neutral-800 rounded-xl",children:[(0,a.jsxs)("span",{className:"text-3xl font-bold text-primary-600",children:[x[0].overallPercentage,"%"]}),(0,a.jsx)("span",{className:"text-neutral-500 text-sm",children:"baseline score"})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[u&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 mb-2",children:"Overall Progress"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-3xl font-bold",u.overallChange>0?"text-success-600":u.overallChange<0?"text-error-600":"text-neutral-500"),children:[u.overallChange>0?"+":"",u.overallChange,"%"]}),u.overallChange>0?(0,a.jsx)(em.Z,{className:"w-6 h-6 text-success-500"}):u.overallChange<0?(0,a.jsx)(ek.Z,{className:"w-6 h-6 text-error-500"}):(0,a.jsx)(ew.Z,{className:"w-6 h-6 text-neutral-400"})]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-2",children:["Over ",u.totalEvaluations," evaluations"]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 mb-3",children:"Most Improved"}),(0,a.jsx)("div",{className:"space-y-2",children:u.mostImproved.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded text-xs font-bold flex items-center justify-center text-white",style:{backgroundColor:eV[e.key]},children:e.key}),(0,a.jsx)("span",{className:"text-sm text-neutral-700 dark:text-neutral-300 truncate max-w-[120px]",children:e.name})]}),(0,a.jsxs)("span",{className:(0,h.W)("text-sm font-bold",e.change>0?"text-success-600":e.change<0?"text-error-600":"text-neutral-500"),children:[e.change>0?"+":"",e.change,"%"]})]},e.key))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 mb-3",children:"Needs Attention"}),u.needsAttention.length>0?(0,a.jsx)("div",{className:"space-y-2",children:u.needsAttention.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded text-xs font-bold flex items-center justify-center text-white",style:{backgroundColor:eV[e.key]},children:e.key}),(0,a.jsx)("span",{className:"text-sm text-neutral-700 dark:text-neutral-300 truncate max-w-[120px]",children:e.name})]}),(0,a.jsxs)("span",{className:"text-sm font-bold text-error-600",children:[e.change,"%"]})]},e.key))}):(0,a.jsxs)("p",{className:"text-sm text-success-600 flex items-center gap-2",children:[(0,a.jsx)(em.Z,{className:"w-4 h-4"}),"All categories improving!"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Progress Over Time"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center bg-neutral-100 dark:bg-neutral-800 rounded-lg p-1",children:[(0,a.jsx)("button",{onClick:()=>c("area"),className:(0,h.W)("px-3 py-1.5 text-sm font-medium rounded-md transition-colors","area"===o?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:"Area"}),(0,a.jsx)("button",{onClick:()=>c("line"),className:(0,h.W)("px-3 py-1.5 text-sm font-medium rounded-md transition-colors","line"===o?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:"Line"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>d(!i),className:"flex items-center gap-2 px-4 py-2 bg-neutral-100 dark:bg-neutral-800 rounded-lg text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors",children:["Categories (",l.length||"All",")",(0,a.jsx)(J.Z,{className:(0,h.W)("w-4 h-4 transition-transform",i&&"rotate-180")})]}),i&&(0,a.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-72 bg-white dark:bg-neutral-800 rounded-xl shadow-xl border border-neutral-200 dark:border-neutral-700 p-3 z-20 max-h-80 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3 pb-2 border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:"Select Categories"}),(0,a.jsx)("button",{onClick:()=>n([]),className:"text-xs text-primary-600 hover:underline",children:"Clear all"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:F.s7.map(e=>(0,a.jsxs)("button",{onClick:()=>p(e.key),className:(0,h.W)("flex items-center gap-2 p-2 rounded-lg text-left text-sm transition-colors",l.includes(e.key)?"bg-primary-50 dark:bg-primary-900/30 border border-primary-200 dark:border-primary-800":"hover:bg-neutral-50 dark:hover:bg-neutral-700 border border-transparent"),children:[(0,a.jsx)("span",{className:"w-5 h-5 rounded text-[10px] font-bold flex items-center justify-center text-white flex-shrink-0",style:{backgroundColor:eV[e.key]},children:e.key}),(0,a.jsx)("span",{className:"text-neutral-700 dark:text-neutral-300 truncate text-xs",children:e.name})]},e.key))})]})]})]})]}),(0,a.jsx)(eI.h,{width:"100%",height:350,children:"area"===o?(0,a.jsxs)(eL.T,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"overallGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]}),l.map(e=>(0,a.jsxs)("linearGradient",{id:"gradient-".concat(e),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:eV[e],stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:eV[e],stopOpacity:0})]},e))]}),(0,a.jsx)(eT.q,{strokeDasharray:"3 3",stroke:"#e5e5e5",className:"dark:stroke-neutral-700"}),(0,a.jsx)(eF.K,{dataKey:"dateLabel",tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"}}),(0,a.jsx)(eM.B,{domain:[0,100],tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"},tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(eB.u,{content:(0,a.jsx)(g,{})}),(0,a.jsx)(eO.D,{}),(0,a.jsx)(ez.uN,{type:"monotone",dataKey:"overall",name:"Overall",stroke:"#6366f1",fill:"url(#overallGradient)",strokeWidth:3,dot:{fill:"#6366f1",strokeWidth:2,r:4},activeDot:{r:6}}),l.map(e=>(0,a.jsx)(ez.uN,{type:"monotone",dataKey:e,name:e,stroke:eV[e],fill:"url(#gradient-".concat(e,")"),strokeWidth:2,dot:{fill:eV[e],strokeWidth:2,r:3},activeDot:{r:5}},e))]}):(0,a.jsxs)(eR.w,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[(0,a.jsx)(eT.q,{strokeDasharray:"3 3",stroke:"#e5e5e5",className:"dark:stroke-neutral-700"}),(0,a.jsx)(eF.K,{dataKey:"dateLabel",tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"}}),(0,a.jsx)(eM.B,{domain:[0,100],tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"},tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(eB.u,{content:(0,a.jsx)(g,{})}),(0,a.jsx)(eO.D,{}),(0,a.jsx)(eU.x1,{type:"monotone",dataKey:"overall",name:"Overall",stroke:"#6366f1",strokeWidth:3,dot:{fill:"#6366f1",strokeWidth:2,r:4},activeDot:{r:6}}),l.map(e=>(0,a.jsx)(eU.x1,{type:"monotone",dataKey:e,name:e,stroke:eV[e],strokeWidth:2,dot:{fill:eV[e],strokeWidth:2,r:3},activeDot:{r:5}},e))]})}),u&&(0,a.jsxs)("p",{className:"text-xs text-center text-neutral-500 mt-4",children:["Showing progress from ",u.timespan.start.toLocaleDateString()," to ",u.timespan.end.toLocaleDateString()]})]})]})}var eJ=r(3224);let eH=["MAND","TACT","LR","VP-MTS","PLAY","SOCIAL","IMITATION","ECHOIC","EESA","LRFFC","IV","GROUP","LING","READING","WRITING","MATH"];function e_(e){let{evaluation:t,previousEvaluation:r,compact:l=!1}=e,n=(0,s.useMemo)(()=>{let e={};return eH.forEach(t=>{e[t]={level1:[],level2:[],level3:[]}}),eJ.wB.forEach(r=>{e[r.code]&&r.items.forEach(a=>{var s;let l=null===(s=t.milestoneScores[a.id])||void 0===s?void 0:s.score;e[r.code].level1.push(null!=l?l:null)})}),eJ.H3.forEach(r=>{e[r.code]&&r.items.forEach(a=>{var s;let l=null===(s=t.milestoneScores[a.id])||void 0===s?void 0:s.score;e[r.code].level2.push(null!=l?l:null)})}),eJ.PW.forEach(r=>{e[r.code]&&r.items.forEach(a=>{var s;let l=null===(s=t.milestoneScores[a.id])||void 0===s?void 0:s.score;e[r.code].level3.push(null!=l?l:null)})}),e},[t]),i=e=>null===e?"bg-neutral-100 dark:bg-neutral-800":0===e?"bg-neutral-200 dark:bg-neutral-700":.5===e?"bg-warning-400":"bg-success-500",d=l?"w-4 h-4":"w-6 h-6",o=l?"text-[8px]":"text-[10px]";return(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("div",{className:"min-w-max",children:[(0,a.jsxs)("div",{className:"flex items-end gap-1 mb-2",children:[(0,a.jsx)("div",{className:(0,h.W)("w-16 flex-shrink-0",o,"font-bold text-neutral-500")}),(0,a.jsxs)("div",{className:"flex gap-px",children:[(0,a.jsx)("div",{className:(0,h.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:[1,2,3,4,5].map(e=>(0,a.jsx)("div",{className:(0,h.W)(d,"flex items-end justify-center",o,"text-neutral-400"),children:e},"l1-".concat(e)))}),(0,a.jsx)("div",{className:(0,h.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:[6,7,8,9,10].map(e=>(0,a.jsx)("div",{className:(0,h.W)(d,"flex items-end justify-center",o,"text-neutral-400"),children:e},"l2-".concat(e)))}),(0,a.jsx)("div",{className:"flex gap-px",children:[11,12,13,14,15].map(e=>(0,a.jsx)("div",{className:(0,h.W)(d,"flex items-end justify-center",o,"text-neutral-400"),children:e},"l3-".concat(e)))})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,a.jsx)("div",{className:(0,h.W)("w-16 flex-shrink-0",o,"font-bold text-neutral-500")}),(0,a.jsxs)("div",{className:"flex gap-px",children:[(0,a.jsx)("div",{className:(0,h.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:(0,a.jsx)("div",{className:(0,h.W)("flex items-center justify-center bg-indigo-100 dark:bg-indigo-900/30 rounded px-2 py-0.5",o,"font-bold text-indigo-600 dark:text-indigo-400"),style:{width:l?88:134},children:"Level 1"})}),(0,a.jsx)("div",{className:(0,h.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:(0,a.jsx)("div",{className:(0,h.W)("flex items-center justify-center bg-purple-100 dark:bg-purple-900/30 rounded px-2 py-0.5",o,"font-bold text-purple-600 dark:text-purple-400"),style:{width:l?88:134},children:"Level 2"})}),(0,a.jsx)("div",{className:"flex gap-px",children:(0,a.jsx)("div",{className:(0,h.W)("flex items-center justify-center bg-pink-100 dark:bg-pink-900/30 rounded px-2 py-0.5",o,"font-bold text-pink-600 dark:text-pink-400"),style:{width:l?88:134},children:"Level 3"})})]})]}),(0,a.jsx)("div",{className:"space-y-1",children:eH.map(e=>{let t=n[e];if(!t)return null;let r=t.level1.length>0,s=t.level2.length>0,l=t.level3.length>0;return r||s||l?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,h.W)("w-16 flex-shrink-0 text-right pr-2",o,"font-bold text-neutral-700 dark:text-neutral-300"),children:e}),(0,a.jsxs)("div",{className:"flex gap-px",children:[(0,a.jsx)("div",{className:"flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1",children:[0,1,2,3,4].map(r=>{let s=t.level1[r],l=r<t.level1.length;return(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm transition-colors",l?i(s):"bg-neutral-50 dark:bg-neutral-900"),title:l?"".concat(e," ").concat(r+1,": ").concat(null!=s?s:"Not scored"):void 0},"".concat(e,"-l1-").concat(r))})}),(0,a.jsx)("div",{className:"flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1",children:[0,1,2,3,4].map(r=>{let s=t.level2[r],l=r<t.level2.length;return(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm transition-colors",l?i(s):"bg-neutral-50 dark:bg-neutral-900"),title:l?"".concat(e," ").concat(r+6,": ").concat(null!=s?s:"Not scored"):void 0},"".concat(e,"-l2-").concat(r))})}),(0,a.jsx)("div",{className:"flex gap-px",children:[0,1,2,3,4].map(r=>{let s=t.level3[r],l=r<t.level3.length;return(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm transition-colors",l?i(s):"bg-neutral-50 dark:bg-neutral-900"),title:l?"".concat(e," ").concat(r+11,": ").concat(null!=s?s:"Not scored"):void 0},"".concat(e,"-l3-").concat(r))})})]})]},e):null})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("span",{className:(0,h.W)(o,"text-neutral-500 font-medium"),children:"Legend:"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm bg-neutral-200 dark:bg-neutral-700")}),(0,a.jsx)("span",{className:(0,h.W)(o,"text-neutral-500"),children:"0 - Not present"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm bg-warning-400")}),(0,a.jsx)("span",{className:(0,h.W)(o,"text-neutral-500"),children:"\xbd - Emerging"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm bg-success-500")}),(0,a.jsx)("span",{className:(0,h.W)(o,"text-neutral-500"),children:"1 - Mastered"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,h.W)(d,"rounded-sm bg-neutral-100 dark:bg-neutral-800")}),(0,a.jsx)("span",{className:(0,h.W)(o,"text-neutral-500"),children:"Not scored"})]})]})]})})}function eq(e){let{clientId:t,clientName:r,onStartNew:l,onContinue:n,onView:i,onReEvaluate:d}=e,{evaluations:o,loading:c,error:u}=(0,eJ.Dy)(t),{deleteEvaluation:p,saving:b}=(0,eJ.vS)(),{success:v,error:j}=(0,g.useToast)(),[f,N]=(0,s.useState)(null),[k,w]=(0,s.useState)(null),y=async e=>{if(confirm("Delete this VB-MAPP evaluation? This cannot be undone.")){w(e);try{await p(t,e),v("Evaluation deleted")}catch(e){console.error("Failed to delete evaluation:",e),j("Failed to delete evaluation")}finally{w(null),N(null)}}},C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),S=o.filter(e=>"in_progress"===e.status),D=o.filter(e=>"completed"===e.status);return c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):u?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-error-500",children:u})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("button",{onClick:l,className:"w-full py-4 border-2 border-dashed border-purple-300 dark:border-purple-700 rounded-2xl text-purple-600 dark:text-purple-400 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20 transition-all font-medium flex items-center justify-center gap-2",children:[(0,a.jsx)(O.Z,{className:"w-5 h-5"}),"Start New VB-MAPP Evaluation"]}),S.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),"In Progress (",S.length,")"]}),S.map(e=>(0,a.jsxs)("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Started ",C(e.createdAt)," \xb7 ",e.overallMilestonePercentage,"% scored"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>n(e.id),className:"px-4 py-2 bg-warning-600 hover:bg-warning-700 text-white rounded-lg font-medium text-sm transition-colors flex items-center gap-2",children:["Continue",(0,a.jsx)(L.Z,{className:"w-4 h-4"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-warning-100 dark:hover:bg-warning-900/30 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:k===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[k===e.id?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]}),(0,a.jsx)("div",{className:"mt-3 h-1.5 bg-warning-200 dark:bg-warning-900/50 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all",style:{width:"".concat(e.overallMilestonePercentage,"%")}})})]},e.id))]}),D.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"w-4 h-4"}),"Completed (",D.length,")"]}),D.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-4 hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Completed ",C(e.completedAt||e.updatedAt)]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName," \xb7 Level ",e.dominantLevel]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,h.W)("text-2xl font-bold",e.overallMilestonePercentage>=70?"text-success-600":e.overallMilestonePercentage>=40?"text-warning-600":"text-error-600"),children:[e.overallMilestonePercentage,"%"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400",children:[e.overallMilestoneScore,"/",e.overallMilestoneMaxScore]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>i(e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",title:"View details",children:(0,a.jsx)(ea.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,a.jsx)("button",{onClick:()=>d(e),className:"p-2 rounded-lg hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors",title:"Start re-evaluation",children:(0,a.jsx)(Z.Z,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:k===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[k===e.id?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-neutral-100 dark:border-neutral-800",children:(0,a.jsx)(e_,{evaluation:e,compact:!0})})]},e.id))]}),0===o.length&&(0,a.jsxs)("div",{className:"text-center py-12 bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-2xl",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No VB-MAPP Evaluations Yet"}),(0,a.jsxs)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-6",children:["Start a VB-MAPP evaluation to assess ",r,"'s verbal behavior milestones and track progress."]}),(0,a.jsxs)("button",{onClick:l,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-purple-500/20",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),"Start First Evaluation"]})]})]})}var eK=r(61524);let eY=[{value:0,label:"0",color:"text-white",bgColor:"bg-error-500"},{value:.5,label:"\xbd",color:"text-white",bgColor:"bg-warning-500"},{value:1,label:"1",color:"text-white",bgColor:"bg-success-500"}];function eQ(e){let{area:t,scores:r,previousScores:l,onScoreChange:n,readOnly:i=!1}=e,[d,o]=(0,s.useState)(new Set),[c,x]=(0,s.useState)({}),[m,u]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=0,a=null;for(let s=0;s<t.items.length;s++){let l=t.items[s],n=r[l.id],i=null==n?void 0:n.score,d=null==n?void 0:n.isNA;if(0!==i||d?(.5===i||1===i)&&(e=0):e++,e>=3){a=l.id;break}}u(a)},[t.items,r]);let p=e=>{let t=new Set(d);t.has(e)?t.delete(e):t.add(e),o(t)},g=(e,t)=>{x(r=>({...r,[e]:t}))},b=e=>{let t=r[e];if(t){let r=c[e]||t.note;n(e,t.score,r,t.isNA)}},v=e=>{if(!(null==l?void 0:l[e])||!r[e])return null;let t=l[e].score,a=r[e].score-t;return{diff:a,trend:a>0?"up":a<0?"down":"same"}};return(0,a.jsxs)("div",{className:"space-y-3",children:[m&&!i&&(0,a.jsxs)("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[(0,a.jsx)(ep.Z,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-bold text-amber-800 dark:text-amber-400",children:"Ceiling Reached"}),(0,a.jsx)("p",{className:"text-xs text-amber-700 dark:text-amber-500 mt-0.5",children:"Three consecutive 0s detected. Clinical standard suggests stopping testing for this skill area."})]})]}),t.items.map((e,s)=>{var l,o;let x=r[e.id],u=null==x?void 0:x.score,j=null==x?void 0:x.isNA,f=d.has(e.id),N=v(e.id),k=null!==(o=null!==(l=c[e.id])&&void 0!==l?l:null==x?void 0:x.note)&&void 0!==o?o:"",w=t.items.findIndex(t=>t.id===e.id),y=m?t.items.findIndex(e=>e.id===m):1/0;return(0,a.jsx)("div",{className:(0,h.W)("rounded-xl border transition-all",j?"bg-neutral-100 dark:bg-neutral-800/20 border-dashed border-neutral-300 opacity-75":void 0!==u?"bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700":w>y?"bg-neutral-100/50 dark:bg-neutral-800/20 border-dashed border-neutral-200 dark:border-neutral-800 opacity-60":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-200 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("span",{className:"text-sm font-bold text-neutral-400",children:s+1}),(0,a.jsxs)("span",{className:"text-[10px] text-neutral-400 mt-0.5",children:[e.months,"mo"]})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 leading-relaxed",children:e.text}),N&&!j&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-1",children:["up"===N.trend?(0,a.jsx)(em.Z,{className:"w-3 h-3 text-success-500"}):"down"===N.trend?(0,a.jsx)(ek.Z,{className:"w-3 h-3 text-error-500"}):(0,a.jsx)(ew.Z,{className:"w-3 h-3 text-neutral-400"}),(0,a.jsxs)("span",{className:(0,h.W)("text-xs","up"===N.trend?"text-success-600":"down"===N.trend?"text-error-600":"text-neutral-500"),children:[N.diff>0?"+":"",N.diff," from previous"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,0,null==x?void 0:x.note,!j),disabled:i,className:(0,h.W)("px-2 h-9 rounded-lg font-bold text-[10px] transition-all",j?"bg-neutral-500 text-white shadow-lg":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200"),children:"N/A"}),eY.map(t=>(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,t.value,k||void 0,!1),disabled:i,className:(0,h.W)("w-9 h-9 rounded-lg font-bold text-sm transition-all",u!==t.value||j?i?"bg-neutral-100 dark:bg-neutral-800 text-neutral-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200 dark:hover:bg-neutral-700":"".concat(t.bgColor," ").concat(t.color," ring-2 ring-offset-2")),children:t.label},t.value))]}),(0,a.jsx)("button",{onClick:()=>p(e.id),className:(0,h.W)("p-2 rounded-lg transition-colors",f||(null==x?void 0:x.note)?"bg-primary-100 dark:bg-primary-900/30 text-primary-600":"hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-400"),children:(0,a.jsx)(eb.Z,{className:"w-4 h-4"})})]}),f&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-neutral-200 dark:border-neutral-700",children:(0,a.jsx)("textarea",{value:k,onChange:t=>g(e.id,t.target.value),onBlur:()=>b(e.id),placeholder:"Add observation notes...",disabled:i,className:"w-full px-3 py-2 text-sm bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50",rows:2})})]})},e.id)})]})}let e$=[{value:0,label:"0",description:"Not a barrier",color:"bg-success-500"},{value:1,label:"1",description:"Minor barrier",color:"bg-success-400"},{value:2,label:"2",description:"Moderate barrier",color:"bg-warning-400"},{value:3,label:"3",description:"Significant barrier",color:"bg-warning-500"},{value:4,label:"4",description:"Severe barrier",color:"bg-error-500"}];function eX(e){let{barriers:t,scores:r,onScoreChange:l,readOnly:n=!1}=e,[i,d]=(0,s.useState)(new Set),[o,c]=(0,s.useState)({}),x=e=>{let t=new Set(i);t.has(e)?t.delete(e):t.add(e),d(t)},m=(e,t)=>{c(r=>({...r,[e]:t}))},u=e=>{var t,a;let s=null===(t=r[e])||void 0===t?void 0:t.score;if(void 0!==s){let t=o[e]||(null===(a=r[e])||void 0===a?void 0:a.note);l(e,s,t)}},p=e=>{var t;return void 0===e?"bg-neutral-200 dark:bg-neutral-700":(null===(t=e$.find(t=>t.value===e))||void 0===t?void 0:t.color)||"bg-neutral-200"};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Rate each barrier from 0 (not present) to 4 (severe):"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:e$.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:(0,h.W)("w-6 h-6 rounded text-white text-xs font-bold flex items-center justify-center",e.color),children:e.value}),(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:e.description})]},e.value))})]}),(0,a.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>{var s,d;let c=r[e.id],g=i.has(e.id),b=null!==(d=null!==(s=o[e.id])&&void 0!==s?s:null==c?void 0:c.note)&&void 0!==d?d:"",v=c&&c.score>=3;return(0,a.jsx)("div",{className:(0,h.W)("rounded-xl border transition-all",v?"bg-error-50 dark:bg-error-900/20 border-error-200 dark:border-error-800":void 0!==c?"bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-200 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:(0,h.W)("w-2 h-full min-h-[40px] rounded-full",p(null==c?void 0:c.score))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-bold text-neutral-400",children:["B",t+1]}),v&&(0,a.jsx)(eK.Z,{className:"w-4 h-4 text-error-500"})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 leading-relaxed",children:e.text})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:e$.map(t=>(0,a.jsx)("button",{onClick:()=>!n&&l(e.id,t.value,b||void 0),disabled:n,className:(0,h.W)("w-8 h-8 rounded-lg font-bold text-xs transition-all",(null==c?void 0:c.score)===t.value?"".concat(t.color," text-white ring-2 ring-offset-2"):n?"bg-neutral-100 dark:bg-neutral-800 text-neutral-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:t.value},t.value))}),(0,a.jsx)("button",{onClick:()=>x(e.id),className:(0,h.W)("p-2 rounded-lg transition-colors",g||(null==c?void 0:c.note)?"bg-primary-100 dark:bg-primary-900/30 text-primary-600":"hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-400"),children:(0,a.jsx)(eb.Z,{className:"w-4 h-4"})})]}),g&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-neutral-200 dark:border-neutral-700 ml-6",children:(0,a.jsx)("textarea",{value:b,onChange:t=>m(e.id,t.target.value),onBlur:()=>u(e.id),placeholder:"Add observation notes about this barrier...",disabled:n,className:"w-full px-3 py-2 text-sm bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50",rows:2})})]})},e.id)})})]})}let e0=[{id:"level1",label:"Level 1",description:"0-18 months"},{id:"level2",label:"Level 2",description:"18-30 months"},{id:"level3",label:"Level 3",description:"30-48 months"},{id:"barriers",label:"Barriers",description:"24 items"},{id:"transition",label:"Transition",description:"18 items"}];function e2(e){let{isOpen:t,onClose:r,clientId:l,clientName:n,evaluationId:i,previousEvaluation:d}=e,{user:o,userData:c}=(0,p.useAuth)(),{success:x,error:m}=(0,g.useToast)(),{saving:u,createEvaluation:b,saveProgress:v,completeEvaluation:j}=(0,eJ.vS)(),[f,N]=(0,s.useState)("level1"),[k,w]=(0,s.useState)(0),[y,S]=(0,s.useState)({}),[Z,D]=(0,s.useState)({}),[A,E]=(0,s.useState)({}),[W,I]=(0,s.useState)(i||null),[T,F]=(0,s.useState)(!1),[M,B]=(0,s.useState)(!1),O=(0,s.useRef)(!1),{evaluation:z,loading:R}=(0,eJ.F9)(l,W||""),U=(()=>{switch(f){case"level1":return eJ.wB;case"level2":return eJ.H3;case"level3":return eJ.PW;default:return[]}})(),V=U[k];(0,s.useEffect)(()=>{t&&(async()=>{if(i)I(i);else if(!W&&!O.current){O.current=!0,F(!0);try{let e=await b(l,(null==o?void 0:o.uid)||"",(null==c?void 0:c.name)||"Unknown",null==d?void 0:d.id);I(e),x("VB-MAPP evaluation started")}catch(e){console.error("Failed to create VB-MAPP evaluation:",e),m("Failed to start evaluation"),r()}finally{F(!1)}}})()},[t,i,l]),(0,s.useEffect)(()=>{z&&(S(z.milestoneScores||{}),D(z.barrierScores||{}),E(z.transitionScores||{}))},[z]),(0,s.useEffect)(()=>{t||(N("level1"),w(0),S({}),D({}),E({}),I(i||null),B(!1),O.current=!1)},[t,i]);let G=(0,s.useCallback)((e,t,r,a)=>{S(s=>({...s,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==a&&{isNA:a},...void 0!==r&&""!==r&&{note:r}}})),B(!0)},[]),J=(0,s.useCallback)((e,t,r)=>{D(a=>({...a,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==r&&""!==r&&{note:r}}})),B(!0)},[]),H=(0,s.useCallback)((e,t,r)=>{E(a=>({...a,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==r&&""!==r&&{note:r}}})),B(!0)},[]),q=Object.keys(y).length,K=Object.keys(Z).length,Y=Object.keys(A).length,Q=Math.round((q+K+Y)/(eJ.XT+eJ.ek.length+eJ.Zi.length)*100),$=async()=>{if(W)try{await v(l,W,y,Z,A),B(!1),x("Progress saved")}catch(e){console.error("Failed to save progress:",e),m("Failed to save progress")}},X=async()=>{if(!W)return;let e=eJ.XT+eJ.ek.length+eJ.Zi.length,t=q+K+Y;if(!(t<e)||window.confirm("You have scored ".concat(t," of ").concat(e," items. Complete anyway?")))try{await j(l,W,y,Z,A),x("VB-MAPP evaluation completed!"),r()}catch(e){console.error("Failed to complete evaluation:",e),m("Failed to complete evaluation")}},ee=()=>{if(M&&window.confirm("Save changes before closing?")){$().then(()=>r());return}r()},et="level1"===f&&0===k;return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:ee}),(0,a.jsxs)("div",{className:"relative w-full max-w-5xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[n,d&&(0,a.jsx)("span",{className:"ml-2 text-primary-600",children:"(Re-evaluation)"})]})]}),(0,a.jsx)("button",{onClick:ee,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(_.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Overall Progress"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-primary-600",children:[Q,"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300",style:{width:"".concat(Q,"%")}})})]}),(0,a.jsx)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800 overflow-x-auto",children:(0,a.jsx)("div",{className:"flex gap-2 min-w-max",children:e0.map(e=>{let t=e.id===f;return(0,a.jsxs)("button",{onClick:()=>{N(e.id),w(0)},className:(0,h.W)("px-4 py-2 rounded-lg text-sm font-medium transition-all flex flex-col items-start",t?"bg-primary-600 text-white":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)("span",{className:(0,h.W)("text-[10px]",t?"text-white/70":"text-neutral-400"),children:e.description})]},e.id)})})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:T||R?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,a.jsxs)(a.Fragment,{children:[("level1"===f||"level2"===f||"level3"===f)&&V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:U.map((e,t)=>{let r=e.items.filter(e=>y[e.id]).length,s=r===e.items.length,l=t===k;return(0,a.jsxs)("button",{onClick:()=>w(t),className:(0,h.W)("px-3 py-1.5 rounded-lg text-sm font-medium transition-all",l?"bg-primary-600 text-white":s?"bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400":r>0?"bg-warning-100 dark:bg-warning-900/30 text-warning-700 dark:text-warning-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400"),children:[e.code,s&&!l&&(0,a.jsx)(C.Z,{className:"w-3 h-3 ml-1 inline"})]},e.id)})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:[V.code,": ",V.name]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[V.items.filter(e=>y[e.id]).length," of ",V.items.length," items scored"]})]}),(0,a.jsxs)("div",{className:"mb-6 p-3 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl flex flex-wrap gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-error-500 text-white flex items-center justify-center font-bold",children:"0"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Not present"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-warning-500 text-white flex items-center justify-center font-bold",children:"\xbd"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Emerging"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-success-500 text-white flex items-center justify-center font-bold",children:"1"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Mastered"})]})]}),(0,a.jsx)(eQ,{area:V,scores:y,previousScores:null==d?void 0:d.milestoneScores,onScoreChange:G})]}),"barriers"===f&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(eK.Z,{className:"w-6 h-6 text-warning-500"}),"Barriers Assessment"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[K," of ",eJ.ek.length," barriers assessed"]})]}),(0,a.jsx)(eX,{barriers:eJ.ek,scores:Z,onScoreChange:J})]}),"transition"===f&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(eC.Z,{className:"w-6 h-6 text-primary-500"}),"Transition Assessment"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[Y," of ",eJ.Zi.length," items assessed"]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Rate readiness from 1 (not ready) to 5 (fully ready):"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:[1,2,3,4,5].map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:(0,h.W)("w-6 h-6 rounded text-white text-xs font-bold flex items-center justify-center",e<=2?"bg-error-500":e<=3?"bg-warning-500":"bg-success-500"),children:e}),(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:1===e?"Not ready":5===e?"Fully ready":""})]},e))})]}),(0,a.jsx)("div",{className:"space-y-3",children:eJ.Zi.map((e,t)=>{let r=A[e.id];return(0,a.jsx)("div",{className:(0,h.W)("rounded-xl border p-4 transition-all",r?"bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-200 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("span",{className:"text-sm font-bold text-neutral-400",children:["T",t+1]}),(0,a.jsx)("p",{className:"flex-1 text-sm text-neutral-700 dark:text-neutral-300",children:e.text}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>(0,a.jsx)("button",{onClick:()=>H(e.id,t),className:(0,h.W)("w-8 h-8 rounded-lg font-bold text-xs transition-all",(null==r?void 0:r.score)===t?t<=2?"bg-error-500 text-white ring-2 ring-offset-2":t<=3?"bg-warning-500 text-white ring-2 ring-offset-2":"bg-success-500 text-white ring-2 ring-offset-2":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200"),children:t},t))})]})},e.id)})})]})]})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsxs)("button",{onClick:()=>{if("level1"===f||"level2"===f||"level3"===f){if(k>0)w(k-1);else{let e=e0.findIndex(e=>e.id===f);if(e>0){let t=e0[e-1].id;N(t),w(("level1"===t?eJ.wB:"level2"===t?eJ.H3:"level3"===t?eJ.PW:[]).length-1)}}}else{let e=e0.findIndex(e=>e.id===f);if(e>0){let t=e0[e-1].id;N(t),w(Math.max(0,("level1"===t?eJ.wB:"level2"===t?eJ.H3:"level3"===t?eJ.PW:[]).length-1))}}},disabled:et,className:(0,h.W)("px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",et?"text-neutral-400 cursor-not-allowed":"text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800"),children:[(0,a.jsx)(eh.Z,{className:"w-4 h-4"}),"Previous"]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[M&&(0,a.jsxs)("span",{className:"text-xs text-warning-600 flex items-center gap-1",children:[(0,a.jsx)(ep.Z,{className:"w-3 h-3"}),"Unsaved changes"]}),(0,a.jsxs)("button",{onClick:$,disabled:u||!M,className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2 disabled:opacity-50",children:[u?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(eg.Z,{className:"w-4 h-4"}),"Save Draft"]}),"transition"===f?(0,a.jsxs)("button",{onClick:X,disabled:u,className:"px-6 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white transition-colors flex items-center gap-2 disabled:opacity-50",children:[u?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(C.Z,{className:"w-4 h-4"}),"Complete Evaluation"]}):(0,a.jsxs)("button",{onClick:()=>{if("level1"===f||"level2"===f||"level3"===f){if(k<U.length-1)w(k+1);else{let e=e0.findIndex(e=>e.id===f);e<e0.length-1&&(N(e0[e+1].id),w(0))}}else{let e=e0.findIndex(e=>e.id===f);e<e0.length-1&&(N(e0[e+1].id),w(0))}},className:"px-6 py-2 rounded-lg text-sm font-medium bg-primary-600 hover:bg-primary-700 text-white transition-colors flex items-center gap-2",children:["Next",(0,a.jsx)(L.Z,{className:"w-4 h-4"})]})]})]})]})]}):null}function e5(e){let{isOpen:t,onClose:r,clientId:l,clientData:n,evaluationId:i,previousEvaluation:d,onReEvaluate:o}=e,{evaluation:c,loading:x}=(0,eJ.F9)(l,i),[m,u]=(0,s.useState)(null);if(!t)return null;let p=d&&c?c.overallMilestonePercentage-d.overallMilestonePercentage:null,g=e=>{switch(e){case"ready":return{label:"Ready",color:"text-success-600 bg-success-100 dark:bg-success-900/30"};case"developing":return{label:"Developing",color:"text-warning-600 bg-warning-100 dark:bg-warning-900/30"};case"emerging":return{label:"Emerging",color:"text-orange-600 bg-orange-100 dark:bg-orange-900/30"};default:return{label:"Not Ready",color:"text-error-600 bg-error-100 dark:bg-error-900/30"}}},b=n.birthDate?(0,eD.Fw)(n.birthDate):null,v=c?(0,eD.JW)(c.dominantLevel):"",f=b&&c?(0,eD.Sy)(b.totalMonths,(0,eD.QI)(c.overallMilestoneScore)):null,N=f&&c?(0,eP.c9)(f.delayPercentage,f.severityLabel,c.dominantLevel):null,k=c?(0,eA.pH)(c,n.name||"Client",eJ.W3):[];return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-5xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation Results"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:n.name})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(_.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:x||!c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(D.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:new Date(c.completedAt||c.updatedAt).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Evaluator"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:c.evaluatorName})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(U.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Dominant Level"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:["Level ",c.dominantLevel]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(eC.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Transition Readiness"}),(0,a.jsx)("span",{className:(0,h.W)("text-xs font-bold px-2 py-0.5 rounded",g(c.transitionSummary.readinessLevel).color),children:g(c.transitionSummary.readinessLevel).label})]})]})]}),b&&f&&(0,a.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800 flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider",children:"Chronological Age"}),(0,a.jsx)("p",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:(0,eD.KD)(b)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider",children:"Dev. Age Equivalent"}),(0,a.jsx)("p",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:v})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider",children:"Developmental Delay"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:f.delayMonths>0?"".concat(f.delayMonths," months"):"None"}),f.delayMonths>0&&(0,a.jsx)("span",{className:(0,h.W)("text-xs px-2 py-0.5 rounded font-bold uppercase","profound"===f.severityLabel?"bg-red-100 text-red-700":"severe"===f.severityLabel?"bg-orange-100 text-orange-700":"moderate"===f.severityLabel?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"),children:f.severityLabel})]})]})]}),N&&(0,a.jsx)("div",{className:(0,h.W)("p-4 rounded-xl border","excellent"===N.level?"bg-success-50 border-success-200 dark:bg-success-900/20 dark:border-success-800":"good"===N.level?"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":"moderate"===N.level?"bg-warning-50 border-warning-200 dark:bg-warning-900/20 dark:border-warning-800":"bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ep.Z,{className:(0,h.W)("w-5 h-5 mt-0.5 flex-shrink-0","excellent"===N.level?"text-success-600":"good"===N.level?"text-blue-600":"moderate"===N.level?"text-warning-600":"text-orange-600")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:["Clinical Interpretation: ",N.title]}),(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mt-1",children:N.description}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-800 dark:text-neutral-200 mt-2",children:N.recommendation}),N.interventionHours&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1 italic",children:N.interventionHours}),k.length>0&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-current/10",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ey.Z,{className:"w-4 h-4 text-amber-500"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:[(0,a.jsx)("span",{className:"font-bold text-amber-600",children:k.length})," emerging skills identified for IEP goal development"]})]})})]})]})}),(0,a.jsx)("div",{className:"p-6 bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/30 dark:to-purple-900/20 rounded-2xl border border-indigo-200 dark:border-indigo-800",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-indigo-600 dark:text-indigo-400 mb-1",children:"Overall Milestones Score"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-5xl font-bold",c.overallMilestonePercentage>=70?"text-success-600":c.overallMilestonePercentage>=40?"text-warning-600":"text-error-600"),children:[c.overallMilestonePercentage,"%"]}),(0,a.jsxs)("span",{className:"text-neutral-500",children:["(",c.overallMilestoneScore," / ",c.overallMilestoneMaxScore," points)"]})]}),null!==p&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[p>0?(0,a.jsx)(em.Z,{className:"w-4 h-4 text-success-600"}):p<0?(0,a.jsx)(ek.Z,{className:"w-4 h-4 text-error-600"}):(0,a.jsx)(ew.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:(0,h.W)("text-sm font-medium",p>0?"text-success-600":p<0?"text-error-600":"text-neutral-500"),children:[p>0?"+":"",p,"% since last evaluation"]})]})]})})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Milestone Grid"}),(0,a.jsx)(e_,{evaluation:c,previousEvaluation:d})]}),k.length>0&&(0,a.jsx)(eE,{goals:k,title:"Suggested IEP Goals",emptyMessage:"No emerging skills identified for goal development."}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Level Breakdown"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(c.levelSummaries).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:(0,h.W)("p-4 rounded-xl border","1"===t?"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-200 dark:border-indigo-800":"2"===t?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":"bg-pink-50 dark:bg-pink-900/20 border-pink-200 dark:border-pink-800"),children:[(0,a.jsx)("p",{className:(0,h.W)("text-sm font-medium mb-2","1"===t?"text-indigo-600 dark:text-indigo-400":"2"===t?"text-purple-600 dark:text-purple-400":"text-pink-600 dark:text-pink-400"),children:r.levelName}),(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-3xl font-bold",r.percentage>=70?"text-success-600":r.percentage>=40?"text-warning-600":"text-error-600"),children:[r.percentage,"%"]}),(0,a.jsxs)("span",{className:"text-xs text-neutral-500",children:[r.totalScore,"/",r.maxPossibleScore]})]}),(0,a.jsx)("div",{className:"mt-2 h-2 bg-white/50 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,h.W)("h-full transition-all",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(r.percentage,"%")}})})]},t)})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>u("barriers"===m?null:"barriers"),className:"w-full p-4 flex items-center justify-between hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(eK.Z,{className:"w-5 h-5 text-warning-500"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Barriers Assessment"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[c.barrierSummary.severeBarriers.length," severe barriers identified"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-lg font-bold",c.barrierSummary.averageSeverity<=1?"text-success-600":c.barrierSummary.averageSeverity<=2?"text-warning-600":"text-error-600"),children:["Avg: ",c.barrierSummary.averageSeverity]}),"barriers"===m?(0,a.jsx)(G.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(J.Z,{className:"w-5 h-5 text-neutral-400"})]})]}),"barriers"===m&&(0,a.jsx)("div",{className:"p-4 pt-0 border-t border-neutral-200 dark:border-neutral-700",children:(0,a.jsx)("div",{className:"space-y-2 mt-4",children:eJ.ek.filter(e=>c.barrierScores[e.id]).map((e,t)=>{var r;let s=null===(r=c.barrierScores[e.id])||void 0===r?void 0:r.score;return(0,a.jsxs)("div",{className:(0,h.W)("p-3 rounded-lg flex items-center gap-3",s>=3?"bg-error-50 dark:bg-error-900/20":"bg-neutral-50 dark:bg-neutral-800"),children:[(0,a.jsx)("span",{className:(0,h.W)("w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white text-sm",0===s?"bg-success-500":s<=2?"bg-warning-500":"bg-error-500"),children:s}),(0,a.jsx)("span",{className:"text-sm text-neutral-700 dark:text-neutral-300 flex-1 font-medium",children:e.text.split("(")[0].trim()})]},e.id)})})})]}),(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(eC.Z,{className:"w-5 h-5 text-primary-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Transition Assessment"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[c.transitionSummary.scoredItems,"/",c.transitionSummary.totalItems," items scored"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:(0,h.W)("text-2xl font-bold",c.transitionSummary.percentage>=80?"text-success-600":c.transitionSummary.percentage>=60?"text-warning-600":"text-error-600"),children:[c.transitionSummary.percentage,"%"]}),(0,a.jsx)("span",{className:(0,h.W)("px-3 py-1 rounded-full text-sm font-bold",g(c.transitionSummary.readinessLevel).color),children:g(c.transitionSummary.readinessLevel).label})]})]})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:"Close"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{c&&(0,eZ.l)(c,n,eJ.ek)},className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2",children:[(0,a.jsx)(es.Z,{className:"w-4 h-4"}),"Clinical PDF"]}),(0,a.jsxs)("button",{onClick:()=>(0,eZ.l)(c,n,eJ.ek,!0),className:"px-4 py-2 rounded-lg text-sm font-medium border border-indigo-200 text-indigo-700 hover:bg-indigo-50 transition-colors flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"}),"Parent Version"]}),o&&(0,a.jsxs)("button",{onClick:o,className:"px-4 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white transition-colors flex items-center gap-2",children:[(0,a.jsx)(Z.Z,{className:"w-4 h-4"}),"Start Re-evaluation"]})]})]})]})]})}function e4(e){let{client:t}=e,[r,l]=(0,s.useState)("ablls"),[n,i]=(0,s.useState)("list"),[d,o]=(0,s.useState)({type:"none"}),{evaluations:c}=(0,F.F3)(t.id),[x,m]=(0,s.useState)({type:"none"}),{evaluations:u}=(0,eJ.Dy)(t.id),p=c.filter(e=>"completed"===e.status).length;u.filter(e=>"completed"===e.status).length;let g=()=>c.find(e=>"completed"===e.status),b=()=>u.find(e=>"completed"===e.status);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsxs)("button",{onClick:()=>l("ablls"),className:(0,h.W)("px-4 py-2 text-sm font-medium transition-colors relative","ablls"===r?"text-primary-600 dark:text-primary-400":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:["ABLLS-R","ablls"===r&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"})]}),(0,a.jsxs)("button",{onClick:()=>l("vbmapp"),className:(0,h.W)("px-4 py-2 text-sm font-medium transition-colors relative","vbmapp"===r?"text-purple-600 dark:text-purple-400":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:["VB-MAPP","vbmapp"===r&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-purple-500"})]})]}),"ablls"===r&&(0,a.jsxs)("div",{className:"flex items-center bg-neutral-100 dark:bg-neutral-800 rounded-xl p-1",children:[(0,a.jsxs)("button",{onClick:()=>i("list"),className:(0,h.W)("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors","list"===n?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(W.Z,{className:"w-4 h-4"}),"Evaluations"]}),(0,a.jsxs)("button",{onClick:()=>i("progress"),className:(0,h.W)("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors","progress"===n?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(em.Z,{className:"w-4 h-4"}),"Progress",p>=2&&(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 text-xs rounded-full",children:p})]})]})]}),"ablls"===r&&(0,a.jsxs)(a.Fragment,{children:["list"===n?(0,a.jsx)(eu,{clientId:t.id,clientName:t.name,onStartNew:()=>{o({type:"wizard",previousEvaluation:g()||void 0})},onContinue:e=>{o({type:"wizard",evaluationId:e})},onView:e=>{let t=c.findIndex(t=>t.id===e);o({type:"summary",evaluationId:e,previousEvaluation:c.slice(t+1).find(e=>"completed"===e.status)})},onReEvaluate:e=>{o({type:"wizard",previousEvaluation:e})}}):(0,a.jsx)(eG,{evaluations:c,clientName:t.name}),(0,a.jsx)(ef,{isOpen:"wizard"===d.type,onClose:()=>o({type:"none"}),clientId:t.id,clientName:t.name,evaluationId:"wizard"===d.type?d.evaluationId:void 0,previousEvaluation:"wizard"===d.type?d.previousEvaluation:void 0}),"summary"===d.type&&(0,a.jsx)(eW,{isOpen:!0,onClose:()=>o({type:"none"}),clientId:t.id,clientData:t,evaluationId:d.evaluationId,previousEvaluation:d.previousEvaluation,onReEvaluate:()=>{if("summary"===d.type){let e=c.find(e=>e.id===d.evaluationId);e&&o({type:"wizard",previousEvaluation:e})}}})]}),"vbmapp"===r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eq,{clientId:t.id,clientName:t.name,onStartNew:()=>{m({type:"wizard",previousEvaluation:b()||void 0})},onContinue:e=>{m({type:"wizard",evaluationId:e})},onView:e=>{let t=u.findIndex(t=>t.id===e);m({type:"summary",evaluationId:e,previousEvaluation:u.slice(t+1).find(e=>"completed"===e.status)})},onReEvaluate:e=>{m({type:"wizard",previousEvaluation:e})}}),(0,a.jsx)(e2,{isOpen:"wizard"===x.type,onClose:()=>m({type:"none"}),clientId:t.id,clientName:t.name,evaluationId:"wizard"===x.type?x.evaluationId:void 0,previousEvaluation:"wizard"===x.type?x.previousEvaluation:void 0}),"summary"===x.type&&(0,a.jsx)(e5,{isOpen:!0,onClose:()=>m({type:"none"}),clientId:t.id,clientData:t,evaluationId:x.evaluationId,previousEvaluation:x.previousEvaluation,onReEvaluate:()=>{if("summary"===x.type){let e=u.find(e=>e.id===x.evaluationId);e&&m({type:"wizard",previousEvaluation:e})}}})]})]})}function e1(e){let{isOpen:t,onClose:r,client:l}=e,{success:d,error:o}=(0,g.useToast)(),{user:c}=(0,p.useAuth)(),{data:x}=(0,T.lU)(),[m,u]=(0,s.useState)(!1),[h,b]=(0,s.useState)({name:"",birthDate:"",diagnosisDate:"",primaryDiagnosis:"",diagnosisLevel:"1",phone:"",parentName:"",parentEmail:"",medicalInfo:"",assignedTherapistId:""});(0,s.useEffect)(()=>{if(l&&t){var e;b({name:l.name||"",birthDate:l.birthDate||"",diagnosisDate:l.diagnosisDate||"",primaryDiagnosis:l.primaryDiagnosis||"",diagnosisLevel:(null===(e=l.diagnosisLevel)||void 0===e?void 0:e.toString())||"1",phone:l.phone||"",parentName:l.parentName||"",parentEmail:l.parentEmail||"",medicalInfo:l.medicalInfo||"",assignedTherapistId:l.assignedTherapistId||""})}},[l,t]);let v=async e=>{e.preventDefault(),u(!0);try{let e=(0,n.JU)(i.db,"clients",l.id),t={name:h.name,birthDate:h.birthDate||null,diagnosisDate:h.diagnosisDate||null,primaryDiagnosis:h.primaryDiagnosis,diagnosisLevel:parseInt(h.diagnosisLevel),phone:h.phone,parentName:h.parentName,parentEmail:h.parentEmail,medicalInfo:h.medicalInfo,assignedTherapistId:h.assignedTherapistId};await (0,n.r7)(e,t),d("Profile updated successfully"),h.assignedTherapistId&&h.assignedTherapistId!==l.assignedTherapistId&&c&&(0,ed.Wg)(h.assignedTherapistId,{clientId:l.id,clientName:h.name,triggeredByUserId:c.uid}).catch(e=>console.error("Failed to send assignment notification:",e)),r()}catch(e){console.error(e),o("Failed to update profile")}finally{u(!1)}};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-lg bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 text-primary-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(eg.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Edit Profile"}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:["Update information for ",null==l?void 0:l.name]})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800",children:(0,a.jsx)(_.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("form",{onSubmit:v,className:"flex-1 overflow-y-auto p-6 space-y-5",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Child Name"}),(0,a.jsx)("input",{type:"text",required:!0,placeholder:"e.g. John Doe",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.name,onChange:e=>b({...h,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Birth Date"}),(0,a.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.birthDate,onChange:e=>b({...h,birthDate:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Primary Diagnosis"}),(0,a.jsx)("input",{type:"text",placeholder:"e.g. Autism Spectrum Disorder",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.primaryDiagnosis,onChange:e=>b({...h,primaryDiagnosis:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Diagnosis Date"}),(0,a.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.diagnosisDate,onChange:e=>b({...h,diagnosisDate:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Support Level (DSM-5)"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.diagnosisLevel,onChange:e=>b({...h,diagnosisLevel:e.target.value}),children:[(0,a.jsx)("option",{value:"1",children:"Level 1 (Requiring Support)"}),(0,a.jsx)("option",{value:"2",children:"Level 2 (Substantial Support)"}),(0,a.jsx)("option",{value:"3",children:"Level 3 (Very Substantial Support)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Phone Number ",(0,a.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,a.jsx)("input",{type:"tel",placeholder:"e.g. 0721 234 567",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.phone,onChange:e=>b({...h,phone:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Parent Name ",(0,a.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,a.jsx)("input",{type:"text",placeholder:"e.g. Robert Doe",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.parentName,onChange:e=>b({...h,parentName:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Parent Email ",(0,a.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,a.jsx)("input",{type:"email",placeholder:"parent@example.com",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.parentEmail,onChange:e=>b({...h,parentEmail:e.target.value})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Assigned Therapist"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:h.assignedTherapistId,onChange:e=>b({...h,assignedTherapistId:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"Select a therapist..."}),x.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Medical Info / Notes"}),(0,a.jsx)("textarea",{rows:3,placeholder:"Allergies, specific diagnosis notes...",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 resize-none transition-colors",value:h.medicalInfo,onChange:e=>b({...h,medicalInfo:e.target.value})})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 font-bold transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"flex-1 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-all flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:m?(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}):"Save Changes"})]})]})]})]}):null}function e3(){let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),r=e.get("id"),d=e.get("tab"),o=e.get("action"),{data:c,loading:x,error:m}=function(e){let[t,r]=(0,s.useState)(null),[a,l]=(0,s.useState)(!0),[d,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(!e)return;l(!0);let t=(0,n.cf)((0,n.JU)(i.db,"clients",e),e=>{e.exists()?r({id:e.id,...e.data()}):o("Client not found"),l(!1)},e=>{console.error("Error fetching client:",e),o(e.message),l(!1)});return()=>t()},[e]),{data:t,loading:a,error:d}}(r||""),[u,h]=(0,s.useState)(d||"overview"),[p,g]=(0,s.useState)(!1),[b,j]=(0,s.useState)(o);return((0,s.useEffect)(()=>{d&&["overview","programs","plan","evaluations","docs"].includes(d)&&h(d)},[d]),(0,s.useEffect)(()=>{if(o){j(o);let e="/clients/profile?id=".concat(r).concat(d?"&tab=".concat(d):"");t.replace(e,{scroll:!1})}},[o,r,d,t]),r)?x?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)(P.Z,{className:"w-10 h-10 animate-spin text-primary-500"})}):m||!c?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[80vh] text-center p-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-error-50 dark:bg-error-900/20 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(ep.Z,{className:"w-8 h-8 text-error-500"})}),(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Client not found"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-2",children:"The client you are looking for doesn't exist or has been removed."}),(0,a.jsx)("a",{href:"/clients",className:"mt-6 px-6 py-2 bg-primary-600 text-white rounded-xl font-bold hover:bg-primary-700 transition-colors",children:"Back to Client List"})]}):(0,a.jsxs)("div",{className:"flex-1 p-6 space-y-8 max-w-7xl mx-auto w-full",children:[(0,a.jsx)(v,{client:c,activeTab:u,onTabChange:h,onEdit:()=>g(!0)}),(0,a.jsxs)("div",{className:"pt-2",children:["overview"===u&&(0,a.jsx)(B,{client:c,pendingAction:b,onActionHandled:()=>j(null)}),"programs"===u&&(0,a.jsx)(R,{client:c}),"plan"===u&&(0,a.jsx)(Y,{client:c,pendingAction:b,onActionHandled:()=>j(null)}),"docs"===u&&(0,a.jsx)(ex,{client:c}),"evaluations"===u&&(0,a.jsx)(e4,{client:c}),!["overview","programs","plan","docs","evaluations"].includes(u)&&(0,a.jsxs)("div",{className:"py-20 text-center bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white capitalize",children:[u," Section"]}),(0,a.jsx)("p",{className:"text-neutral-500 mt-1",children:"This section is currently under development."})]})]}),(0,a.jsx)(e1,{isOpen:p,onClose:()=>g(!1),client:c})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[80vh] text-center p-6",children:[(0,a.jsx)(ep.Z,{className:"w-12 h-12 text-error-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Invalid Request"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-2",children:"No client ID provided."})]})}function e6(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)(P.Z,{className:"w-10 h-10 animate-spin text-primary-500"})}),children:(0,a.jsx)(e3,{})})}}},function(e){e.O(0,[4358,139,2505,3125,5050,901,699,1486,2186,5674,8050,970,4639,2971,8069,1744],function(){return e(e.s=26427)}),_N_E=e.O()}]);