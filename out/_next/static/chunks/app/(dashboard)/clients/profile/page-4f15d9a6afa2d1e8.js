(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4582],{26427:function(e,t,r){Promise.resolve().then(r.bind(r,18186))},18186:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return e9}});var a=r(3827),s=r(64090),l=r(47907),n=r(73719),i=r(53879),d=r(96399),o=r(29295),c=r(18469),x=r(50489),m=r(8792),u=r(75504),h=r(21678),p=r(19685),g=r(1221),b=r(58121);let v=[{id:"overview",label:"Overview"},{id:"evaluations",label:"Evaluations"},{id:"programs",label:"Programs"},{id:"plan",label:"Plan"},{id:"docs",label:"Docs"}];function j(e){let{client:t,activeTab:r,onTabChange:n,onEdit:j}=e,{userRole:f}=(0,h.useAuth)(),{success:N,error:w}=(0,p.useToast)(),k=(0,l.useRouter)(),[y,C]=(0,s.useState)(!1),S=(0,s.useRef)(null),Z="Admin"===f,D=Z||"Coordinator"===f;(0,s.useEffect)(()=>{let e=e=>{S.current&&!S.current.contains(e.target)&&C(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let P=async()=>{try{let e=(0,b.JU)(g.db,"clients",t.id);await (0,b.r7)(e,{isArchived:!t.isArchived}),N(t.isArchived?"Client restored":"Client archived"),C(!1)}catch(e){console.error(e),w("Failed to update status")}},A=async()=>{if(confirm("Are you sure you want to PERMANENTLY delete ".concat(t.name,"? This cannot be undone.")))try{await (0,b.oe)((0,b.JU)(g.db,"clients",t.id)),N("Client deleted forever"),k.push("/clients/")}catch(e){console.error(e),w("Failed to delete client")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(m.default,{href:"/clients/",className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(i.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:t.name}),t.isArchived&&(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-warning-100 text-warning-700 dark:bg-warning-900/30 dark:text-warning-400 text-[10px] font-bold uppercase rounded-md flex items-center gap-1",children:[(0,a.jsx)(d.Z,{className:"w-3 h-3"}),"Archived"]})]})]}),D&&(0,a.jsxs)("div",{className:"flex items-center gap-2 relative",ref:S,children:[(0,a.jsxs)("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 border border-neutral-200 dark:border-neutral-800 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors text-sm font-medium",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),"Edit Profile"]}),(0,a.jsx)("button",{onClick:()=>C(!y),className:(0,u.W)("p-2 rounded-lg border border-neutral-200 dark:border-neutral-800 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",y&&"bg-neutral-100 dark:bg-neutral-800"),children:(0,a.jsx)(c.Z,{className:"w-5 h-5 text-neutral-500"})}),y&&(0,a.jsx)("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:(0,a.jsxs)("div",{className:"p-1",children:[(0,a.jsxs)("button",{onClick:P,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),t.isArchived?"Restore Client":"Archive Client"]}),Z&&(0,a.jsxs)("button",{onClick:A,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 rounded-lg transition-colors",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Delete Permanently"]})]})})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 border-b border-neutral-200 dark:border-neutral-800 overflow-x-auto scrollbar-hide",children:v.map(e=>(0,a.jsxs)("button",{onClick:()=>n(e.id),className:(0,u.W)("px-6 py-3 text-sm font-medium transition-all relative whitespace-nowrap",r===e.id?"text-primary-600 dark:text-primary-400":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[e.label,r===e.id&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"})]},e.id))})]})}var f=r(11213),N=r(85904),w=r(90684),k=r(89142),y=r(65),C=r(20933),S=r(18994),Z=r(30438),D=r(80037),P=r(23416),A=r(40834),W=r(97307),E=r(26490),I=r(26503),L=r(69475),T=r(92379),F=r(37805),M=r(2335),B=r(89006),O=r(53311),z=r(50171);function U(e){var t;let{client:n,pendingAction:i,onActionHandled:d}=e,o=(0,l.useRouter)(),{createOrGetThread:c}=(0,O.qi)(),{data:x}=(0,M.lU)(),{data:h,loading:v}=(0,M.we)(n.id),{evaluations:j,loading:U}=(0,B.F3)(n.id),{success:R,error:_}=(0,p.useToast)(),[V,G]=(0,s.useState)(!1),[H,J]=(0,s.useState)(!1),[q,K]=(0,s.useState)(!1),[Y,Q]=(0,s.useState)(!1),$=async()=>{if(!n.parentUids||0===n.parentUids.length){_("No parent has registered for the portal yet.");return}Q(!0);try{let e=n.parentUids[n.parentUids.length-1],t=await c({id:e,name:n.parentName||"Parent of ".concat(n.name),initials:"P",color:"#4A90E2",role:"Parent",phone:n.phone,clientId:n.id});t&&o.push("/messages?threadId=".concat(t))}catch(e){console.error(e),_("Failed to start conversation")}finally{Q(!1)}},X=(x||[]).find(e=>e.id===n.assignedTherapistId),ee=e=>new Date(e?e.seconds?1e3*e.seconds:e:0),et=(null==h?void 0:h.length)||0,er=(null==h?void 0:h.filter(e=>"completed"===e.status))||[],ea=er.filter(e=>"present"===e.attendance).length,es=er.length>0?Math.round(ea/er.length*100):0,el=(null===(t=n.programIds)||void 0===t?void 0:t.length)||0,en=new Date,ei=(h||[]).filter(e=>ee(e.startTime)>=en).sort((e,t)=>ee(e.startTime).getTime()-ee(t.startTime).getTime()).slice(0,3),ed=async()=>{G(!0);try{let e=n.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),t="".concat(e,"-").concat(Math.floor(1e3+9e3*Math.random()));await (0,b.r7)((0,b.JU)(g.db,"clients",n.id),{clientCode:t}),R("New access code generated!")}catch(e){console.error(e),_("Failed to generate code")}finally{G(!1)}},eo=async()=>{K(!0);try{let{default:e}=await Promise.all([r.e(2505),r.e(3125),r.e(7232)]).then(r.bind(r,92493)),{default:t}=await r.e(5264).then(r.bind(r,25264)),a=new e,s=a.internal.pageSize.getWidth();if(a.setFontSize(20),a.setFont("helvetica","bold"),a.text("Client Progress Report",s/2,20,{align:"center"}),a.setFontSize(12),a.setFont("helvetica","normal"),a.text("Client: ".concat(n.name),20,35),a.text("Generated: ".concat(new Date().toLocaleDateString()),20,42),X&&a.text("Therapist: ".concat(X.name),20,49),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Summary Statistics",20,65),a.setFontSize(11),a.setFont("helvetica","normal"),a.text("Total Sessions: ".concat(et),25,75),a.text("Completed Sessions: ".concat(er.length),25,82),a.text("Attendance Rate: ".concat(es,"%"),25,89),a.text("Active Programs: ".concat(el),25,96),h&&h.length>0){a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Session History",20,115);let e=h.sort((e,t)=>ee(t.startTime).getTime()-ee(e.startTime).getTime()).slice(0,20).map(e=>[ee(e.startTime).toLocaleDateString(),e.type||e.title||"Session",e.status||"N/A",e.attendance||"N/A"]);t(a,{startY:120,head:[["Date","Type","Status","Attendance"]],body:e,theme:"striped",headStyles:{fillColor:[74,144,226]},styles:{fontSize:9}})}a.save("".concat(n.name.replace(/\s+/g,"_"),"_Report_").concat(new Date().toISOString().split("T")[0],".pdf")),R("Report generated successfully!")}catch(e){console.error("Error generating report:",e),_("Failed to generate report")}finally{K(!1)}};return(0,s.useEffect)(()=>{"generate-report"!==i||v||(eo(),null==d||d())},[i,v,eo,d]),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-in fade-in duration-500",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Contact Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Parent / Guardian"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium",children:n.parentName||"Not provided"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Phone Number"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 text-neutral-400"}),n.phone?(0,a.jsx)("a",{href:"tel:".concat(n.phone),className:"font-medium hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:n.phone}):(0,a.jsx)("span",{className:"font-medium",children:"Not provided"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Email Address"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium",children:n.parentEmail||"Not provided"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wide font-semibold",children:"Birth Date"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700 dark:text-neutral-300",children:[(0,a.jsx)(k.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium",children:n.birthDate?new Date(n.birthDate).toLocaleDateString("ro-RO",{day:"2-digit",month:"long",year:"numeric"}):"Not provided"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)(y.Z,{className:"w-5 h-5 text-warning-500"}),"Medical Information & Notes"]}),(0,a.jsx)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl border border-neutral-100 dark:border-neutral-800",children:(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed italic",children:["“",n.medicalInfo||"No medical alerts or clinical notes provided for this client.","”"]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Assigned Therapy Team"}),X?(0,a.jsxs)(m.default,{href:"/team/",className:"flex items-center gap-4 p-3 border border-neutral-100 dark:border-neutral-800 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors w-fit pr-8 group",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:X.color},children:X.initials}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-neutral-900 dark:text-white group-hover:text-primary-600 transition-colors",children:X.name}),(0,a.jsx)("p",{className:"text-sm text-primary-600 dark:text-primary-400 font-medium",children:X.role})]})]}):(0,a.jsx)("p",{className:"text-sm text-neutral-500 italic",children:"No therapist assigned yet."})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm overflow-hidden relative",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:(0,a.jsx)(C.Z,{className:"w-20 h-24"})}),(0,a.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)(C.Z,{className:"w-5 h-5 text-primary-500"}),"Portal Access"]}),n.clientCode?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800 rounded-xl border border-neutral-100 dark:border-neutral-800 text-center",children:[(0,a.jsx)("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mb-1",children:"Current Access Code"}),(0,a.jsx)("p",{className:"text-2xl font-mono font-bold text-primary-600 tracking-wider uppercase",children:n.clientCode})]}),n.parentUids&&n.parentUids.length>0&&(0,a.jsxs)("button",{onClick:$,disabled:Y,className:"w-full flex items-center justify-center gap-2 py-2.5 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 rounded-xl text-sm font-bold hover:bg-primary-100 dark:hover:bg-primary-900/40 transition-all disabled:opacity-50",children:[Y?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(Z.Z,{className:"w-4 h-4"}),"Message Parent"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(!n.clientCode)return;let e=window.location.origin,t="".concat(e).concat("/parent","/?code=").concat(n.clientCode);navigator.clipboard.writeText(t),J(!0),R("Invite link copied to clipboard!"),setTimeout(()=>J(!1),2e3)},className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 rounded-xl text-sm font-bold hover:opacity-90 transition-all",children:[H?(0,a.jsx)(D.Z,{className:"w-4 h-4"}):(0,a.jsx)(P.Z,{className:"w-4 h-4"}),H?"Copied!":"Copy Invite Link"]}),(0,a.jsx)("button",{onClick:ed,disabled:V,className:"p-2.5 border border-neutral-200 dark:border-neutral-800 rounded-xl text-neutral-500 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all disabled:opacity-50",title:"Reset Code",children:(0,a.jsx)(A.Z,{className:(0,u.W)("w-5 h-5",V&&"animate-spin")})})]}),(0,a.jsx)("p",{className:"text-[10px] text-neutral-500 text-center leading-relaxed",children:"Parents can access the portal using this code or by clicking the unique invite link."})]}):(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"py-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-500 mb-4",children:"Portal access is not yet configured for this client."}),(0,a.jsxs)("button",{onClick:ed,disabled:V,className:"w-full flex items-center justify-center gap-2 py-3 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-all shadow-lg shadow-primary-500/20 disabled:opacity-70",children:[V?(0,a.jsx)(A.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(C.Z,{className:"w-5 h-5"}),"Generate Access Code"]})]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Quick Stats"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,a.jsx)(W.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Total Sessions"})]}),(0,a.jsx)("span",{className:"font-bold text-neutral-900 dark:text-white",children:v?(0,a.jsx)(S.Z,{className:"w-3 h-3 animate-spin"}):et})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Attendance Rate"})]}),(0,a.jsx)("span",{className:(0,u.W)("font-bold",es>=90?"text-success-600":es>=75?"text-warning-600":"text-error-600"),children:v?(0,a.jsx)(S.Z,{className:"w-3 h-3 animate-spin"}):"".concat(es,"%")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,a.jsx)(I.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Active Programs"})]}),(0,a.jsx)("span",{className:"font-bold text-primary-600",children:el})]})]}),(0,a.jsxs)("button",{onClick:eo,disabled:q||v,className:"w-full mt-4 flex items-center justify-center gap-2 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all disabled:opacity-50",children:[q?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(L.Z,{className:"w-4 h-4"}),q?"Generating...":"Generate Report"]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)(T.Z,{className:"w-5 h-5 text-primary-500"}),"Latest Evaluation"]}),U?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(S.Z,{className:"w-6 h-6 animate-spin text-neutral-300"})}):j.length>0?(()=>{let e=j.find(e=>"completed"===e.status)||j[0],t=j.find((e,t)=>t>0&&"completed"===e.status);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-2",children:(0,a.jsx)(z.Z,{evaluation:e,previousEvaluation:t,size:"sm",showLegend:!1})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:e.type}),(0,a.jsx)("p",{className:"text-xs text-neutral-400",children:new Date(e.completedAt||e.updatedAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,u.W)("text-2xl font-bold",e.overallPercentage>=70?"text-success-600":e.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[e.overallPercentage,"%"]}),(0,a.jsx)("p",{className:"text-xs text-neutral-400",children:"completed"===e.status?"Completed":"In Progress"})]})]}),(0,a.jsxs)(m.default,{href:"/clients/profile?id=".concat(n.id,"&tab=evaluations"),className:"w-full flex items-center justify-center gap-2 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all",children:["View All Evaluations",(0,a.jsx)(F.Z,{className:"w-4 h-4"})]})]})})():(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-500 mb-4",children:"No evaluations yet"}),(0,a.jsxs)(m.default,{href:"/clients/profile?id=".concat(n.id,"&tab=evaluations"),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-xl text-sm font-bold transition-colors",children:[(0,a.jsx)(T.Z,{className:"w-4 h-4"}),"Start Evaluation"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white mb-4",children:"Upcoming Schedule"}),v?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(S.Z,{className:"w-6 h-6 animate-spin text-neutral-300"})}):ei.length>0?(0,a.jsxs)("div",{className:"space-y-3",children:[ei.map(e=>{let t=ee(e.startTime),r=t.toDateString()===new Date().toDateString();return(0,a.jsxs)("div",{className:"p-3 bg-primary-50 dark:bg-primary-900/20 rounded-xl border border-primary-100 dark:border-primary-900/50",children:[(0,a.jsx)("p",{className:"text-xs font-bold text-primary-600 dark:text-primary-400 uppercase",children:r?"Today":t.toLocaleDateString("en-US",{weekday:"long"})}),(0,a.jsx)("p",{className:"text-sm font-bold text-neutral-900 dark:text-white mt-1",children:e.type}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",e.duration," min"]})]},e.id)}),(0,a.jsx)("button",{className:"w-full py-2 text-sm font-bold text-primary-600 dark:text-primary-400 hover:underline",children:"View full calendar"})]}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-sm text-neutral-500 italic",children:"No upcoming sessions found."})})]})]})]})}var R=r(70094),_=r(14562);function V(e){let{client:t}=e,{data:r,loading:s}=(0,M.b$)(),l=(r||[]).filter(e=>{var r;return null===(r=t.programIds)||void 0===r?void 0:r.includes(e.id)});return s?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,a.jsx)(S.Z,{className:"w-10 h-10 animate-spin mb-4"}),(0,a.jsx)("p",{children:"Loading programs..."})]}):(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Assigned Programs"}),(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-xl text-sm font-bold transition-colors",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),"Assign Program"]})]}),l.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm hover:border-primary-500/50 transition-all group",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-50 dark:bg-primary-900/20 rounded-xl flex items-center justify-center text-primary-600 group-hover:bg-primary-100 dark:group-hover:bg-primary-900/40 transition-colors",children:(0,a.jsx)(_.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-1 line-clamp-2",children:e.description||"No description provided for this program."}),(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs font-medium px-2 py-1 bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 rounded-lg",children:"Status: Active"}),(0,a.jsx)("button",{className:"text-sm font-bold text-primary-600 hover:underline",children:"View Details"})]})]})]})},e.id))}):(0,a.jsxs)("div",{className:"py-20 text-center bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(_.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"No programs assigned"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-1 max-w-sm mx-auto",children:"This client doesn't have any therapy programs assigned yet. Click the button above to start assigning programs."})]})]})}var G=r(56227),H=r(64178),J=r(85159),q=r(23441),K=r(46578),Y=r(52235),Q=r(28670);function $(e){let{isOpen:t,onClose:r,clientId:l,existingPlan:n}=e,{success:i,error:d}=(0,p.useToast)(),{data:o,loading:c}=(0,M.b$)(),[m,h]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[f,N]=(0,s.useState)(""),[w,k]=(0,s.useState)({name:"",startDate:"",endDate:"",programIds:[],status:"active"});(0,s.useEffect)(()=>{if(n)k({name:n.name,startDate:n.startDate,endDate:n.endDate,programIds:n.programIds,status:n.status});else{let e=new Date,t=new Date;t.setMonth(t.getMonth()+3),k({name:"",startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0],programIds:[],status:"active"})}N("")},[n,t]);let y=(o||[]).filter(e=>e.title.toLowerCase().includes(f.toLowerCase())||(e.description||"").toLowerCase().includes(f.toLowerCase())),C=e=>{k(t=>({...t,programIds:t.programIds.includes(e)?t.programIds.filter(t=>t!==e):[...t.programIds,e]}))},Z=()=>w.name.trim()?w.startDate?w.endDate?new Date(w.endDate)<=new Date(w.startDate)?"End date must be after start date":0===w.programIds.length?"Select at least one program":null:"End date is required":"Start date is required":"Plan name is required",P=async e=>{e.preventDefault();let t=Z();if(t){d(t);return}h(!0);try{let e={name:w.name.trim(),startDate:w.startDate,endDate:w.endDate,programIds:w.programIds,status:w.status,...n?{}:{createdAt:new Date().toISOString()}};if(n){let t=(0,b.JU)(g.db,"clients",l,"interventionPlans",n.id);await (0,b.r7)(t,e),i("Plan updated successfully")}else await (0,b.ET)((0,b.hJ)(g.db,"clients",l,"interventionPlans"),e),i("Plan created successfully");r()}catch(e){console.error(e),d(n?"Failed to update plan":"Failed to create plan")}finally{h(!1)}},A=async()=>{if(n&&confirm('Delete "'.concat(n.name,'"? This action cannot be undone.'))){j(!0);try{await (0,b.oe)((0,b.JU)(g.db,"clients",l,"interventionPlans",n.id)),i("Plan deleted"),r()}catch(e){console.error(e),d("Failed to delete plan")}finally{j(!1)}}};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-lg bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 text-primary-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(G.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:n?"Edit Intervention Plan":"Create Intervention Plan"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:n?"Modify plan details":"Set up programs for this client"})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("form",{onSubmit:P,className:"flex-1 overflow-y-auto p-6 space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Plan Name ",(0,a.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",required:!0,placeholder:"e.g. Q1 2026 Intervention",className:"w-full px-3 py-2.5 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500",value:w.name,onChange:e=>k({...w,name:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Start Date ",(0,a.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,a.jsx)("input",{type:"date",required:!0,className:"w-full px-3 py-2.5 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500",value:w.startDate,onChange:e=>k({...w,startDate:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["End Date ",(0,a.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,a.jsx)("input",{type:"date",required:!0,className:"w-full px-3 py-2.5 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500",value:w.endDate,onChange:e=>k({...w,endDate:e.target.value})})]})]}),n&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Status"}),(0,a.jsx)("div",{className:"flex gap-2",children:["active","draft","completed"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>k({...w,status:e}),className:(0,u.W)("flex-1 py-2 rounded-lg text-sm font-medium transition-all border capitalize",w.status===e?"active"===e?"bg-success-500 border-success-600 text-white":"draft"===e?"bg-warning-500 border-warning-600 text-white":"bg-neutral-500 border-neutral-600 text-white":"bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700 text-neutral-600 dark:text-neutral-400"),children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Select Programs ",(0,a.jsx)("span",{className:"text-error-500",children:"*"}),(0,a.jsxs)("span",{className:"ml-2 text-xs text-neutral-500 font-normal",children:["(",w.programIds.length," selected)"]})]}),(0,a.jsxs)("div",{className:"relative mb-3",children:[(0,a.jsx)(Q.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search programs...",className:"w-full pl-9 pr-4 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 text-sm",value:f,onChange:e=>N(e.target.value)})]}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-1.5 pr-1",children:c?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(S.Z,{className:"w-6 h-6 animate-spin text-primary-500"})}):0===y.length?(0,a.jsx)("p",{className:"text-center py-4 text-sm text-neutral-500",children:"No programs found"}):y.map(e=>{let t=w.programIds.includes(e.id);return(0,a.jsxs)("div",{onClick:()=>C(e.id),className:(0,u.W)("flex items-center gap-3 p-2.5 rounded-lg border cursor-pointer transition-all",t?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-neutral-200 dark:border-neutral-700 hover:border-primary-300"),children:[(0,a.jsx)("div",{className:(0,u.W)("w-5 h-5 rounded border flex items-center justify-center flex-shrink-0",t?"bg-primary-500 border-primary-500 text-white":"border-neutral-300 dark:border-neutral-600"),children:t&&(0,a.jsx)(D.Z,{className:"w-3 h-3"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white truncate flex items-center gap-1.5",children:[(0,a.jsx)(_.Z,{className:"w-3 h-3 text-neutral-400 flex-shrink-0"}),e.title]}),e.description&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 truncate",children:e.description})]})]},e.id)})})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[n&&(0,a.jsx)("button",{type:"button",onClick:A,disabled:v,className:"p-2.5 border border-error-200 dark:border-error-800 text-error-600 rounded-xl hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors disabled:opacity-50",children:v?(0,a.jsx)(S.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(x.Z,{className:"w-5 h-5"})}),(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 font-bold transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"flex-1 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-all flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:m?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):n?"Save Changes":"Create Plan"})]})]})]})]}):null}function X(e){let{client:t,pendingAction:r,onActionHandled:l}=e,{data:n,loading:i,activePlan:d}=(0,M.Rn)(t.id),{data:c}=(0,M.b$)(),{success:x,error:m}=(0,p.useToast)(),[h,v]=(0,s.useState)(!1),[j,f]=(0,s.useState)(null),[N,w]=(0,s.useState)(!1);(0,s.useEffect)(()=>{"create-plan"!==r||i||(v(!0),null==l||l())},[r,i,l]);let k=n.filter(e=>"completed"===e.status),y=n.filter(e=>"draft"===e.status),C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Z=e=>{let t=new Date(e),r=new Date;return Math.ceil((t.getTime()-r.getTime())/864e5)},D=async e=>{if(confirm('End "'.concat(e.name,'"? This will mark the plan as completed.')))try{let r=(0,b.JU)(g.db,"clients",t.id,"interventionPlans",e.id);await (0,b.r7)(r,{status:"completed"}),x("Plan marked as completed")}catch(e){console.error(e),m("Failed to update plan")}},P=async e=>{if(d&&d.id!==e.id){if(!confirm("There's already an active plan. Activating this will end \"".concat(d.name,'". Continue?')))return;let e=(0,b.JU)(g.db,"clients",t.id,"interventionPlans",d.id);await (0,b.r7)(e,{status:"completed"})}try{let r=(0,b.JU)(g.db,"clients",t.id,"interventionPlans",e.id);await (0,b.r7)(r,{status:"active"}),x("Plan activated")}catch(e){console.error(e),m("Failed to activate plan")}};return i?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[d?(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:(0,a.jsx)(G.Z,{className:"w-6 h-6 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:d.name}),(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400 text-xs font-bold rounded-full flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 bg-success-500 rounded-full animate-pulse"}),"Active"]})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5",children:"Intervention Plan"})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("button",{onClick:()=>f(d),className:"p-2 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(o.Z,{className:"w-4 h-4 text-neutral-500"})})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 mb-6 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(W.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:[C(d.startDate)," → ",C(d.endDate)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:(0,u.W)("text-sm font-medium",7>=Z(d.endDate)?"text-warning-600":"text-neutral-600 dark:text-neutral-400"),children:Z(d.endDate)>0?"".concat(Z(d.endDate)," days remaining"):"Plan ended"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-xs font-semibold text-neutral-500 uppercase tracking-wider mb-3",children:["Programs (",d.programIds.length,")"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:d.programIds.map(e=>{var t;return(null===(t=c.find(t=>t.id===e))||void 0===t?void 0:t.title)||e}).filter(Boolean).map((e,t)=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300 text-sm font-medium rounded-lg",children:[(0,a.jsx)(_.Z,{className:"w-3.5 h-3.5"}),e]},t))})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-100 dark:border-neutral-800",children:[(0,a.jsx)("button",{onClick:()=>f(d),className:"flex-1 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 font-medium transition-colors text-sm",children:"Edit Plan"}),(0,a.jsx)("button",{onClick:()=>D(d),className:"flex-1 py-2.5 bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 rounded-xl font-medium transition-colors text-sm hover:bg-neutral-800 dark:hover:bg-neutral-100",children:"End Plan"})]})]})}):(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 p-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(H.Z,{className:"w-8 h-8 text-neutral-400"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No Active Intervention Plan"}),(0,a.jsx)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-6",children:"Create a plan to automatically assign programs to this client's therapy sessions."}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"inline-flex items-center gap-2 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-primary-500/20",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),"Create Intervention Plan"]})]}),y.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider",children:["Draft Plans (",y.length,")"]}),y.map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-xl border border-neutral-200 dark:border-neutral-800 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-neutral-100 dark:bg-neutral-800 rounded-lg flex items-center justify-center",children:(0,a.jsx)(H.Z,{className:"w-5 h-5 text-neutral-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[C(e.startDate)," → ",C(e.endDate)," \xb7 ",e.programIds.length," programs"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>f(e),className:"px-3 py-1.5 text-xs font-medium text-neutral-600 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>P(e),className:"px-3 py-1.5 text-xs font-medium bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Activate"})]})]})},e.id))]}),d&&(0,a.jsxs)("button",{onClick:()=>v(!0),className:"w-full py-3 border-2 border-dashed border-neutral-200 dark:border-neutral-700 rounded-xl text-neutral-500 hover:border-primary-300 hover:text-primary-600 transition-colors font-medium flex items-center justify-center gap-2",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),"Create New Plan"]}),k.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>w(!N),className:"flex items-center gap-2 text-sm font-semibold text-neutral-500 uppercase tracking-wider hover:text-neutral-700 transition-colors",children:[(0,a.jsxs)("span",{children:["Plan History (",k.length,")"]}),N?(0,a.jsx)(J.Z,{className:"w-4 h-4"}):(0,a.jsx)(q.Z,{className:"w-4 h-4"})]}),N&&(0,a.jsx)("div",{className:"space-y-2 animate-in slide-in-from-top-2 duration-200",children:k.map(e=>(0,a.jsx)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-4 border border-neutral-100 dark:border-neutral-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-neutral-200 dark:bg-neutral-700 rounded-lg flex items-center justify-center",children:(0,a.jsx)(K.Z,{className:"w-4 h-4 text-neutral-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[C(e.startDate)," → ",C(e.endDate)," \xb7 ",e.programIds.length," programs"]})]})]}),(0,a.jsx)("span",{className:"text-xs text-neutral-400 font-medium",children:"Completed"})]})},e.id))})]}),(0,a.jsx)($,{isOpen:h||!!j,onClose:()=>{v(!1),f(null)},clientId:t.id,existingPlan:j})]})}var ee=r(65561),et=r(80031),er=r(77329),ea=r(3428),es=r(10632),el=r(61172),en=r(37841),ei=r(44715),ed=r(51930),eo=r(24905);function ec(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}var ex=r(12228);let em=[{id:"assessment",label:"Assessment",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},{id:"report",label:"Report",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},{id:"consent",label:"Consent Form",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"},{id:"other",label:"Other",color:"bg-neutral-100 text-neutral-700 dark:bg-neutral-800 dark:text-neutral-400"}];function eu(e){return e.includes("pdf")?(0,a.jsx)(L.Z,{className:"w-5 h-5"}):e.includes("image")?(0,a.jsx)(ee.Z,{className:"w-5 h-5"}):e.includes("sheet")||e.includes("excel")?(0,a.jsx)(et.Z,{className:"w-5 h-5"}):e.includes("presentation")||e.includes("powerpoint")?(0,a.jsx)(er.Z,{className:"w-5 h-5"}):(0,a.jsx)(ea.Z,{className:"w-5 h-5"})}function eh(e){var t;let{client:r}=e,{user:l,userData:n}=(0,h.useAuth)(),{success:i,error:d}=(0,p.useToast)(),{documents:o,loading:m,uploadDocument:v,deleteDocument:j,toggleParentAccess:f}=function(e){let[t,r]=(0,s.useState)([]),[a,l]=(0,s.useState)(!0),[n,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(!e){l(!1);return}let t=(0,b.IO)((0,b.hJ)(g.db,"clients",e,"documents"),(0,b.Xo)("uploadedAt","desc")),a=(0,b.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),r(t),l(!1)},e=>{console.error("Error fetching documents:",e),i(e.message),l(!1)});return()=>a()},[e]),{documents:t,loading:a,error:n,uploadDocument:async(t,r,a)=>{if(!e)return null;try{let s=Date.now(),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),n="clients/".concat(e,"/documents/").concat(s,"_").concat(l),i=(0,eo.iH)(g.tO,n);return new Promise((s,l)=>{let d=(0,eo.B0)(i,t);d.on("state_changed",e=>{let t=e.bytesTransferred/e.totalBytes*100;null==a||a(t)},e=>{console.error("Upload error:",e),l(e)},async()=>{let a=await (0,eo.Jt)(d.snapshot.ref),l={name:r.name,fileName:t.name,fileType:t.type,fileSize:t.size,storagePath:n,downloadUrl:a,uploadedBy:r.uploadedBy,uploadedByName:r.uploadedByName,uploadedAt:(0,b.Bt)(),category:r.category,description:r.description||"",sharedWithParent:r.sharedWithParent},i=await (0,b.ET)((0,b.hJ)(g.db,"clients",e,"documents"),l);s({id:i.id,...l})})})}catch(e){throw console.error("Error uploading document:",e),e}},deleteDocument:async t=>{if(e)try{let r=(0,eo.iH)(g.tO,t.storagePath);await (0,eo.oq)(r),await (0,b.oe)((0,b.JU)(g.db,"clients",e,"documents",t.id))}catch(e){throw console.error("Error deleting document:",e),e}},toggleParentAccess:async(t,r)=>{if(e)try{await (0,b.r7)((0,b.JU)(g.db,"clients",e,"documents",t),{sharedWithParent:r})}catch(e){throw console.error("Error updating document access:",e),e}}}}(r.id),[N,w]=(0,s.useState)(!1),[k,y]=(0,s.useState)(0),[C,Z]=(0,s.useState)(!1),[D,P]=(0,s.useState)(null),[A,W]=(0,s.useState)(""),[E,I]=(0,s.useState)("other"),[L,T]=(0,s.useState)(""),[F,M]=(0,s.useState)(!0),[B,O]=(0,s.useState)(null),[z,U]=(0,s.useState)("all"),_=(0,s.useRef)(null),V=async()=>{if(D&&A.trim()){Z(!0),y(0);try{let t=await v(D,{name:A.trim(),category:E,description:L.trim(),sharedWithParent:F,uploadedBy:(null==l?void 0:l.uid)||"",uploadedByName:(null==n?void 0:n.name)||(null==l?void 0:l.email)||"Unknown"},e=>y(e));if(F&&t){var e;let a=(null===(e=em.find(e=>e.id===E))||void 0===e?void 0:e.label)||"Document";try{await (0,ex.co)(r.id,{documentId:t.id,documentName:A.trim(),documentCategory:a,sharedByName:(null==n?void 0:n.name)||(null==l?void 0:l.email)||"Your therapy team",triggeredByUserId:(null==l?void 0:l.uid)||""})}catch(e){console.error("Failed to send notification:",e)}}i("Document uploaded successfully"),J(),w(!1)}catch(e){d("Failed to upload document")}finally{Z(!1)}}},G=async e=>{if(confirm('Are you sure you want to delete "'.concat(e.name,'"? This cannot be undone.')))try{await j(e),i("Document deleted"),O(null)}catch(e){d("Failed to delete document")}},H=async e=>{let t=!e.sharedWithParent;try{if(await f(e.id,t),t){var a;let t=(null===(a=em.find(t=>t.id===e.category))||void 0===a?void 0:a.label)||"Document";try{await (0,ex.co)(r.id,{documentId:e.id,documentName:e.name,documentCategory:t,sharedByName:(null==n?void 0:n.name)||(null==l?void 0:l.email)||"Your therapy team",triggeredByUserId:(null==l?void 0:l.uid)||""})}catch(e){console.error("Failed to send notification:",e)}}i(e.sharedWithParent?"Document hidden from parent":"Document shared with parent"),O(null)}catch(e){d("Failed to update document access")}},J=()=>{P(null),W(""),I("other"),T(""),M(!0),y(0),_.current&&(_.current.value="")},q="all"===z?o:o.filter(e=>e.category===z);return m?(0,a.jsxs)("div",{className:"py-20 flex flex-col items-center justify-center",children:[(0,a.jsx)(S.Z,{className:"w-8 h-8 animate-spin text-primary-500 mb-4"}),(0,a.jsx)("p",{className:"text-neutral-500",children:"Loading documents..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Documents"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[o.length," document",1!==o.length?"s":""," • ",o.filter(e=>e.sharedWithParent).length," shared with parent"]})]}),(0,a.jsxs)("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors",children:[(0,a.jsx)(es.Z,{className:"w-4 h-4"}),"Upload Document"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>U("all"),className:(0,u.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors","all"===z?"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-400":"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:"All"}),em.map(e=>(0,a.jsx)("button",{onClick:()=>U(e.id),className:(0,u.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",z===e.id?e.color:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:e.label},e.id))]}),0===q.length?(0,a.jsxs)("div",{className:"py-16 text-center bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(el.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"No documents"}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm mt-1 mb-6",children:"all"===z?"Upload documents for this client to get started.":"No ".concat(null===(t=em.find(e=>e.id===z))||void 0===t?void 0:t.label.toLowerCase()," documents found.")}),"all"===z&&(0,a.jsxs)("button",{onClick:()=>w(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),"Upload First Document"]})]}):(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:(0,a.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:q.map(e=>{var t,r;let s=em.find(t=>t.id===e.category);return(0,a.jsx)("div",{className:"p-4 hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-neutral-100 dark:bg-neutral-800 rounded-lg flex items-center justify-center text-neutral-500 flex-shrink-0",children:eu(e.fileType)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-medium text-neutral-900 dark:text-white truncate",children:e.name}),(0,a.jsx)("span",{className:(0,u.W)("px-2 py-0.5 text-xs font-medium rounded-full",null==s?void 0:s.color),children:null==s?void 0:s.label}),e.sharedWithParent&&(0,a.jsxs)("span",{className:"flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:[(0,a.jsx)(en.Z,{className:"w-3 h-3"}),"Parent"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-neutral-500",children:[(0,a.jsx)("span",{children:ec(e.fileSize)}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e.uploadedByName}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:(null===(r=e.uploadedAt)||void 0===r?void 0:null===(t=r.toDate)||void 0===t?void 0:t.call(r))?new Date(e.uploadedAt.toDate()).toLocaleDateString():"Just now"})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-1 truncate",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,a.jsx)("a",{href:e.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",title:"Download",children:(0,a.jsx)(ei.Z,{className:"w-4 h-4 text-neutral-500"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>O(B===e.id?null:e.id),className:(0,u.W)("p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",B===e.id&&"bg-neutral-100 dark:bg-neutral-800"),children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-neutral-500"})}),B===e.id&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>O(null)}),(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl shadow-xl z-20 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:(0,a.jsxs)("div",{className:"p-1",children:[(0,a.jsx)("button",{onClick:()=>H(e),className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:e.sharedWithParent?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4"}),"Hide from Parent"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(en.Z,{className:"w-4 h-4"}),"Share with Parent"]})}),(0,a.jsxs)("button",{onClick:()=>G(e),className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 rounded-lg transition-colors",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Delete"]})]})})]})]})]})]})},e.id)})})}),N&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>!C&&w(!1)}),(0,a.jsxs)("div",{className:"relative w-full max-w-md bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl animate-in fade-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Upload Document"}),(0,a.jsx)("button",{onClick:()=>!C&&w(!1),disabled:C,className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors disabled:opacity-50",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"File"}),(0,a.jsx)("input",{ref:_,type:"file",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(r.size>10485760){d("File size must be less than 10MB");return}P(r),W(r.name.replace(/\.[^/.]+$/,""))}},disabled:C,className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.png,.jpg,.jpeg,.gif"}),D?(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-xl",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-lg flex items-center justify-center text-primary-600",children:eu(D.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:D.name}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:ec(D.size)})]}),(0,a.jsx)("button",{onClick:()=>{P(null),_.current&&(_.current.value="")},disabled:C,className:"p-1 rounded hover:bg-neutral-200 dark:hover:bg-neutral-700",children:(0,a.jsx)(Y.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},disabled:C,className:"w-full p-6 border-2 border-dashed border-neutral-300 dark:border-neutral-700 rounded-xl hover:border-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/10 transition-colors",children:[(0,a.jsx)(es.Z,{className:"w-8 h-8 text-neutral-400 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-600 dark:text-neutral-400",children:"Click to select a file"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"PDF, Word, Excel, PowerPoint, Images (max 10MB)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Document Name"}),(0,a.jsx)("input",{type:"text",value:A,onChange:e=>W(e.target.value),disabled:C,placeholder:"e.g., Initial Assessment Report",className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Category"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:em.map(e=>(0,a.jsx)("button",{onClick:()=>I(e.id),disabled:C,className:(0,u.W)("px-3 py-2 text-sm font-medium rounded-lg transition-colors",E===e.id?e.color:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:e.label},e.id))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description (optional)"}),(0,a.jsx)("textarea",{value:L,onChange:e=>T(e.target.value),disabled:C,placeholder:"Brief description of the document...",rows:2,className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-xl resize-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-50"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-xl cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:F,onChange:e=>M(e.target.checked),disabled:C,className:"w-5 h-5 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"Share with parent"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Parent can view and download this document"})]})]}),C&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Uploading..."}),(0,a.jsxs)("span",{className:"font-medium",children:[Math.round(k),"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:"".concat(k,"%")}})})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 p-4 border-t border-neutral-200 dark:border-neutral-800",children:[(0,a.jsx)("button",{onClick:()=>{J(),w(!1)},disabled:C,className:"flex-1 px-4 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl font-medium hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:V,disabled:!D||!A.trim()||C,className:"flex-1 px-4 py-2.5 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.Z,{className:"w-4 h-4"}),"Upload"]})})]})]})]})]})}var ep=r(29733);function eg(e){let{clientId:t,clientName:r,onStartNew:l,onContinue:n,onView:i,onReEvaluate:d}=e,{evaluations:o,loading:m,error:h}=(0,B.F3)(t),{deleteEvaluation:g,saving:b}=(0,B.bm)(),{success:v,error:j}=(0,p.useToast)(),[f,N]=(0,s.useState)(null),[w,k]=(0,s.useState)(null),y=async e=>{if(confirm("Are you sure you want to delete this evaluation? This cannot be undone.")){k(e);try{await g(t,e),v("Evaluation deleted")}catch(e){console.error("Failed to delete evaluation:",e),j("Failed to delete evaluation")}finally{k(null),N(null)}}},C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Z=o.filter(e=>"in_progress"===e.status),D=o.filter(e=>"completed"===e.status);return m?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):h?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-error-500",children:h})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("button",{onClick:l,className:"w-full py-4 border-2 border-dashed border-primary-300 dark:border-primary-700 rounded-2xl text-primary-600 dark:text-primary-400 hover:border-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-all font-medium flex items-center justify-center gap-2",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5"}),"Start New ABLLS Evaluation"]}),Z.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),"In Progress (",Z.length,")"]}),Z.map(e=>(0,a.jsxs)("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-warning-100 dark:bg-warning-900/30 flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-6 h-6 text-warning-600 dark:text-warning-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-neutral-900 dark:text-white",children:[e.type," Evaluation"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Started ",C(e.createdAt)," \xb7 ",e.overallPercentage,"% scored"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>n(e.id),className:"px-4 py-2 bg-warning-600 hover:bg-warning-700 text-white rounded-lg font-medium text-sm transition-colors flex items-center gap-2",children:["Continue",(0,a.jsx)(F.Z,{className:"w-4 h-4"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-warning-100 dark:hover:bg-warning-900/30 transition-colors",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:w===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[w===e.id?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]}),(0,a.jsx)("div",{className:"mt-3 h-1.5 bg-warning-200 dark:bg-warning-900/50 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-warning-500 transition-all",style:{width:"".concat(e.overallPercentage,"%")}})})]},e.id))]}),D.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(K.Z,{className:"w-4 h-4"}),"Completed (",D.length,")"]}),D.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-4 hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-success-100 dark:bg-success-900/30 flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-6 h-6 text-success-600 dark:text-success-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-neutral-900 dark:text-white",children:[e.type," Evaluation"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Completed ",C(e.completedAt||e.updatedAt)]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,u.W)("text-2xl font-bold",e.overallPercentage>=70?"text-success-600":e.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[e.overallPercentage,"%"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400",children:[e.overallScore,"/",e.overallMaxScore]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>i(e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",title:"View details",children:(0,a.jsx)(en.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,a.jsx)("button",{onClick:()=>d(e),className:"p-2 rounded-lg hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors",title:"Start re-evaluation",children:(0,a.jsx)(A.Z,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:w===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[w===e.id?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-24 h-24 flex-shrink-0",children:(0,a.jsx)(z.E,{evaluation:e})}),(0,a.jsx)("div",{className:"flex-1 grid grid-cols-9 gap-1",children:Object.entries(e.categorySummaries||{}).sort((e,t)=>{let[r]=e,[a]=t;return r.localeCompare(a)}).slice(0,9).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"h-8 rounded bg-neutral-100 dark:bg-neutral-800 overflow-hidden",title:"".concat(r.categoryName,": ").concat(r.percentage,"%"),children:(0,a.jsx)("div",{className:(0,u.W)("h-full transition-all",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{height:"".concat(r.percentage,"%")}})}),(0,a.jsx)("span",{className:"text-[10px] text-neutral-400 mt-1",children:t})]},t)})})]})]},e.id))]}),0===o.length&&(0,a.jsxs)("div",{className:"text-center py-12 bg-neutral-50 dark:bg-neutral-800/50 rounded-2xl",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-8 h-8 text-neutral-400"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No Evaluations Yet"}),(0,a.jsxs)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-6",children:["Start an ABLLS evaluation to assess ",r,"'s skills and track progress over time."]}),(0,a.jsxs)("button",{onClick:l,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-primary-500/20",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),"Start First Evaluation"]})]})]})}var eb=r(49108),ev=r(98998),ej=r(70699),ef=r(15282);function eN(e){let{category:t,scores:r,previousScores:l,onScoreChange:n,readOnly:i=!1}=e,[d,o]=(0,s.useState)(null),[c,x]=(0,s.useState)(""),m=e=>{var t;i||(x((null===(t=r[e])||void 0===t?void 0:t.note)||""),o(d===e?null:e))},h=e=>{var t,a,s,l;let i=null!==(s=null===(t=r[e])||void 0===t?void 0:t.score)&&void 0!==s?s:0,d=null!==(l=null===(a=r[e])||void 0===a?void 0:a.isNA)&&void 0!==l&&l;n(e,i,c||void 0,d),o(null)},p=e=>{if(!l||!l[e]||!r[e])return null;let t=l[e].score,a=r[e].score;return a>t?"improved":a<t?"regressed":"same"};return(0,a.jsx)("div",{className:"space-y-3",children:t.items.map(e=>{var t;let s=r[e.id],g=null==s?void 0:s.score,b=null==s?void 0:s.isNA,v=!!(null==s?void 0:s.note),j=null==l?void 0:null===(t=l[e.id])||void 0===t?void 0:t.score,f=p(e.id);return(0,a.jsx)("div",{className:(0,u.W)("p-4 rounded-xl border transition-all",b?"bg-neutral-100 dark:bg-neutral-800/20 border-dashed border-neutral-300 opacity-75":void 0!==g?"bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-100 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-bold text-primary-600 dark:text-primary-400",children:e.id})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white mb-3",children:e.text}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,0,null==s?void 0:s.note,!b),disabled:i,title:"Not Applicable",className:(0,u.W)("px-3 h-10 rounded-lg font-bold text-xs transition-all",b?"bg-neutral-500 text-white shadow-lg":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200"),children:"N/A"}),[0,1,2].map(t=>{let r=g===t&&!b,l=ef.t3[t];return(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,t,null==s?void 0:s.note,!1),disabled:i,title:l.description,className:(0,u.W)("w-10 h-10 rounded-lg font-bold text-sm transition-all",i&&"cursor-default",r?"error"===l.color?"bg-error-500 text-white shadow-lg shadow-error-500/30":"warning"===l.color?"bg-warning-500 text-white shadow-lg shadow-warning-500/30":"bg-success-500 text-white shadow-lg shadow-success-500/30":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:t},t)}),!i&&(0,a.jsx)("button",{onClick:()=>m(e.id),className:(0,u.W)("p-2 rounded-lg transition-colors ml-2",v?"bg-primary-100 dark:bg-primary-900/30 text-primary-600":"bg-neutral-100 dark:bg-neutral-800 text-neutral-400 hover:text-neutral-600"),title:v?"Edit note":"Add note",children:(0,a.jsx)(Z.Z,{className:"w-5 h-5"})}),void 0!==j&&(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-neutral-400",children:"Previous:"}),(0,a.jsx)("span",{className:(0,u.W)("text-xs font-medium px-2 py-0.5 rounded",0===j&&"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400",1===j&&"bg-warning-100 text-warning-700 dark:bg-warning-900/30 dark:text-warning-400",2===j&&"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400"),children:j}),f&&"same"!==f&&(0,a.jsx)("span",{className:(0,u.W)("text-xs font-medium","improved"===f&&"text-success-600","regressed"===f&&"text-error-600"),children:"improved"===f?"↑":"↓"})]}),i&&v&&(0,a.jsx)("div",{className:"ml-auto",children:(0,a.jsx)(Z.Z,{className:"w-4 h-4 text-primary-500"})})]}),d===e.id&&(0,a.jsxs)("div",{className:"mt-3 animate-in slide-in-from-top-2 duration-200",children:[(0,a.jsx)("textarea",{value:c,onChange:e=>x(e.target.value),placeholder:"Add a note about this score...",className:"w-full px-3 py-2 text-sm bg-neutral-100 dark:bg-neutral-800 border-none rounded-lg focus:ring-2 focus:ring-primary-500 resize-none",rows:2,autoFocus:!0}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,a.jsx)("button",{onClick:()=>o(null),className:"px-3 py-1.5 text-xs font-medium text-neutral-600 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{onClick:()=>h(e.id),className:"px-3 py-1.5 text-xs font-medium bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-1",children:[(0,a.jsx)(D.Z,{className:"w-3 h-3"}),"Save Note"]})]})]}),v&&d!==e.id&&(0,a.jsx)("div",{className:"mt-2 p-2 bg-primary-50 dark:bg-primary-900/20 rounded-lg",children:(0,a.jsx)("p",{className:"text-xs text-primary-700 dark:text-primary-300 italic",children:r[e.id].note})})]})]})},e.id)})})}function ew(e){let{isOpen:t,onClose:r,clientId:l,clientName:n,evaluationId:i,previousEvaluation:d}=e,{user:o,userData:c}=(0,h.useAuth)(),{success:x,error:m}=(0,p.useToast)(),{saving:g,createEvaluation:b,saveEvaluationProgress:v,completeEvaluation:j}=(0,B.bm)(),[f,N]=(0,s.useState)(0),[w,k]=(0,s.useState)({}),[y,C]=(0,s.useState)(i||null),[Z,P]=(0,s.useState)(!1),[A,W]=(0,s.useState)(!1),E=(0,s.useRef)(!1),{evaluation:I,loading:L}=(0,B.S6)(l,y||"");(0,s.useEffect)(()=>{t&&(async()=>{if(i)C(i);else if(!y&&!E.current){E.current=!0,P(!0);try{let e=await b(l,(null==o?void 0:o.uid)||"",(null==c?void 0:c.name)||"Unknown",null==d?void 0:d.id);C(e),x("Evaluation started")}catch(e){console.error("Failed to create evaluation:",e),m("Failed to start evaluation"),r()}finally{P(!1)}}})()},[t,i,l]),(0,s.useEffect)(()=>{I&&k(I.scores||{})},[I]),(0,s.useEffect)(()=>{t||(N(0),k({}),C(i||null),W(!1),E.current=!1)},[t,i]);let T=B.s7[f],M=(0,s.useCallback)((e,t,r,a)=>{k(s=>({...s,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==a&&{isNA:a},...void 0!==r&&""!==r&&{note:r}}})),W(!0)},[]),O=Object.keys(w).length,z=Math.round(O/B.gl*100),U=e=>{let t=B.s7[e];return{scored:t.items.filter(e=>void 0!==w[e.id]).length,total:t.items.length}},R=async()=>{if(y)try{await v(l,y,w),W(!1),x("Progress saved")}catch(e){console.error("Failed to save progress:",e),m("Failed to save progress")}},_=async()=>{if(y&&(!(O<B.gl)||window.confirm("You have scored ".concat(O," of ").concat(B.gl," items. ")+"Do you want to complete the evaluation anyway?")))try{await j(l,y,w),x("Evaluation completed!"),r()}catch(e){console.error("Failed to complete evaluation:",e),m("Failed to complete evaluation")}},V=()=>{if(A&&window.confirm("You have unsaved changes. Do you want to save before closing?")){R().then(()=>r());return}r()},G=e=>{e>=0&&e<B.s7.length&&N(e)};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:V}),(0,a.jsxs)("div",{className:"relative w-full max-w-4xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:d?"Re-evaluation":"ABLLS Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[n,d&&(0,a.jsxs)("span",{className:"ml-2 text-primary-600",children:["(comparing with ",new Date(d.completedAt||d.createdAt).toLocaleDateString(),")"]})]})]}),(0,a.jsx)("button",{onClick:V,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Overall Progress"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-primary-600",children:[O," / ",B.gl," items (",z,"%)"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:"".concat(z,"%")}})})]}),(0,a.jsx)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800 overflow-x-auto",children:(0,a.jsx)("div",{className:"flex gap-2 min-w-max",children:B.s7.map((e,t)=>{let{scored:r,total:s}=U(t),l=r===s,n=t===f;return(0,a.jsxs)("button",{onClick:()=>G(t),className:(0,u.W)("px-3 py-1.5 rounded-lg text-sm font-medium transition-all flex items-center gap-1.5",n?"bg-primary-600 text-white":l?"bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400":r>0?"bg-warning-100 dark:bg-warning-900/30 text-warning-700 dark:text-warning-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:[(0,a.jsx)("span",{children:e.key}),l&&!n&&(0,a.jsx)(D.Z,{className:"w-3 h-3"})]},e.key)})})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:Z||L?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:[T.key,". ",T.name]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[U(f).scored," of"," ",U(f).total," items scored"]})]}),(0,a.jsxs)("div",{className:"mb-6 p-3 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl flex flex-wrap gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-error-500 text-white flex items-center justify-center font-bold",children:"0"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Not observed"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-warning-500 text-white flex items-center justify-center font-bold",children:"1"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Emerging (with prompts)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-success-500 text-white flex items-center justify-center font-bold",children:"2"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Mastered (independent)"})]})]}),(0,a.jsx)(eN,{category:T,scores:w,previousScores:null==d?void 0:d.scores,onScoreChange:M})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("button",{onClick:()=>G(f-1),disabled:0===f,className:(0,u.W)("px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",0===f?"text-neutral-400 cursor-not-allowed":"text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800"),children:[(0,a.jsx)(eb.Z,{className:"w-4 h-4"}),"Previous"]})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[A&&(0,a.jsxs)("span",{className:"text-xs text-warning-600 flex items-center gap-1",children:[(0,a.jsx)(ev.Z,{className:"w-3 h-3"}),"Unsaved changes"]}),(0,a.jsxs)("button",{onClick:R,disabled:g||!A,className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2 disabled:opacity-50",children:[g?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(ej.Z,{className:"w-4 h-4"}),"Save Draft"]}),f===B.s7.length-1?(0,a.jsxs)("button",{onClick:_,disabled:g,className:"px-6 py-2 rounded-lg text-sm font-medium bg-success-600 hover:bg-success-700 text-white transition-colors flex items-center gap-2 disabled:opacity-50",children:[g?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(D.Z,{className:"w-4 h-4"}),"Complete Evaluation"]}):(0,a.jsxs)("button",{onClick:()=>G(f+1),className:"px-6 py-2 rounded-lg text-sm font-medium bg-primary-600 hover:bg-primary-700 text-white transition-colors flex items-center gap-2",children:["Next",(0,a.jsx)(F.Z,{className:"w-4 h-4"})]})]})]})]})]}):null}var ek=r(57284),ey=r(10775),eC=r(27271),eS=r(95200),eZ=r(95160),eD=r(18025);function eP(e){let{currentEvaluation:t,previousEvaluation:r}=e,l=(0,s.useMemo)(()=>{let e=t.overallPercentage-r.overallPercentage,a=Object.keys(t.categorySummaries||{}).map(e=>{var a,s,l,n,i,d;let o=(null===(s=t.categorySummaries)||void 0===s?void 0:null===(a=s[e])||void 0===a?void 0:a.percentage)||0,c=(null===(n=r.categorySummaries)||void 0===n?void 0:null===(l=n[e])||void 0===l?void 0:l.percentage)||0;return{key:e,name:(null===(d=t.categorySummaries)||void 0===d?void 0:null===(i=d[e])||void 0===i?void 0:i.categoryName)||e,current:o,previous:c,change:o-c}}).sort((e,t)=>e.key.localeCompare(t.key)),s=a.filter(e=>e.change>0).length,l=a.filter(e=>e.change<0).length,n=a.filter(e=>0===e.change).length;return{overallChange:e,categoryChanges:a,improved:s,declined:l,unchanged:n}},[t,r]),n=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,a.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wider mb-2",children:"Previous"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-neutral-600 dark:text-neutral-400",children:[r.overallPercentage,"%"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2 text-xs text-neutral-500",children:[(0,a.jsx)(W.Z,{className:"w-3 h-3"}),n(r.completedAt||r.updatedAt)]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(eD.Z,{className:"w-6 h-6 text-neutral-300 dark:text-neutral-600 hidden md:block"}),(0,a.jsxs)("div",{className:(0,u.W)("mt-2 px-4 py-2 rounded-xl text-center",l.overallChange>0?"bg-success-100 dark:bg-success-900/30":l.overallChange<0?"bg-error-100 dark:bg-error-900/30":"bg-neutral-100 dark:bg-neutral-800"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[l.overallChange>0?(0,a.jsx)(ep.Z,{className:"w-5 h-5 text-success-600"}):l.overallChange<0?(0,a.jsx)(ey.Z,{className:"w-5 h-5 text-error-600"}):(0,a.jsx)(eC.Z,{className:"w-5 h-5 text-neutral-500"}),(0,a.jsxs)("span",{className:(0,u.W)("text-2xl font-bold",l.overallChange>0?"text-success-600":l.overallChange<0?"text-error-600":"text-neutral-500"),children:[l.overallChange>0?"+":"",l.overallChange,"%"]})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"Overall Change"})]})]}),(0,a.jsxs)("div",{className:"bg-primary-50 dark:bg-primary-900/20 rounded-xl p-4 text-center border border-primary-200 dark:border-primary-800",children:[(0,a.jsx)("p",{className:"text-xs text-primary-600 dark:text-primary-400 uppercase tracking-wider mb-2",children:"Current"}),(0,a.jsxs)("p",{className:(0,u.W)("text-3xl font-bold",t.overallPercentage>=70?"text-success-600":t.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[t.overallPercentage,"%"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2 text-xs text-neutral-500",children:[(0,a.jsx)(W.Z,{className:"w-3 h-3"}),n(t.completedAt||t.updatedAt)]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-success-50 dark:bg-success-900/20 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-success-600",children:l.improved}),(0,a.jsx)("p",{className:"text-xs text-success-600/70",children:"Categories Improved"})]}),(0,a.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-500",children:l.unchanged}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Unchanged"})]}),(0,a.jsxs)("div",{className:"bg-error-50 dark:bg-error-900/20 rounded-xl p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-error-600",children:l.declined}),(0,a.jsx)("p",{className:"text-xs text-error-600/70",children:"Need Attention"})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 rounded-xl p-4 border border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-neutral-900 dark:text-white mb-4",children:"Visual Comparison"}),(0,a.jsx)(z.Z,{evaluation:t,previousEvaluation:r,size:"md",showLegend:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-neutral-900 dark:text-white mb-3",children:"Category Breakdown"}),(0,a.jsx)("div",{className:"space-y-2",children:l.categoryChanges.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-white dark:bg-neutral-800/50 rounded-xl border border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("div",{className:(0,u.W)("w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white text-sm",e.current>=70?"bg-success-500":e.current>=40?"bg-warning-500":"bg-error-500"),children:e.key}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white truncate",children:e.name}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,a.jsx)("div",{className:"flex-1 h-1.5 bg-neutral-100 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,u.W)("h-full transition-all",e.current>=70?"bg-success-500":e.current>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(e.current,"%")}})})})]}),(0,a.jsxs)("div",{className:"text-right flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"text-xs text-neutral-400",children:[e.previous,"%"]}),(0,a.jsx)(eD.Z,{className:"w-3 h-3 text-neutral-300"}),(0,a.jsxs)("span",{className:(0,u.W)("text-sm font-bold",e.current>=70?"text-success-600":e.current>=40?"text-warning-600":"text-error-600"),children:[e.current,"%"]}),(0,a.jsxs)("span",{className:(0,u.W)("text-xs font-medium px-1.5 py-0.5 rounded",e.change>0?"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400":e.change<0?"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400":"bg-neutral-100 text-neutral-500 dark:bg-neutral-800"),children:[e.change>0?"+":"",e.change,"%"]})]})]},e.key))})]})]})}var eA=r(60141),eW=r(20168),eE=r(48170);function eI(e){let{goals:t,title:r="Suggested IEP Goals",emptyMessage:l="No emerging skills identified for goal development."}=e,[n,i]=(0,s.useState)(!1),[d,o]=(0,s.useState)(null),[c,x]=(0,s.useState)(!1),m=async e=>{let t="Goal: ".concat(e.goalText,"\n\nShort-term Objective: ").concat(e.shortTermObjective,"\n\nTarget Skill: ").concat(e.itemDescription,"\nCriteria: ").concat(e.targetCriteria);try{await navigator.clipboard.writeText(t),o(e.id),setTimeout(()=>o(null),2e3)}catch(e){console.error("Failed to copy:",e)}},h=async()=>{let e=t.map((e,t)=>"Goal ".concat(t+1,": ").concat(e.skillCode," - ").concat(e.skillArea,"\n").concat(e.goalText,"\n\nShort-term Objective:\n").concat(e.shortTermObjective,"\n\nTarget Skill: ").concat(e.itemDescription,"\n")).join("\n---\n\n");try{await navigator.clipboard.writeText(e),x(!0),setTimeout(()=>x(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};if(0===t.length)return(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl text-center",children:[(0,a.jsx)(eS.Z,{className:"w-8 h-8 text-neutral-300 dark:text-neutral-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:l})]});let p=t.reduce((e,t)=>{let r=t.skillCode||t.skillArea;return e[r]||(e[r]={name:t.skillArea,goals:[]}),e[r].goals.push(t),e},{});return(0,a.jsxs)("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>i(!n),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-amber-100/50 dark:hover:bg-amber-900/30 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-amber-100 dark:bg-amber-800/50 rounded-lg flex items-center justify-center",children:(0,a.jsx)(eS.Z,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:r}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:[t.length," emerging skill",1!==t.length?"s":""," identified for IEP development"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 text-xs font-bold rounded-full",children:t.length}),n?(0,a.jsx)(J.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(q.Z,{className:"w-5 h-5 text-neutral-400"})]})]}),n&&(0,a.jsxs)("div",{className:"border-t border-amber-200 dark:border-amber-800",children:[(0,a.jsx)("div",{className:"px-4 py-2 bg-amber-100/50 dark:bg-amber-900/30 flex justify-end",children:(0,a.jsx)("button",{onClick:h,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-amber-700 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-800 rounded-lg transition-colors",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{className:"w-4 h-4"}),"Copied All!"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"w-4 h-4"}),"Copy All Goals"]})})}),(0,a.jsx)("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:Object.entries(p).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 text-xs font-bold rounded",children:t}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:r.name})]}),r.goals.map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-800 rounded-lg p-3 border border-amber-100 dark:border-neutral-700",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(G.Z,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-xs font-medium text-neutral-500",children:e.itemId})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mb-2",children:e.itemDescription}),(0,a.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-900 rounded p-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:"Goal:"}),(0,a.jsx)("p",{className:"text-sm text-neutral-800 dark:text-neutral-200",children:e.goalText})]})]}),(0,a.jsx)("button",{onClick:()=>m(e),className:(0,u.W)("p-2 rounded-lg transition-colors flex-shrink-0",d===e.id?"bg-success-100 dark:bg-success-900/30 text-success-600":"hover:bg-neutral-100 dark:hover:bg-neutral-700 text-neutral-400"),title:"Copy goal",children:d===e.id?(0,a.jsx)(D.Z,{className:"w-4 h-4"}):(0,a.jsx)(P.Z,{className:"w-4 h-4"})})]})},e.id))]},t)})}),(0,a.jsx)("div",{className:"px-4 py-2 bg-amber-100/50 dark:bg-amber-900/30 border-t border-amber-200 dark:border-amber-800",children:(0,a.jsxs)("p",{className:"text-xs text-neutral-500 flex items-center gap-1",children:[(0,a.jsx)(L.Z,{className:"w-3 h-3"}),"Goals are auto-generated from emerging skills (scored 0.5 in VB-MAPP, 1 in ABLLS)"]})})]})]})}var eL=r(12535);function eT(e){let{isOpen:t,onClose:r,clientId:l,clientData:n,evaluationId:i,previousEvaluation:d,onReEvaluate:o}=e,{t:c,i18n:x}=(0,eL.$G)(),m=x.language.startsWith("ro")?"ro-RO":"en-US",{evaluation:h,loading:p}=(0,B.S6)(l,i),{evaluations:g}=(0,B.F3)(l),[b,v]=(0,s.useState)(null),[j,N]=(0,s.useState)("summary");if(!t)return null;let w=(null==h?void 0:h.categorySummaries)?Object.entries(h.categorySummaries).sort((e,t)=>{let[r]=e,[a]=t;return r.localeCompare(a)}):[],k=e=>{var t,r;if(!(null==d?void 0:null===(t=d.categorySummaries)||void 0===t?void 0:t[e])||!(null==h?void 0:null===(r=h.categorySummaries)||void 0===r?void 0:r[e]))return null;let a=d.categorySummaries[e].percentage,s=h.categorySummaries[e].percentage-a;return{diff:s,trend:s>0?"up":s<0?"down":"same"}},y=d&&(null==h?void 0:h.overallPercentage)!==void 0?h.overallPercentage-d.overallPercentage:null,C=n.birthDate?(0,eA.Fw)(n.birthDate):null,S=h?(0,eW.tk)(h.overallPercentage):null,Z=(null==h?void 0:h.categorySummaries)?(0,eW.kE)(h.categorySummaries):[],D=(null==h?void 0:h.categorySummaries)?(0,eW.Qc)(h.categorySummaries):{},P=h?(0,eE.Ep)(h,n.name||"Client",B.s7):[];return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-4xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:c("evaluations.title")}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:n.name})]}),d&&(0,a.jsxs)("div",{className:"flex items-center bg-neutral-100 dark:bg-neutral-800 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>N("summary"),className:(0,u.W)("flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors","summary"===j?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(L.Z,{className:"w-4 h-4"}),c("evaluations.summary")]}),(0,a.jsxs)("button",{onClick:()=>N("comparison"),className:(0,u.W)("flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors","comparison"===j?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(ek.Z,{className:"w-4 h-4"}),c("evaluations.compare")]})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:p||!h?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):"comparison"===j&&d?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eP,{currentEvaluation:h,previousEvaluation:d})}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(W.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:c("evaluations.completed")}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:new Date(h.completedAt||h.updatedAt).toLocaleDateString(m,{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(f.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:c("evaluations.evaluator")}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:h.evaluatorName})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(G.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:c("evaluations.version")}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:h.version})]})]}),C&&(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(E.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:c("evaluations.client_age")}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:(0,eA.KD)(C)})]})]})]}),(0,a.jsx)("div",{className:"p-6 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/30 dark:to-primary-900/10 rounded-2xl border border-primary-200 dark:border-primary-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-primary-600 dark:text-primary-400 mb-1",children:c("evaluations.overall_score")}),(0,a.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-5xl font-bold",h.overallPercentage>=70?"text-success-600":h.overallPercentage>=40?"text-warning-600":"text-error-600"),children:[h.overallPercentage,"%"]}),(0,a.jsxs)("span",{className:"text-neutral-500",children:["(",h.overallScore," / ",h.overallMaxScore," ",c("evaluations.points"),")"]})]}),null!==y&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[y>0?(0,a.jsx)(ep.Z,{className:"w-4 h-4 text-success-600"}):y<0?(0,a.jsx)(ey.Z,{className:"w-4 h-4 text-error-600"}):(0,a.jsx)(eC.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:(0,u.W)("text-sm font-medium",y>0?"text-success-600":y<0?"text-error-600":"text-neutral-500"),children:[y>0?"+":"",c("evaluations.since_last",{value:y})]})]})]}),(0,a.jsx)("div",{className:"hidden md:block w-40 h-40 bg-white/50 dark:bg-neutral-800/50 rounded-xl overflow-hidden",children:(0,a.jsx)(z.E,{evaluation:h})})]})}),S&&(0,a.jsx)("div",{className:(0,u.W)("p-4 rounded-xl border","excellent"===S.level?"bg-success-50 border-success-200 dark:bg-success-900/20 dark:border-success-800":"good"===S.level?"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":"moderate"===S.level?"bg-warning-50 border-warning-200 dark:bg-warning-900/20 dark:border-warning-800":"bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ev.Z,{className:(0,u.W)("w-5 h-5 mt-0.5 flex-shrink-0","excellent"===S.level?"text-success-600":"good"===S.level?"text-blue-600":"moderate"===S.level?"text-warning-600":"text-orange-600")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:[c("evaluations.clinical_interpretation"),": ",S.title]}),(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mt-1",children:S.description}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-800 dark:text-neutral-200 mt-2",children:S.recommendation}),S.interventionHours&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1 italic",children:S.interventionHours})]})]})}),Z.length>0&&(0,a.jsx)("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(eS.Z,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:c("evaluations.priority_areas")}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:c("evaluations.priority_subtitle")}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:Z.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white dark:bg-neutral-800 rounded-lg text-sm border border-amber-200 dark:border-amber-700",children:[(0,a.jsx)("span",{className:"font-bold text-amber-700 dark:text-amber-400",children:e.key}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-300",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-neutral-500",children:["(",e.percentage,"%)"]})]},e.key))}),P.length>0&&(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-3",children:[P.length," emerging skills identified for IEP goal development"]})]})]})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:c("evaluations.skills_overview")}),(0,a.jsx)(z.Z,{evaluation:h,previousEvaluation:d,size:"lg",showLegend:!!d}),d&&(0,a.jsxs)("p",{className:"text-xs text-center text-neutral-500 mt-2",children:[c("evaluations.comparing_with")," ",new Date(d.completedAt||d.updatedAt).toLocaleDateString(m)]})]}),P.length>0&&(0,a.jsx)(eI,{goals:P,title:c("evaluations.suggested_goals"),emptyMessage:c("evaluations.no_emerging_skills")}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:c("evaluations.domain_analysis")}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(D).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800 rounded-xl border border-neutral-100 dark:border-neutral-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h4",{className:"font-bold text-neutral-800 dark:text-neutral-200 text-sm",children:t}),(0,a.jsxs)("span",{className:(0,u.W)("text-sm font-bold",r.percentage>=80?"text-success-600":r.percentage>=60?"text-blue-600":r.percentage>=40?"text-warning-600":"text-error-600"),children:[r.percentage,"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-200 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,u.W)("h-full rounded-full transition-all",r.percentage>=80?"bg-success-500":r.percentage>=60?"bg-blue-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(r.percentage,"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-2",children:["Categories: ",r.categories.join(", ")]})]},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:c("evaluations.category_breakdown")}),(0,a.jsx)("div",{className:"space-y-2",children:w.map(e=>{let[t,r]=e,s=k(t),l=b===t,n=B.s7.find(e=>e.key===t);return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-xl overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>v(l?null:t),className:"w-full p-4 flex items-center gap-4 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors",children:[(0,a.jsx)("div",{className:(0,u.W)("w-10 h-10 rounded-lg flex items-center justify-center font-bold text-white",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),children:t}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-medium text-neutral-900 dark:text-white",children:r.categoryName}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-sm font-bold",r.percentage>=70?"text-success-600":r.percentage>=40?"text-warning-600":"text-error-600"),children:[r.percentage,"%"]}),s&&(0,a.jsxs)("span",{className:(0,u.W)("text-xs font-medium px-1.5 py-0.5 rounded","up"===s.trend?"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400":"down"===s.trend?"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400":"bg-neutral-100 text-neutral-500 dark:bg-neutral-800"),children:[s.diff>0?"+":"",s.diff,"%"]})]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,u.W)("h-full transition-all",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(r.percentage,"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:[r.scoredItems,"/",r.totalItems," ",c("evaluations.items")," \xb7 ",r.totalScore,"/",r.maxPossibleScore," ",c("evaluations.points")]})]}),l?(0,a.jsx)(J.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(q.Z,{className:"w-5 h-5 text-neutral-400"})]}),l&&n&&(0,a.jsx)("div",{className:"border-t border-neutral-200 dark:border-neutral-700 p-4 bg-neutral-50 dark:bg-neutral-900/50",children:(0,a.jsx)(eN,{category:n,scores:h.scores,previousScores:null==d?void 0:d.scores,onScoreChange:()=>{},readOnly:!0})})]},t)})})]})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:c("evaluations.close")}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{let e="/reports/evaluation/?type=ablls&id=".concat(i,"&clientId=").concat(l);window.open(e,"_blank")},className:"px-4 py-2 rounded-lg text-sm font-bold bg-primary-600 hover:bg-primary-700 text-white transition-all flex items-center gap-2 shadow-lg shadow-primary-600/20",children:[(0,a.jsx)(eZ.Z,{className:"w-4 h-4"}),c("evaluations.view_report")]}),o&&(0,a.jsxs)("button",{onClick:o,className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),c("evaluations.start_reevaluation")]})]})]})]})]})}var eF=r(77819),eM=r(94830),eB=r(38333),eO=r(23356),ez=r(22983),eU=r(96528),eR=r(6541),e_=r(51161),eV=r(66363),eG=r(98964);let eH={A:"#ef4444",B:"#f97316",C:"#f59e0b",D:"#eab308",E:"#84cc16",F:"#22c55e",G:"#10b981",H:"#14b8a6",I:"#06b6d4",J:"#0ea5e9",K:"#3b82f6",L:"#6366f1",M:"#8b5cf6",N:"#a855f7",O:"#d946ef",P:"#ec4899",Q:"#f43f5e",R:"#78716c"};function eJ(e){let{evaluations:t,clientName:r}=e,[l,n]=(0,s.useState)([]),[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)("area"),x=(0,s.useMemo)(()=>t.filter(e=>"completed"===e.status).sort((e,t)=>new Date(e.completedAt||e.createdAt).getTime()-new Date(t.completedAt||t.createdAt).getTime()),[t]),m=(0,s.useMemo)(()=>x.map(e=>{let t=new Date(e.completedAt||e.createdAt),r={date:t.toISOString(),dateLabel:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}),overall:e.overallPercentage,evaluationId:e.id};return Object.entries(e.categorySummaries||{}).forEach(e=>{let[t,a]=e;r[t]=a.percentage}),r}),[x]),h=(0,s.useMemo)(()=>{if(x.length<2)return null;let e=x[0],t=x[x.length-1],r=t.overallPercentage-e.overallPercentage,a=[];return Object.keys(t.categorySummaries||{}).forEach(r=>{var s,l,n,i;let d=(null===(l=e.categorySummaries)||void 0===l?void 0:null===(s=l[r])||void 0===s?void 0:s.percentage)||0,o=(null===(i=t.categorySummaries)||void 0===i?void 0:null===(n=i[r])||void 0===n?void 0:n.percentage)||0;a.push({key:r,name:t.categorySummaries[r].categoryName,change:o-d})}),a.sort((e,t)=>t.change-e.change),{overallChange:r,totalEvaluations:x.length,mostImproved:a.slice(0,3),needsAttention:a.filter(e=>e.change<0).slice(-3).reverse(),timespan:{start:new Date(e.completedAt||e.createdAt),end:new Date(t.completedAt||t.createdAt)}}},[x]),p=e=>{n(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},g=e=>{let{active:t,payload:r,label:s}=e;return t&&r&&r.length?(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800 px-4 py-3 rounded-xl shadow-lg border border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white text-sm mb-2",children:s}),(0,a.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"overall"===e.name?"Overall":e.name})]}),(0,a.jsxs)("span",{className:"font-bold",style:{color:e.color},children:[e.value,"%"]})]},t))})]}):null};return 0===x.length?(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-8 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center",children:(0,a.jsx)(ep.Z,{className:"w-8 h-8 text-neutral-400"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No Progress Data Yet"}),(0,a.jsx)("p",{className:"text-neutral-500 max-w-sm mx-auto",children:"Complete at least one evaluation to start tracking progress over time."})]}):1===x.length?(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-8 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center",children:(0,a.jsx)(W.Z,{className:"w-8 h-8 text-primary-500"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"One Evaluation Completed"}),(0,a.jsx)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-4",children:"Complete a re-evaluation to see progress trends and comparisons."}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-neutral-100 dark:bg-neutral-800 rounded-xl",children:[(0,a.jsxs)("span",{className:"text-3xl font-bold text-primary-600",children:[x[0].overallPercentage,"%"]}),(0,a.jsx)("span",{className:"text-neutral-500 text-sm",children:"baseline score"})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[h&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 mb-2",children:"Overall Progress"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-3xl font-bold",h.overallChange>0?"text-success-600":h.overallChange<0?"text-error-600":"text-neutral-500"),children:[h.overallChange>0?"+":"",h.overallChange,"%"]}),h.overallChange>0?(0,a.jsx)(ep.Z,{className:"w-6 h-6 text-success-500"}):h.overallChange<0?(0,a.jsx)(ey.Z,{className:"w-6 h-6 text-error-500"}):(0,a.jsx)(eC.Z,{className:"w-6 h-6 text-neutral-400"})]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-2",children:["Over ",h.totalEvaluations," evaluations"]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 mb-3",children:"Most Improved"}),(0,a.jsx)("div",{className:"space-y-2",children:h.mostImproved.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded text-xs font-bold flex items-center justify-center text-white",style:{backgroundColor:eH[e.key]},children:e.key}),(0,a.jsx)("span",{className:"text-sm text-neutral-700 dark:text-neutral-300 truncate max-w-[120px]",children:e.name})]}),(0,a.jsxs)("span",{className:(0,u.W)("text-sm font-bold",e.change>0?"text-success-600":e.change<0?"text-error-600":"text-neutral-500"),children:[e.change>0?"+":"",e.change,"%"]})]},e.key))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 mb-3",children:"Needs Attention"}),h.needsAttention.length>0?(0,a.jsx)("div",{className:"space-y-2",children:h.needsAttention.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded text-xs font-bold flex items-center justify-center text-white",style:{backgroundColor:eH[e.key]},children:e.key}),(0,a.jsx)("span",{className:"text-sm text-neutral-700 dark:text-neutral-300 truncate max-w-[120px]",children:e.name})]}),(0,a.jsxs)("span",{className:"text-sm font-bold text-error-600",children:[e.change,"%"]})]},e.key))}):(0,a.jsxs)("p",{className:"text-sm text-success-600 flex items-center gap-2",children:[(0,a.jsx)(ep.Z,{className:"w-4 h-4"}),"All categories improving!"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Progress Over Time"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center bg-neutral-100 dark:bg-neutral-800 rounded-lg p-1",children:[(0,a.jsx)("button",{onClick:()=>c("area"),className:(0,u.W)("px-3 py-1.5 text-sm font-medium rounded-md transition-colors","area"===o?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:"Area"}),(0,a.jsx)("button",{onClick:()=>c("line"),className:(0,u.W)("px-3 py-1.5 text-sm font-medium rounded-md transition-colors","line"===o?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:"Line"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>d(!i),className:"flex items-center gap-2 px-4 py-2 bg-neutral-100 dark:bg-neutral-800 rounded-lg text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors",children:["Categories (",l.length||"All",")",(0,a.jsx)(q.Z,{className:(0,u.W)("w-4 h-4 transition-transform",i&&"rotate-180")})]}),i&&(0,a.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-72 bg-white dark:bg-neutral-800 rounded-xl shadow-xl border border-neutral-200 dark:border-neutral-700 p-3 z-20 max-h-80 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3 pb-2 border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:"Select Categories"}),(0,a.jsx)("button",{onClick:()=>n([]),className:"text-xs text-primary-600 hover:underline",children:"Clear all"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:B.s7.map(e=>(0,a.jsxs)("button",{onClick:()=>p(e.key),className:(0,u.W)("flex items-center gap-2 p-2 rounded-lg text-left text-sm transition-colors",l.includes(e.key)?"bg-primary-50 dark:bg-primary-900/30 border border-primary-200 dark:border-primary-800":"hover:bg-neutral-50 dark:hover:bg-neutral-700 border border-transparent"),children:[(0,a.jsx)("span",{className:"w-5 h-5 rounded text-[10px] font-bold flex items-center justify-center text-white flex-shrink-0",style:{backgroundColor:eH[e.key]},children:e.key}),(0,a.jsx)("span",{className:"text-neutral-700 dark:text-neutral-300 truncate text-xs",children:e.name})]},e.key))})]})]})]})]}),(0,a.jsx)(eF.h,{width:"100%",height:350,children:"area"===o?(0,a.jsxs)(eM.T,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"overallGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]}),l.map(e=>(0,a.jsxs)("linearGradient",{id:"gradient-".concat(e),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:eH[e],stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:eH[e],stopOpacity:0})]},e))]}),(0,a.jsx)(eB.q,{strokeDasharray:"3 3",stroke:"#e5e5e5",className:"dark:stroke-neutral-700"}),(0,a.jsx)(eO.K,{dataKey:"dateLabel",tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"}}),(0,a.jsx)(ez.B,{domain:[0,100],tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"},tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(eU.u,{content:(0,a.jsx)(g,{})}),(0,a.jsx)(eR.D,{}),(0,a.jsx)(e_.uN,{type:"monotone",dataKey:"overall",name:"Overall",stroke:"#6366f1",fill:"url(#overallGradient)",strokeWidth:3,dot:{fill:"#6366f1",strokeWidth:2,r:4},activeDot:{r:6}}),l.map(e=>(0,a.jsx)(e_.uN,{type:"monotone",dataKey:e,name:e,stroke:eH[e],fill:"url(#gradient-".concat(e,")"),strokeWidth:2,dot:{fill:eH[e],strokeWidth:2,r:3},activeDot:{r:5}},e))]}):(0,a.jsxs)(eV.w,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[(0,a.jsx)(eB.q,{strokeDasharray:"3 3",stroke:"#e5e5e5",className:"dark:stroke-neutral-700"}),(0,a.jsx)(eO.K,{dataKey:"dateLabel",tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"}}),(0,a.jsx)(ez.B,{domain:[0,100],tick:{fill:"#737373",fontSize:12},tickLine:!1,axisLine:{stroke:"#e5e5e5"},tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(eU.u,{content:(0,a.jsx)(g,{})}),(0,a.jsx)(eR.D,{}),(0,a.jsx)(eG.x1,{type:"monotone",dataKey:"overall",name:"Overall",stroke:"#6366f1",strokeWidth:3,dot:{fill:"#6366f1",strokeWidth:2,r:4},activeDot:{r:6}}),l.map(e=>(0,a.jsx)(eG.x1,{type:"monotone",dataKey:e,name:e,stroke:eH[e],strokeWidth:2,dot:{fill:eH[e],strokeWidth:2,r:3},activeDot:{r:5}},e))]})}),h&&(0,a.jsxs)("p",{className:"text-xs text-center text-neutral-500 mt-4",children:["Showing progress from ",h.timespan.start.toLocaleDateString()," to ",h.timespan.end.toLocaleDateString()]})]})]})}var eq=r(3224),eK=r(80822);function eY(e){let{clientId:t,clientName:r,onStartNew:l,onContinue:n,onView:i,onReEvaluate:d}=e,{evaluations:o,loading:m,error:h}=(0,eq.Dy)(t),{deleteEvaluation:g,saving:b}=(0,eq.vS)(),{success:v,error:j}=(0,p.useToast)(),[f,N]=(0,s.useState)(null),[w,k]=(0,s.useState)(null),y=async e=>{if(confirm("Delete this VB-MAPP evaluation? This cannot be undone.")){k(e);try{await g(t,e),v("Evaluation deleted")}catch(e){console.error("Failed to delete evaluation:",e),j("Failed to delete evaluation")}finally{k(null),N(null)}}},C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Z=o.filter(e=>"in_progress"===e.status),D=o.filter(e=>"completed"===e.status);return m?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):h?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-error-500",children:h})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("button",{onClick:l,className:"w-full py-4 border-2 border-dashed border-purple-300 dark:border-purple-700 rounded-2xl text-purple-600 dark:text-purple-400 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20 transition-all font-medium flex items-center justify-center gap-2",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5"}),"Start New VB-MAPP Evaluation"]}),Z.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),"In Progress (",Z.length,")"]}),Z.map(e=>(0,a.jsxs)("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Started ",C(e.createdAt)," \xb7 ",e.overallMilestonePercentage,"% scored"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>n(e.id),className:"px-4 py-2 bg-warning-600 hover:bg-warning-700 text-white rounded-lg font-medium text-sm transition-colors flex items-center gap-2",children:["Continue",(0,a.jsx)(F.Z,{className:"w-4 h-4"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-warning-100 dark:hover:bg-warning-900/30 transition-colors",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:w===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[w===e.id?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]}),(0,a.jsx)("div",{className:"mt-3 h-1.5 bg-warning-200 dark:bg-warning-900/50 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all",style:{width:"".concat(e.overallMilestonePercentage,"%")}})})]},e.id))]}),D.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider flex items-center gap-2",children:[(0,a.jsx)(K.Z,{className:"w-4 h-4"}),"Completed (",D.length,")"]}),D.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-4 hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:["Completed ",C(e.completedAt||e.updatedAt)]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-0.5",children:["By ",e.evaluatorName," \xb7 Level ",e.dominantLevel]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,u.W)("text-2xl font-bold",e.overallMilestonePercentage>=70?"text-success-600":e.overallMilestonePercentage>=40?"text-warning-600":"text-error-600"),children:[e.overallMilestonePercentage,"%"]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400",children:[e.overallMilestoneScore,"/",e.overallMilestoneMaxScore]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>i(e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",title:"View details",children:(0,a.jsx)(en.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,a.jsx)("button",{onClick:()=>d(e),className:"p-2 rounded-lg hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors",title:"Start re-evaluation",children:(0,a.jsx)(A.Z,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>N(f===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-neutral-500"})}),f===e.id&&(0,a.jsx)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white dark:bg-neutral-800 rounded-lg shadow-lg border border-neutral-200 dark:border-neutral-700 py-1 z-10",children:(0,a.jsxs)("button",{onClick:()=>y(e.id),disabled:w===e.id,className:"w-full px-3 py-2 text-left text-sm text-error-600 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center gap-2 disabled:opacity-50",children:[w===e.id?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Delete"]})})]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-neutral-100 dark:border-neutral-800",children:(0,a.jsx)(eK.Z,{evaluation:e,compact:!0})})]},e.id))]}),0===o.length&&(0,a.jsxs)("div",{className:"text-center py-12 bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-2xl",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-2",children:"No VB-MAPP Evaluations Yet"}),(0,a.jsxs)("p",{className:"text-neutral-500 max-w-sm mx-auto mb-6",children:["Start a VB-MAPP evaluation to assess ",r,"'s verbal behavior milestones and track progress."]}),(0,a.jsxs)("button",{onClick:l,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-purple-500/20",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),"Start First Evaluation"]})]})]})}var eQ=r(61524);let e$=[{value:0,label:"0",color:"text-white",bgColor:"bg-error-500"},{value:.5,label:"\xbd",color:"text-white",bgColor:"bg-warning-500"},{value:1,label:"1",color:"text-white",bgColor:"bg-success-500"}];function eX(e){let{area:t,scores:r,previousScores:l,onScoreChange:n,readOnly:i=!1}=e,[d,o]=(0,s.useState)(new Set),[c,x]=(0,s.useState)({}),[m,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=0,a=null;for(let s=0;s<t.items.length;s++){let l=t.items[s],n=r[l.id],i=null==n?void 0:n.score,d=null==n?void 0:n.isNA;if(0!==i||d?(.5===i||1===i)&&(e=0):e++,e>=3){a=l.id;break}}h(a)},[t.items,r]);let p=e=>{let t=new Set(d);t.has(e)?t.delete(e):t.add(e),o(t)},g=(e,t)=>{x(r=>({...r,[e]:t}))},b=e=>{let t=r[e];if(t){let r=c[e]||t.note;n(e,t.score,r,t.isNA)}},v=e=>{if(!(null==l?void 0:l[e])||!r[e])return null;let t=l[e].score,a=r[e].score-t;return{diff:a,trend:a>0?"up":a<0?"down":"same"}};return(0,a.jsxs)("div",{className:"space-y-3",children:[m&&!i&&(0,a.jsxs)("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[(0,a.jsx)(ev.Z,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-bold text-amber-800 dark:text-amber-400",children:"Ceiling Reached"}),(0,a.jsx)("p",{className:"text-xs text-amber-700 dark:text-amber-500 mt-0.5",children:"Three consecutive 0s detected. Clinical standard suggests stopping testing for this skill area."})]})]}),t.items.map((e,s)=>{var l,o;let x=r[e.id],h=null==x?void 0:x.score,j=null==x?void 0:x.isNA,f=d.has(e.id),N=v(e.id),w=null!==(o=null!==(l=c[e.id])&&void 0!==l?l:null==x?void 0:x.note)&&void 0!==o?o:"",k=t.items.findIndex(t=>t.id===e.id),y=m?t.items.findIndex(e=>e.id===m):1/0;return(0,a.jsx)("div",{className:(0,u.W)("rounded-xl border transition-all",j?"bg-neutral-100 dark:bg-neutral-800/20 border-dashed border-neutral-300 opacity-75":void 0!==h?"bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700":k>y?"bg-neutral-100/50 dark:bg-neutral-800/20 border-dashed border-neutral-200 dark:border-neutral-800 opacity-60":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-200 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("span",{className:"text-sm font-bold text-neutral-400",children:s+1}),(0,a.jsxs)("span",{className:"text-[10px] text-neutral-400 mt-0.5",children:[e.months,"mo"]})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 leading-relaxed",children:e.text}),N&&!j&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-1",children:["up"===N.trend?(0,a.jsx)(ep.Z,{className:"w-3 h-3 text-success-500"}):"down"===N.trend?(0,a.jsx)(ey.Z,{className:"w-3 h-3 text-error-500"}):(0,a.jsx)(eC.Z,{className:"w-3 h-3 text-neutral-400"}),(0,a.jsxs)("span",{className:(0,u.W)("text-xs","up"===N.trend?"text-success-600":"down"===N.trend?"text-error-600":"text-neutral-500"),children:[N.diff>0?"+":"",N.diff," from previous"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,0,null==x?void 0:x.note,!j),disabled:i,className:(0,u.W)("px-2 h-9 rounded-lg font-bold text-[10px] transition-all",j?"bg-neutral-500 text-white shadow-lg":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200"),children:"N/A"}),e$.map(t=>(0,a.jsx)("button",{onClick:()=>!i&&n(e.id,t.value,w||void 0,!1),disabled:i,className:(0,u.W)("w-9 h-9 rounded-lg font-bold text-sm transition-all",h!==t.value||j?i?"bg-neutral-100 dark:bg-neutral-800 text-neutral-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200 dark:hover:bg-neutral-700":"".concat(t.bgColor," ").concat(t.color," ring-2 ring-offset-2")),children:t.label},t.value))]}),(0,a.jsx)("button",{onClick:()=>p(e.id),className:(0,u.W)("p-2 rounded-lg transition-colors",f||(null==x?void 0:x.note)?"bg-primary-100 dark:bg-primary-900/30 text-primary-600":"hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-400"),children:(0,a.jsx)(Z.Z,{className:"w-4 h-4"})})]}),f&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-neutral-200 dark:border-neutral-700",children:(0,a.jsx)("textarea",{value:w,onChange:t=>g(e.id,t.target.value),onBlur:()=>b(e.id),placeholder:"Add observation notes...",disabled:i,className:"w-full px-3 py-2 text-sm bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50",rows:2})})]})},e.id)})]})}let e0=[{value:0,label:"0",description:"Not a barrier",color:"bg-success-500"},{value:1,label:"1",description:"Minor barrier",color:"bg-success-400"},{value:2,label:"2",description:"Moderate barrier",color:"bg-warning-400"},{value:3,label:"3",description:"Significant barrier",color:"bg-warning-500"},{value:4,label:"4",description:"Severe barrier",color:"bg-error-500"}];function e2(e){let{barriers:t,scores:r,onScoreChange:l,readOnly:n=!1}=e,[i,d]=(0,s.useState)(new Set),[o,c]=(0,s.useState)({}),x=e=>{let t=new Set(i);t.has(e)?t.delete(e):t.add(e),d(t)},m=(e,t)=>{c(r=>({...r,[e]:t}))},h=e=>{var t,a;let s=null===(t=r[e])||void 0===t?void 0:t.score;if(void 0!==s){let t=o[e]||(null===(a=r[e])||void 0===a?void 0:a.note);l(e,s,t)}},p=e=>{var t;return void 0===e?"bg-neutral-200 dark:bg-neutral-700":(null===(t=e0.find(t=>t.value===e))||void 0===t?void 0:t.color)||"bg-neutral-200"};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Rate each barrier from 0 (not present) to 4 (severe):"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:e0.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:(0,u.W)("w-6 h-6 rounded text-white text-xs font-bold flex items-center justify-center",e.color),children:e.value}),(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:e.description})]},e.value))})]}),(0,a.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>{var s,d;let c=r[e.id],g=i.has(e.id),b=null!==(d=null!==(s=o[e.id])&&void 0!==s?s:null==c?void 0:c.note)&&void 0!==d?d:"",v=c&&c.score>=3;return(0,a.jsx)("div",{className:(0,u.W)("rounded-xl border transition-all",v?"bg-error-50 dark:bg-error-900/20 border-error-200 dark:border-error-800":void 0!==c?"bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-200 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:(0,u.W)("w-2 h-full min-h-[40px] rounded-full",p(null==c?void 0:c.score))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-bold text-neutral-400",children:["B",t+1]}),v&&(0,a.jsx)(eQ.Z,{className:"w-4 h-4 text-error-500"})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 leading-relaxed",children:e.text})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:e0.map(t=>(0,a.jsx)("button",{onClick:()=>!n&&l(e.id,t.value,b||void 0),disabled:n,className:(0,u.W)("w-8 h-8 rounded-lg font-bold text-xs transition-all",(null==c?void 0:c.score)===t.value?"".concat(t.color," text-white ring-2 ring-offset-2"):n?"bg-neutral-100 dark:bg-neutral-800 text-neutral-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:t.value},t.value))}),(0,a.jsx)("button",{onClick:()=>x(e.id),className:(0,u.W)("p-2 rounded-lg transition-colors",g||(null==c?void 0:c.note)?"bg-primary-100 dark:bg-primary-900/30 text-primary-600":"hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-400"),children:(0,a.jsx)(Z.Z,{className:"w-4 h-4"})})]}),g&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-neutral-200 dark:border-neutral-700 ml-6",children:(0,a.jsx)("textarea",{value:b,onChange:t=>m(e.id,t.target.value),onBlur:()=>h(e.id),placeholder:"Add observation notes about this barrier...",disabled:n,className:"w-full px-3 py-2 text-sm bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50",rows:2})})]})},e.id)})})]})}let e5=[{id:"level1",label:"Level 1",description:"0-18 months"},{id:"level2",label:"Level 2",description:"18-30 months"},{id:"level3",label:"Level 3",description:"30-48 months"},{id:"barriers",label:"Barriers",description:"24 items"},{id:"transition",label:"Transition",description:"18 items"}];function e1(e){let{isOpen:t,onClose:r,clientId:l,clientName:n,evaluationId:i,previousEvaluation:d}=e,{user:o,userData:c}=(0,h.useAuth)(),{success:x,error:m}=(0,p.useToast)(),{saving:g,createEvaluation:b,saveProgress:v,completeEvaluation:j}=(0,eq.vS)(),[f,N]=(0,s.useState)("level1"),[w,k]=(0,s.useState)(0),[y,C]=(0,s.useState)({}),[Z,P]=(0,s.useState)({}),[A,W]=(0,s.useState)({}),[E,I]=(0,s.useState)(i||null),[L,T]=(0,s.useState)(!1),[M,B]=(0,s.useState)(!1),O=(0,s.useRef)(!1),{evaluation:z,loading:U}=(0,eq.F9)(l,E||""),R=(()=>{switch(f){case"level1":return eq.wB;case"level2":return eq.H3;case"level3":return eq.PW;default:return[]}})(),_=R[w];(0,s.useEffect)(()=>{t&&(async()=>{if(i)I(i);else if(!E&&!O.current){O.current=!0,T(!0);try{let e=await b(l,(null==o?void 0:o.uid)||"",(null==c?void 0:c.name)||"Unknown",null==d?void 0:d.id);I(e),x("VB-MAPP evaluation started")}catch(e){console.error("Failed to create VB-MAPP evaluation:",e),m("Failed to start evaluation"),r()}finally{T(!1)}}})()},[t,i,l]),(0,s.useEffect)(()=>{z&&(C(z.milestoneScores||{}),P(z.barrierScores||{}),W(z.transitionScores||{}))},[z]),(0,s.useEffect)(()=>{t||(N("level1"),k(0),C({}),P({}),W({}),I(i||null),B(!1),O.current=!1)},[t,i]);let V=(0,s.useCallback)((e,t,r,a)=>{C(s=>({...s,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==a&&{isNA:a},...void 0!==r&&""!==r&&{note:r}}})),B(!0)},[]),G=(0,s.useCallback)((e,t,r)=>{P(a=>({...a,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==r&&""!==r&&{note:r}}})),B(!0)},[]),H=(0,s.useCallback)((e,t,r)=>{W(a=>({...a,[e]:{score:t,updatedAt:new Date().toISOString(),...void 0!==r&&""!==r&&{note:r}}})),B(!0)},[]),J=Object.keys(y).length,q=Object.keys(Z).length,K=Object.keys(A).length,Q=Math.round((J+q+K)/(eq.XT+eq.ek.length+eq.Zi.length)*100),$=async()=>{if(E)try{await v(l,E,y,Z,A),B(!1),x("Progress saved")}catch(e){console.error("Failed to save progress:",e),m("Failed to save progress")}},X=async()=>{if(!E)return;let e=eq.XT+eq.ek.length+eq.Zi.length,t=J+q+K;if(!(t<e)||window.confirm("You have scored ".concat(t," of ").concat(e," items. Complete anyway?")))try{await j(l,E,y,Z,A),x("VB-MAPP evaluation completed!"),r()}catch(e){console.error("Failed to complete evaluation:",e),m("Failed to complete evaluation")}},ee=()=>{if(M&&window.confirm("Save changes before closing?")){$().then(()=>r());return}r()},et="level1"===f&&0===w;return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:ee}),(0,a.jsxs)("div",{className:"relative w-full max-w-5xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[n,d&&(0,a.jsx)("span",{className:"ml-2 text-primary-600",children:"(Re-evaluation)"})]})]}),(0,a.jsx)("button",{onClick:ee,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Overall Progress"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-primary-600",children:[Q,"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300",style:{width:"".concat(Q,"%")}})})]}),(0,a.jsx)("div",{className:"px-6 py-3 border-b border-neutral-200 dark:border-neutral-800 overflow-x-auto",children:(0,a.jsx)("div",{className:"flex gap-2 min-w-max",children:e5.map(e=>{let t=e.id===f;return(0,a.jsxs)("button",{onClick:()=>{N(e.id),k(0)},className:(0,u.W)("px-4 py-2 rounded-lg text-sm font-medium transition-all flex flex-col items-start",t?"bg-primary-600 text-white":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"),children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)("span",{className:(0,u.W)("text-[10px]",t?"text-white/70":"text-neutral-400"),children:e.description})]},e.id)})})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:L||U?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,a.jsxs)(a.Fragment,{children:[("level1"===f||"level2"===f||"level3"===f)&&_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:R.map((e,t)=>{let r=e.items.filter(e=>y[e.id]).length,s=r===e.items.length,l=t===w;return(0,a.jsxs)("button",{onClick:()=>k(t),className:(0,u.W)("px-3 py-1.5 rounded-lg text-sm font-medium transition-all",l?"bg-primary-600 text-white":s?"bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400":r>0?"bg-warning-100 dark:bg-warning-900/30 text-warning-700 dark:text-warning-400":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400"),children:[e.code,s&&!l&&(0,a.jsx)(D.Z,{className:"w-3 h-3 ml-1 inline"})]},e.id)})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:[_.code,": ",_.name]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[_.items.filter(e=>y[e.id]).length," of ",_.items.length," items scored"]})]}),(0,a.jsxs)("div",{className:"mb-6 p-3 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl flex flex-wrap gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-error-500 text-white flex items-center justify-center font-bold",children:"0"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Not present"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-warning-500 text-white flex items-center justify-center font-bold",children:"\xbd"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Emerging"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded bg-success-500 text-white flex items-center justify-center font-bold",children:"1"}),(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Mastered"})]})]}),(0,a.jsx)(eX,{area:_,scores:y,previousScores:null==d?void 0:d.milestoneScores,onScoreChange:V})]}),"barriers"===f&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(eQ.Z,{className:"w-6 h-6 text-warning-500"}),"Barriers Assessment"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[q," of ",eq.ek.length," barriers assessed"]})]}),(0,a.jsx)(e2,{barriers:eq.ek,scores:Z,onScoreChange:G})]}),"transition"===f&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(eD.Z,{className:"w-6 h-6 text-primary-500"}),"Transition Assessment"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:[K," of ",eq.Zi.length," items assessed"]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Rate readiness from 1 (not ready) to 5 (fully ready):"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:[1,2,3,4,5].map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:(0,u.W)("w-6 h-6 rounded text-white text-xs font-bold flex items-center justify-center",e<=2?"bg-error-500":e<=3?"bg-warning-500":"bg-success-500"),children:e}),(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:1===e?"Not ready":5===e?"Fully ready":""})]},e))})]}),(0,a.jsx)("div",{className:"space-y-3",children:eq.Zi.map((e,t)=>{let r=A[e.id];return(0,a.jsx)("div",{className:(0,u.W)("rounded-xl border p-4 transition-all",r?"bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-200 dark:border-neutral-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("span",{className:"text-sm font-bold text-neutral-400",children:["T",t+1]}),(0,a.jsx)("p",{className:"flex-1 text-sm text-neutral-700 dark:text-neutral-300",children:e.text}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>(0,a.jsx)("button",{onClick:()=>H(e.id,t),className:(0,u.W)("w-8 h-8 rounded-lg font-bold text-xs transition-all",(null==r?void 0:r.score)===t?t<=2?"bg-error-500 text-white ring-2 ring-offset-2":t<=3?"bg-warning-500 text-white ring-2 ring-offset-2":"bg-success-500 text-white ring-2 ring-offset-2":"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 hover:bg-neutral-200"),children:t},t))})]})},e.id)})})]})]})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsxs)("button",{onClick:()=>{if("level1"===f||"level2"===f||"level3"===f){if(w>0)k(w-1);else{let e=e5.findIndex(e=>e.id===f);if(e>0){let t=e5[e-1].id;N(t),k(("level1"===t?eq.wB:"level2"===t?eq.H3:"level3"===t?eq.PW:[]).length-1)}}}else{let e=e5.findIndex(e=>e.id===f);if(e>0){let t=e5[e-1].id;N(t),k(Math.max(0,("level1"===t?eq.wB:"level2"===t?eq.H3:"level3"===t?eq.PW:[]).length-1))}}},disabled:et,className:(0,u.W)("px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",et?"text-neutral-400 cursor-not-allowed":"text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800"),children:[(0,a.jsx)(eb.Z,{className:"w-4 h-4"}),"Previous"]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[M&&(0,a.jsxs)("span",{className:"text-xs text-warning-600 flex items-center gap-1",children:[(0,a.jsx)(ev.Z,{className:"w-3 h-3"}),"Unsaved changes"]}),(0,a.jsxs)("button",{onClick:$,disabled:g||!M,className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2 disabled:opacity-50",children:[g?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(ej.Z,{className:"w-4 h-4"}),"Save Draft"]}),"transition"===f?(0,a.jsxs)("button",{onClick:X,disabled:g,className:"px-6 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white transition-colors flex items-center gap-2 disabled:opacity-50",children:[g?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(D.Z,{className:"w-4 h-4"}),"Complete Evaluation"]}):(0,a.jsxs)("button",{onClick:()=>{if("level1"===f||"level2"===f||"level3"===f){if(w<R.length-1)k(w+1);else{let e=e5.findIndex(e=>e.id===f);e<e5.length-1&&(N(e5[e+1].id),k(0))}}else{let e=e5.findIndex(e=>e.id===f);e<e5.length-1&&(N(e5[e+1].id),k(0))}},className:"px-6 py-2 rounded-lg text-sm font-medium bg-primary-600 hover:bg-primary-700 text-white transition-colors flex items-center gap-2",children:["Next",(0,a.jsx)(F.Z,{className:"w-4 h-4"})]})]})]})]})]}):null}function e4(e){let{isOpen:t,onClose:r,clientId:l,clientData:n,evaluationId:i,previousEvaluation:d,onReEvaluate:o}=e,{evaluation:c,loading:x}=(0,eq.F9)(l,i),[m,h]=(0,s.useState)(null);if(!t)return null;let p=d&&c?c.overallMilestonePercentage-d.overallMilestonePercentage:null,g=e=>{switch(e){case"ready":return{label:"Ready",color:"text-success-600 bg-success-100 dark:bg-success-900/30"};case"developing":return{label:"Developing",color:"text-warning-600 bg-warning-100 dark:bg-warning-900/30"};case"emerging":return{label:"Emerging",color:"text-orange-600 bg-orange-100 dark:bg-orange-900/30"};default:return{label:"Not Ready",color:"text-error-600 bg-error-100 dark:bg-error-900/30"}}},b=n.birthDate?(0,eA.Fw)(n.birthDate):null,v=c?(0,eA.JW)(c.dominantLevel):"",j=b&&c?(0,eA.Sy)(b.totalMonths,(0,eA.QI)(c.overallMilestoneScore)):null,N=j&&c?(0,eW.c9)(j.delayPercentage,j.severityLabel,c.dominantLevel):null,w=c?(0,eE.pH)(c,n.name||"Client",eq.W3):[];return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-5xl bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"VB-MAPP Evaluation Results"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:n.name})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-neutral-800 transition-colors",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:x||!c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(W.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:new Date(c.completedAt||c.updatedAt).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(f.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Evaluator"}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:c.evaluatorName})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(G.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Dominant Level"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:["Level ",c.dominantLevel]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl",children:[(0,a.jsx)(eD.Z,{className:"w-5 h-5 text-neutral-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Transition Readiness"}),(0,a.jsx)("span",{className:(0,u.W)("text-xs font-bold px-2 py-0.5 rounded",g(c.transitionSummary.readinessLevel).color),children:g(c.transitionSummary.readinessLevel).label})]})]})]}),b&&j&&(0,a.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800 flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider",children:"Chronological Age"}),(0,a.jsx)("p",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:(0,eA.KD)(b)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider",children:"Dev. Age Equivalent"}),(0,a.jsx)("p",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:v})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider",children:"Developmental Delay"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:j.delayMonths>0?"".concat(j.delayMonths," months"):"None"}),j.delayMonths>0&&(0,a.jsx)("span",{className:(0,u.W)("text-xs px-2 py-0.5 rounded font-bold uppercase","profound"===j.severityLabel?"bg-red-100 text-red-700":"severe"===j.severityLabel?"bg-orange-100 text-orange-700":"moderate"===j.severityLabel?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"),children:j.severityLabel})]})]})]}),N&&(0,a.jsx)("div",{className:(0,u.W)("p-4 rounded-xl border","excellent"===N.level?"bg-success-50 border-success-200 dark:bg-success-900/20 dark:border-success-800":"good"===N.level?"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":"moderate"===N.level?"bg-warning-50 border-warning-200 dark:bg-warning-900/20 dark:border-warning-800":"bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ev.Z,{className:(0,u.W)("w-5 h-5 mt-0.5 flex-shrink-0","excellent"===N.level?"text-success-600":"good"===N.level?"text-blue-600":"moderate"===N.level?"text-warning-600":"text-orange-600")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-neutral-900 dark:text-white",children:["Clinical Interpretation: ",N.title]}),(0,a.jsx)("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mt-1",children:N.description}),(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-800 dark:text-neutral-200 mt-2",children:N.recommendation}),N.interventionHours&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1 italic",children:N.interventionHours}),w.length>0&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-current/10",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eS.Z,{className:"w-4 h-4 text-amber-500"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:[(0,a.jsx)("span",{className:"font-bold text-amber-600",children:w.length})," emerging skills identified for IEP goal development"]})]})})]})]})}),(0,a.jsx)("div",{className:"p-6 bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/30 dark:to-purple-900/20 rounded-2xl border border-indigo-200 dark:border-indigo-800",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-indigo-600 dark:text-indigo-400 mb-1",children:"Overall Milestones Score"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-5xl font-bold",c.overallMilestonePercentage>=70?"text-success-600":c.overallMilestonePercentage>=40?"text-warning-600":"text-error-600"),children:[c.overallMilestonePercentage,"%"]}),(0,a.jsxs)("span",{className:"text-neutral-500",children:["(",c.overallMilestoneScore," / ",c.overallMilestoneMaxScore," points)"]})]}),null!==p&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[p>0?(0,a.jsx)(ep.Z,{className:"w-4 h-4 text-success-600"}):p<0?(0,a.jsx)(ey.Z,{className:"w-4 h-4 text-error-600"}):(0,a.jsx)(eC.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:(0,u.W)("text-sm font-medium",p>0?"text-success-600":p<0?"text-error-600":"text-neutral-500"),children:[p>0?"+":"",p,"% since last evaluation"]})]})]})})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Milestone Grid"}),(0,a.jsx)(eK.Z,{evaluation:c,previousEvaluation:d})]}),w.length>0&&(0,a.jsx)(eI,{goals:w,title:"Suggested IEP Goals",emptyMessage:"No emerging skills identified for goal development."}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"Level Breakdown"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(c.levelSummaries).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:(0,u.W)("p-4 rounded-xl border","1"===t?"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-200 dark:border-indigo-800":"2"===t?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":"bg-pink-50 dark:bg-pink-900/20 border-pink-200 dark:border-pink-800"),children:[(0,a.jsx)("p",{className:(0,u.W)("text-sm font-medium mb-2","1"===t?"text-indigo-600 dark:text-indigo-400":"2"===t?"text-purple-600 dark:text-purple-400":"text-pink-600 dark:text-pink-400"),children:r.levelName}),(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-3xl font-bold",r.percentage>=70?"text-success-600":r.percentage>=40?"text-warning-600":"text-error-600"),children:[r.percentage,"%"]}),(0,a.jsxs)("span",{className:"text-xs text-neutral-500",children:[r.totalScore,"/",r.maxPossibleScore]})]}),(0,a.jsx)("div",{className:"mt-2 h-2 bg-white/50 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,u.W)("h-full transition-all",r.percentage>=70?"bg-success-500":r.percentage>=40?"bg-warning-500":"bg-error-500"),style:{width:"".concat(r.percentage,"%")}})})]},t)})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>h("barriers"===m?null:"barriers"),className:"w-full p-4 flex items-center justify-between hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(eQ.Z,{className:"w-5 h-5 text-warning-500"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Barriers Assessment"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[c.barrierSummary.severeBarriers.length," severe barriers identified"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-lg font-bold",c.barrierSummary.averageSeverity<=1?"text-success-600":c.barrierSummary.averageSeverity<=2?"text-warning-600":"text-error-600"),children:["Avg: ",c.barrierSummary.averageSeverity]}),"barriers"===m?(0,a.jsx)(J.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(q.Z,{className:"w-5 h-5 text-neutral-400"})]})]}),"barriers"===m&&(0,a.jsx)("div",{className:"p-4 pt-0 border-t border-neutral-200 dark:border-neutral-700",children:(0,a.jsx)("div",{className:"space-y-2 mt-4",children:eq.ek.filter(e=>c.barrierScores[e.id]).map((e,t)=>{var r;let s=null===(r=c.barrierScores[e.id])||void 0===r?void 0:r.score;return(0,a.jsxs)("div",{className:(0,u.W)("p-3 rounded-lg flex items-center gap-3",s>=3?"bg-error-50 dark:bg-error-900/20":"bg-neutral-50 dark:bg-neutral-800"),children:[(0,a.jsx)("span",{className:(0,u.W)("w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white text-sm",0===s?"bg-success-500":s<=2?"bg-warning-500":"bg-error-500"),children:s}),(0,a.jsx)("span",{className:"text-sm text-neutral-700 dark:text-neutral-300 flex-1 font-medium",children:e.text.split("(")[0].trim()})]},e.id)})})})]}),(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-800/50 border border-neutral-200 dark:border-neutral-700 rounded-2xl p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(eD.Z,{className:"w-5 h-5 text-primary-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Transition Assessment"}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[c.transitionSummary.scoredItems,"/",c.transitionSummary.totalItems," items scored"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:(0,u.W)("text-2xl font-bold",c.transitionSummary.percentage>=80?"text-success-600":c.transitionSummary.percentage>=60?"text-warning-600":"text-error-600"),children:[c.transitionSummary.percentage,"%"]}),(0,a.jsx)("span",{className:(0,u.W)("px-3 py-1 rounded-full text-sm font-bold",g(c.transitionSummary.readinessLevel).color),children:g(c.transitionSummary.readinessLevel).label})]})]})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors",children:"Close"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{let e="/reports/evaluation/?type=vbmapp&id=".concat(i,"&clientId=").concat(l);window.open(e,"_blank")},className:"px-4 py-2 rounded-lg text-sm font-bold bg-primary-600 hover:bg-primary-700 text-white transition-all flex items-center gap-2 shadow-lg shadow-primary-600/20",children:[(0,a.jsx)(eZ.Z,{className:"w-4 h-4"}),"View Clinical Report"]}),o&&(0,a.jsxs)("button",{onClick:o,className:"px-4 py-2 rounded-lg text-sm font-medium border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex items-center gap-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),"Start Re-evaluation"]})]})]})]})]})}function e3(e){let{client:t}=e,[r,l]=(0,s.useState)("ablls"),[n,i]=(0,s.useState)("list"),[d,o]=(0,s.useState)({type:"none"}),{evaluations:c}=(0,B.F3)(t.id),[x,m]=(0,s.useState)({type:"none"}),{evaluations:h}=(0,eq.Dy)(t.id),p=c.filter(e=>"completed"===e.status).length;h.filter(e=>"completed"===e.status).length;let g=()=>c.find(e=>"completed"===e.status),b=()=>h.find(e=>"completed"===e.status);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsxs)("button",{onClick:()=>l("ablls"),className:(0,u.W)("px-4 py-2 text-sm font-medium transition-colors relative","ablls"===r?"text-primary-600 dark:text-primary-400":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:["ABLLS-R","ablls"===r&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"})]}),(0,a.jsxs)("button",{onClick:()=>l("vbmapp"),className:(0,u.W)("px-4 py-2 text-sm font-medium transition-colors relative","vbmapp"===r?"text-purple-600 dark:text-purple-400":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:["VB-MAPP","vbmapp"===r&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-purple-500"})]})]}),"ablls"===r&&(0,a.jsxs)("div",{className:"flex items-center bg-neutral-100 dark:bg-neutral-800 rounded-xl p-1",children:[(0,a.jsxs)("button",{onClick:()=>i("list"),className:(0,u.W)("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors","list"===n?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(L.Z,{className:"w-4 h-4"}),"Evaluations"]}),(0,a.jsxs)("button",{onClick:()=>i("progress"),className:(0,u.W)("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors","progress"===n?"bg-white dark:bg-neutral-700 text-neutral-900 dark:text-white shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,a.jsx)(ep.Z,{className:"w-4 h-4"}),"Progress",p>=2&&(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 text-xs rounded-full",children:p})]})]})]}),"ablls"===r&&(0,a.jsxs)(a.Fragment,{children:["list"===n?(0,a.jsx)(eg,{clientId:t.id,clientName:t.name,onStartNew:()=>{o({type:"wizard",previousEvaluation:g()||void 0})},onContinue:e=>{o({type:"wizard",evaluationId:e})},onView:e=>{let t=c.findIndex(t=>t.id===e);o({type:"summary",evaluationId:e,previousEvaluation:c.slice(t+1).find(e=>"completed"===e.status)})},onReEvaluate:e=>{o({type:"wizard",previousEvaluation:e})}}):(0,a.jsx)(eJ,{evaluations:c,clientName:t.name}),(0,a.jsx)(ew,{isOpen:"wizard"===d.type,onClose:()=>o({type:"none"}),clientId:t.id,clientName:t.name,evaluationId:"wizard"===d.type?d.evaluationId:void 0,previousEvaluation:"wizard"===d.type?d.previousEvaluation:void 0}),"summary"===d.type&&(0,a.jsx)(eT,{isOpen:!0,onClose:()=>o({type:"none"}),clientId:t.id,clientData:t,evaluationId:d.evaluationId,previousEvaluation:d.previousEvaluation,onReEvaluate:()=>{if("summary"===d.type){let e=c.find(e=>e.id===d.evaluationId);e&&o({type:"wizard",previousEvaluation:e})}}})]}),"vbmapp"===r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eY,{clientId:t.id,clientName:t.name,onStartNew:()=>{m({type:"wizard",previousEvaluation:b()||void 0})},onContinue:e=>{m({type:"wizard",evaluationId:e})},onView:e=>{let t=h.findIndex(t=>t.id===e);m({type:"summary",evaluationId:e,previousEvaluation:h.slice(t+1).find(e=>"completed"===e.status)})},onReEvaluate:e=>{m({type:"wizard",previousEvaluation:e})}}),(0,a.jsx)(e1,{isOpen:"wizard"===x.type,onClose:()=>m({type:"none"}),clientId:t.id,clientName:t.name,evaluationId:"wizard"===x.type?x.evaluationId:void 0,previousEvaluation:"wizard"===x.type?x.previousEvaluation:void 0}),"summary"===x.type&&(0,a.jsx)(e4,{isOpen:!0,onClose:()=>m({type:"none"}),clientId:t.id,clientData:t,evaluationId:x.evaluationId,previousEvaluation:x.previousEvaluation,onReEvaluate:()=>{if("summary"===x.type){let e=h.find(e=>e.id===x.evaluationId);e&&m({type:"wizard",previousEvaluation:e})}}})]})]})}function e6(e){let{isOpen:t,onClose:r,client:l}=e,{success:n,error:i}=(0,p.useToast)(),{user:d}=(0,h.useAuth)(),{data:o}=(0,M.lU)(),[c,x]=(0,s.useState)(!1),[m,u]=(0,s.useState)({name:"",birthDate:"",diagnosisDate:"",primaryDiagnosis:"",diagnosisLevel:"1",phone:"",parentName:"",parentEmail:"",medicalInfo:"",assignedTherapistId:""});(0,s.useEffect)(()=>{if(l&&t){var e;u({name:l.name||"",birthDate:l.birthDate||"",diagnosisDate:l.diagnosisDate||"",primaryDiagnosis:l.primaryDiagnosis||"",diagnosisLevel:(null===(e=l.diagnosisLevel)||void 0===e?void 0:e.toString())||"1",phone:l.phone||"",parentName:l.parentName||"",parentEmail:l.parentEmail||"",medicalInfo:l.medicalInfo||"",assignedTherapistId:l.assignedTherapistId||""})}},[l,t]);let v=async e=>{e.preventDefault(),x(!0);try{let e=(0,b.JU)(g.db,"clients",l.id),t={name:m.name,birthDate:m.birthDate||null,diagnosisDate:m.diagnosisDate||null,primaryDiagnosis:m.primaryDiagnosis,diagnosisLevel:parseInt(m.diagnosisLevel),phone:m.phone,parentName:m.parentName,parentEmail:m.parentEmail,medicalInfo:m.medicalInfo,assignedTherapistId:m.assignedTherapistId};await (0,b.r7)(e,t),n("Profile updated successfully"),m.assignedTherapistId&&m.assignedTherapistId!==l.assignedTherapistId&&d&&(0,ex.Wg)(m.assignedTherapistId,{clientId:l.id,clientName:m.name,triggeredByUserId:d.uid}).catch(e=>console.error("Failed to send assignment notification:",e)),r()}catch(e){console.error(e),i("Failed to update profile")}finally{x(!1)}};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative w-full max-w-lg bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between bg-neutral-50 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 text-primary-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(ej.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Edit Profile"}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:["Update information for ",null==l?void 0:l.name]})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-2 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-800",children:(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-neutral-500"})})]}),(0,a.jsxs)("form",{onSubmit:v,className:"flex-1 overflow-y-auto p-6 space-y-5",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Child Name"}),(0,a.jsx)("input",{type:"text",required:!0,placeholder:"e.g. John Doe",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.name,onChange:e=>u({...m,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Birth Date"}),(0,a.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.birthDate,onChange:e=>u({...m,birthDate:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Primary Diagnosis"}),(0,a.jsx)("input",{type:"text",placeholder:"e.g. Autism Spectrum Disorder",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.primaryDiagnosis,onChange:e=>u({...m,primaryDiagnosis:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Diagnosis Date"}),(0,a.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.diagnosisDate,onChange:e=>u({...m,diagnosisDate:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Support Level (DSM-5)"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.diagnosisLevel,onChange:e=>u({...m,diagnosisLevel:e.target.value}),children:[(0,a.jsx)("option",{value:"1",children:"Level 1 (Requiring Support)"}),(0,a.jsx)("option",{value:"2",children:"Level 2 (Substantial Support)"}),(0,a.jsx)("option",{value:"3",children:"Level 3 (Very Substantial Support)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Phone Number ",(0,a.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,a.jsx)("input",{type:"tel",placeholder:"e.g. 0721 234 567",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.phone,onChange:e=>u({...m,phone:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Parent Name ",(0,a.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,a.jsx)("input",{type:"text",placeholder:"e.g. Robert Doe",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.parentName,onChange:e=>u({...m,parentName:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:["Parent Email ",(0,a.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,a.jsx)("input",{type:"email",placeholder:"parent@example.com",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.parentEmail,onChange:e=>u({...m,parentEmail:e.target.value})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Assigned Therapist"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 transition-colors",value:m.assignedTherapistId,onChange:e=>u({...m,assignedTherapistId:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"Select a therapist..."}),o.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1.5 text-neutral-700 dark:text-neutral-300",children:"Medical Info / Notes"}),(0,a.jsx)("textarea",{rows:3,placeholder:"Allergies, specific diagnosis notes...",className:"w-full px-3 py-2 bg-neutral-100 dark:bg-neutral-800 border-transparent rounded-lg focus:ring-2 focus:ring-primary-500 resize-none transition-colors",value:m.medicalInfo,onChange:e=>u({...m,medicalInfo:e.target.value})})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 py-2.5 border border-neutral-200 dark:border-neutral-700 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 font-bold transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"flex-1 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold transition-all flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:c?(0,a.jsx)(S.Z,{className:"w-4 h-4 animate-spin"}):"Save Changes"})]})]})]})]}):null}function e8(){let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),r=e.get("id"),i=e.get("tab"),d=e.get("action"),{data:o,loading:c,error:x}=(0,n.m)(r||""),[m,u]=(0,s.useState)(i||"overview"),[h,p]=(0,s.useState)(!1),[g,b]=(0,s.useState)(d);return((0,s.useEffect)(()=>{i&&["overview","programs","plan","evaluations","docs"].includes(i)&&u(i)},[i]),(0,s.useEffect)(()=>{if(d){b(d);let e="/clients/profile?id=".concat(r).concat(i?"&tab=".concat(i):"");t.replace(e,{scroll:!1})}},[d,r,i,t]),r)?c?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)(S.Z,{className:"w-10 h-10 animate-spin text-primary-500"})}):x||!o?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[80vh] text-center p-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-error-50 dark:bg-error-900/20 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(ev.Z,{className:"w-8 h-8 text-error-500"})}),(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Client not found"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-2",children:"The client you are looking for doesn't exist or has been removed."}),(0,a.jsx)("a",{href:"/clients",className:"mt-6 px-6 py-2 bg-primary-600 text-white rounded-xl font-bold hover:bg-primary-700 transition-colors",children:"Back to Client List"})]}):(0,a.jsxs)("div",{className:"flex-1 p-6 space-y-8 max-w-7xl mx-auto w-full",children:[(0,a.jsx)(j,{client:o,activeTab:m,onTabChange:u,onEdit:()=>p(!0)}),(0,a.jsxs)("div",{className:"pt-2",children:["overview"===m&&(0,a.jsx)(U,{client:o,pendingAction:g,onActionHandled:()=>b(null)}),"programs"===m&&(0,a.jsx)(V,{client:o}),"plan"===m&&(0,a.jsx)(X,{client:o,pendingAction:g,onActionHandled:()=>b(null)}),"docs"===m&&(0,a.jsx)(eh,{client:o}),"evaluations"===m&&(0,a.jsx)(e3,{client:o}),!["overview","programs","plan","docs","evaluations"].includes(m)&&(0,a.jsxs)("div",{className:"py-20 text-center bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white capitalize",children:[m," Section"]}),(0,a.jsx)("p",{className:"text-neutral-500 mt-1",children:"This section is currently under development."})]})]}),(0,a.jsx)(e6,{isOpen:h,onClose:()=>p(!1),client:o})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[80vh] text-center p-6",children:[(0,a.jsx)(ev.Z,{className:"w-12 h-12 text-error-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Invalid Request"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-2",children:"No client ID provided."})]})}function e9(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)(S.Z,{className:"w-10 h-10 animate-spin text-primary-500"})}),children:(0,a.jsx)(e8,{})})}},80822:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var a=r(3827),s=r(64090),l=r(75504),n=r(3224);let i=["MAND","TACT","LR","VP-MTS","PLAY","SOCIAL","IMITATION","ECHOIC","EESA","LRFFC","IV","GROUP","LING","READING","WRITING","MATH"];function d(e){let{evaluation:t,previousEvaluation:r,compact:d=!1}=e,o=(0,s.useMemo)(()=>{let e={};return i.forEach(t=>{e[t]={level1:[],level2:[],level3:[]}}),n.wB.forEach(r=>{e[r.code]&&r.items.forEach(a=>{var s;let l=null===(s=t.milestoneScores[a.id])||void 0===s?void 0:s.score;e[r.code].level1.push(null!=l?l:null)})}),n.H3.forEach(r=>{e[r.code]&&r.items.forEach(a=>{var s;let l=null===(s=t.milestoneScores[a.id])||void 0===s?void 0:s.score;e[r.code].level2.push(null!=l?l:null)})}),n.PW.forEach(r=>{e[r.code]&&r.items.forEach(a=>{var s;let l=null===(s=t.milestoneScores[a.id])||void 0===s?void 0:s.score;e[r.code].level3.push(null!=l?l:null)})}),e},[t]),c=e=>null===e?"bg-neutral-100 dark:bg-neutral-800":0===e?"bg-neutral-200 dark:bg-neutral-700":.5===e?"bg-warning-400":"bg-success-500",x=d?"w-4 h-4":"w-6 h-6",m=d?"text-[8px]":"text-[10px]";return(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("div",{className:"min-w-max",children:[(0,a.jsxs)("div",{className:"flex items-end gap-1 mb-2",children:[(0,a.jsx)("div",{className:(0,l.W)("w-16 flex-shrink-0",m,"font-bold text-neutral-500")}),(0,a.jsxs)("div",{className:"flex gap-px",children:[(0,a.jsx)("div",{className:(0,l.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:[1,2,3,4,5].map(e=>(0,a.jsx)("div",{className:(0,l.W)(x,"flex items-end justify-center",m,"text-neutral-400"),children:e},"l1-".concat(e)))}),(0,a.jsx)("div",{className:(0,l.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:[6,7,8,9,10].map(e=>(0,a.jsx)("div",{className:(0,l.W)(x,"flex items-end justify-center",m,"text-neutral-400"),children:e},"l2-".concat(e)))}),(0,a.jsx)("div",{className:"flex gap-px",children:[11,12,13,14,15].map(e=>(0,a.jsx)("div",{className:(0,l.W)(x,"flex items-end justify-center",m,"text-neutral-400"),children:e},"l3-".concat(e)))})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,a.jsx)("div",{className:(0,l.W)("w-16 flex-shrink-0",m,"font-bold text-neutral-500")}),(0,a.jsxs)("div",{className:"flex gap-px",children:[(0,a.jsx)("div",{className:(0,l.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:(0,a.jsx)("div",{className:(0,l.W)("flex items-center justify-center bg-indigo-100 dark:bg-indigo-900/30 rounded px-2 py-0.5",m,"font-bold text-indigo-600 dark:text-indigo-400"),style:{width:d?88:134},children:"Level 1"})}),(0,a.jsx)("div",{className:(0,l.W)("flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1"),children:(0,a.jsx)("div",{className:(0,l.W)("flex items-center justify-center bg-purple-100 dark:bg-purple-900/30 rounded px-2 py-0.5",m,"font-bold text-purple-600 dark:text-purple-400"),style:{width:d?88:134},children:"Level 2"})}),(0,a.jsx)("div",{className:"flex gap-px",children:(0,a.jsx)("div",{className:(0,l.W)("flex items-center justify-center bg-pink-100 dark:bg-pink-900/30 rounded px-2 py-0.5",m,"font-bold text-pink-600 dark:text-pink-400"),style:{width:d?88:134},children:"Level 3"})})]})]}),(0,a.jsx)("div",{className:"space-y-1",children:i.map(e=>{let t=o[e];if(!t)return null;let r=t.level1.length>0,s=t.level2.length>0,n=t.level3.length>0;return r||s||n?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,l.W)("w-16 flex-shrink-0 text-right pr-2",m,"font-bold text-neutral-700 dark:text-neutral-300"),children:e}),(0,a.jsxs)("div",{className:"flex gap-px",children:[(0,a.jsx)("div",{className:"flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1",children:[0,1,2,3,4].map(r=>{let s=t.level1[r],n=r<t.level1.length;return(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm transition-colors",n?c(s):"bg-neutral-50 dark:bg-neutral-900"),title:n?"".concat(e," ").concat(r+1,": ").concat(null!=s?s:"Not scored"):void 0},"".concat(e,"-l1-").concat(r))})}),(0,a.jsx)("div",{className:"flex gap-px border-r border-neutral-300 dark:border-neutral-600 pr-1 mr-1",children:[0,1,2,3,4].map(r=>{let s=t.level2[r],n=r<t.level2.length;return(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm transition-colors",n?c(s):"bg-neutral-50 dark:bg-neutral-900"),title:n?"".concat(e," ").concat(r+6,": ").concat(null!=s?s:"Not scored"):void 0},"".concat(e,"-l2-").concat(r))})}),(0,a.jsx)("div",{className:"flex gap-px",children:[0,1,2,3,4].map(r=>{let s=t.level3[r],n=r<t.level3.length;return(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm transition-colors",n?c(s):"bg-neutral-50 dark:bg-neutral-900"),title:n?"".concat(e," ").concat(r+11,": ").concat(null!=s?s:"Not scored"):void 0},"".concat(e,"-l3-").concat(r))})})]})]},e):null})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("span",{className:(0,l.W)(m,"text-neutral-500 font-medium"),children:"Legend:"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm bg-neutral-200 dark:bg-neutral-700")}),(0,a.jsx)("span",{className:(0,l.W)(m,"text-neutral-500"),children:"0 - Not present"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm bg-warning-400")}),(0,a.jsx)("span",{className:(0,l.W)(m,"text-neutral-500"),children:"\xbd - Emerging"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm bg-success-500")}),(0,a.jsx)("span",{className:(0,l.W)(m,"text-neutral-500"),children:"1 - Mastered"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:(0,l.W)(x,"rounded-sm bg-neutral-100 dark:bg-neutral-800")}),(0,a.jsx)("span",{className:(0,l.W)(m,"text-neutral-500"),children:"Not scored"})]})]})]})})}}},function(e){e.O(0,[4358,139,5050,8234,901,1482,223,3676,5391,4039,1678,819,3311,9769,2971,8069,1744],function(){return e(e.s=26427)}),_N_E=e.O()}]);