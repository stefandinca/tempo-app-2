(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9302],{66742:function(e,t,r){Promise.resolve().then(r.bind(r,92515))},92515:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var a=r(3827),n=r(77819),s=r(81433),l=r(38333),i=r(23356),d=r(22983),c=r(96528),o=r(47626);function u(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-900 dark:text-white mb-6",children:"Session Volume (Current Month)"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(s.v,{data:t,children:[(0,a.jsx)(l.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#E5E7EB"}),(0,a.jsx)(i.K,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12},dy:10}),(0,a.jsx)(d.B,{axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12}}),(0,a.jsx)(c.u,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,a.jsx)(o.$Q,{dataKey:"sessions",fill:"#4A90E2",radius:[4,4,0,0],barSize:32})]})})})]})}var x=r(66363),h=r(2838);function m(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-900 dark:text-white mb-6",children:"Attendance Trend (Current Month)"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(x.w,{data:t,children:[(0,a.jsx)(l.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#E5E7EB"}),(0,a.jsx)(i.K,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12},dy:10}),(0,a.jsx)(d.B,{axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12},domain:[0,100]}),(0,a.jsx)(c.u,{formatter:e=>"".concat(e,"%"),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,a.jsx)(h.x1,{type:"monotone",dataKey:"rate",stroke:"#10B981",strokeWidth:3,dot:{fill:"#10B981",strokeWidth:2,r:4,stroke:"#fff"},activeDot:{r:6}})]})})})]})}var f=r(23168),g=r(48713),b=r(74994),p=r(6541);function j(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-900 dark:text-white mb-6",children:"Revenue Mix"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(f.u,{children:[(0,a.jsx)(g.by,{data:t,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:t.map((e,t)=>(0,a.jsx)(b.b,{fill:e.color,stroke:"none"},"cell-".concat(t)))}),(0,a.jsx)(c.u,{formatter:e=>"$".concat(null==e?void 0:e.toLocaleString()),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,a.jsx)(p.D,{verticalAlign:"bottom",height:36,iconType:"circle"})]})})})]})}var v=r(75504);function k(e){let{data:t}=e,r=[...t].sort((e,t)=>{let r=e.billable/e.capacity||0;return(t.billable/t.capacity||0)-r});return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm flex flex-col h-full max-h-[400px]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 flex-shrink-0",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-900 dark:text-white",children:"Therapist Utilization"}),(0,a.jsx)("span",{className:"text-xs font-medium text-neutral-500 bg-neutral-100 dark:bg-neutral-800 px-2 py-1 rounded-full",children:"Weekly Hours"})]}),(0,a.jsxs)("div",{className:"overflow-y-auto pr-2 space-y-4 flex-1 custom-scrollbar",children:[r.map((e,t)=>{let r=Math.min(100,Math.round(e.billable/e.capacity*100))||0,n="bg-primary-500";return n=r>90?"bg-error-500":r<50?"bg-warning-500":"bg-success-500",(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-neutral-700 dark:text-neutral-300 truncate max-w-[150px]",title:e.name,children:e.name}),(0,a.jsxs)("span",{className:"text-neutral-500 dark:text-neutral-400 font-mono text-xs",children:[e.billable," / ",e.capacity," hrs"]})]}),(0,a.jsx)("div",{className:"h-2.5 w-full bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:(0,v.W)("h-full rounded-full transition-all duration-500",n),style:{width:"".concat(r,"%")}})})]},t)}),0===r.length&&(0,a.jsx)("div",{className:"text-center py-8 text-neutral-400 text-sm",children:"No utilization data available."})]})]})}function N(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-900 dark:text-white",children:"Clinical Progress Index"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Global Goal Achievement Rate (%)"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-success-600 dark:text-success-400",children:t.length>0?"".concat(t[t.length-1].rate,"%"):"0%"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"+3% vs last month"})]})]}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(x.w,{data:t,children:[(0,a.jsx)(l.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#E5E7EB"}),(0,a.jsx)(i.K,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12},dy:10}),(0,a.jsx)(d.B,{axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12},domain:[50,100]}),(0,a.jsx)(c.u,{formatter:e=>"".concat(e,"%"),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,a.jsx)(h.x1,{type:"monotone",dataKey:"rate",stroke:"#8B5CF6",strokeWidth:3,dot:{fill:"#8B5CF6",strokeWidth:2,r:4,stroke:"#fff"},activeDot:{r:6}})]})})})]})}var w=r(61524);function y(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-error-50 dark:bg-error-900/20 rounded-lg text-error-600 dark:text-error-400",children:(0,a.jsx)(w.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-900 dark:text-white",children:"Cancellation Risk Radar"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Clients with multiple cancellations this month"})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===t.length?(0,a.jsx)("div",{className:"text-center py-8 text-neutral-500 text-sm",children:"No high-risk clients detected. Great job!"}):t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl border border-neutral-100 dark:border-neutral-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-error-100 dark:bg-error-900/30 flex items-center justify-center text-error-700 dark:text-error-400 font-bold text-xs",children:e.name.substring(0,2).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-sm text-neutral-900 dark:text-white",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-error-600 dark:text-error-400 font-medium",children:[e.cancellations," Cancellations"]})]})]}),(0,a.jsx)("div",{className:"px-2 py-1 bg-white dark:bg-neutral-900 rounded-md border border-neutral-200 dark:border-neutral-700 text-xs font-bold text-neutral-600 dark:text-neutral-400",children:"Action Required"})]},e.id))})]})}var S=r(64090),E=r(2335);let D=[{month:"Jan",rate:65},{month:"Feb",rate:68},{month:"Mar",rate:72},{month:"Apr",rate:70},{month:"May",rate:75},{month:"Jun",rate:78}];var B=r(18994),I=r(29733),C=r(10775);function L(){let[e]=(0,S.useState)(new Date),{data:t,loading:r}=function(e,t){let{data:r,loading:a}=(0,E.Nx)(e,t),{data:n,loading:s}=(0,E.bI)(e,t),{data:l,loading:i}=(0,E.av)(),{data:d,loading:c}=(0,E.lU)(),{data:o,loading:u}=(0,E.Su)();return{data:(0,S.useMemo)(()=>{if(a||s||i||c||u)return null;let e=r.length,t=r.filter(e=>"completed"===e.status||"confirmed"===e.status).length,x=n.reduce((e,t)=>e+(t.total||0),0);l.filter(e=>"inactive"!==e.status).length;let h=new Date,m=r.filter(e=>new Date(e.startTime)>h&&("scheduled"===e.status||"confirmed"===e.status)),f=0;n.forEach(e=>{f+=Array.isArray(e.items)?e.items.length:1});let g=f>0?x/f:0,b=m.length*g,p={};r.forEach(e=>{"cancelled"===e.status&&e.clientId&&(p[e.clientId]=(p[e.clientId]||0)+1)});let j=Object.entries(p).filter(e=>{let[t,r]=e;return r>=2}).map(e=>{let[t,r]=e,a=l.find(e=>e.id===t);return{id:t,name:(null==a?void 0:a.name)||"Unknown Client",cancellations:r,trend:"high"}}).sort((e,t)=>t.cancellations-e.cancellations).slice(0,5),v=[0,0,0,0];r.forEach(e=>{let t=new Date(e.startTime).getDate();v[Math.min(Math.floor((t-1)/7),3)]++});let k=[{name:"Week 1",sessions:v[0]},{name:"Week 2",sessions:v[1]},{name:"Week 3",sessions:v[2]},{name:"Week 4",sessions:v[3]}],N={};n.forEach(e=>{let t=e=>{if(!e)return"Other";let t=e.toLowerCase(),r=o.find(e=>e.name&&t.includes(e.name.toLowerCase()));return r?r.name:t.includes("aba")||t.includes("autism")||t.includes("terapie")?"ABA / Therapy":t.includes("speech")||t.includes("logoped")||t.includes("limbaj")?"Speech / Logopedie":t.includes("eval")||t.includes("assess")?"Assessment":t.includes("group")||t.includes("grup")||t.includes("social")?"Social Group":t.includes("parent")||t.includes("parinte")||t.includes("consiliere")?"Parent Counseling":"Other"};if(Array.isArray(e.items))e.items.forEach(e=>{let r=t(e.description);N[r]=(N[r]||0)+(e.amount||0)});else{let r=t(e.serviceName||"");N[r]=(N[r]||0)+(e.total||0)}});let w=["#4A90E2","#8B5CF6","#F59E0B","#10B981","#EF4444"],y=Object.entries(N).map((e,t)=>{let[r,a]=e;return{name:r,value:a,color:w[t%w.length]}}),S=d.map(e=>{let t=r.filter(t=>t.therapistId===e.id).length;return{name:e.name,billable:t,capacity:e.weeklyCapacity||40}});return{kpis:[{label:"Monthly Sessions",value:e.toLocaleString(),change:"+0%",trend:"up"},{label:"Completion Rate",value:"".concat((e>0?t/e*100:0).toFixed(1),"%"),change:"+0%",trend:"up"},{label:"Monthly Revenue",value:"$".concat((x/1e3).toFixed(1),"k"),change:"+0%",trend:"up"},{label:"Projected Revenue",value:"$".concat(((x+b)/1e3).toFixed(1),"k"),change:"Forecast",trend:"up"}],sessionChartData:k,revenueMixData:y,teamUtilizationData:S,attendanceData:[{name:"W1",rate:90},{name:"W2",rate:92},{name:"W3",rate:88},{name:"W4",rate:95}],clinicalData:D,predictive:{highRiskClients:j}}},[r,n,l,d,o,a,s,i,c,u]),loading:a||s||i||c||u}}(e.getFullYear(),e.getMonth());return r?(0,a.jsx)("div",{className:"flex-1 p-6 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 text-neutral-500",children:[(0,a.jsx)(B.Z,{className:"w-8 h-8 animate-spin"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"Loading analytics..."})]})}):t?(0,a.jsxs)("div",{className:"flex-1 p-6 space-y-8 animate-in fade-in duration-500",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:t.kpis.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 p-6 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-500 dark:text-neutral-400",children:e.label}),(0,a.jsxs)("div",{className:"flex items-baseline justify-between mt-2",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:e.value}),(0,a.jsxs)("div",{className:(0,v.W)("flex items-center gap-1 text-xs font-bold px-2 py-1 rounded-full","up"===e.trend?"bg-success-50 text-success-600 dark:bg-success-900/20":"bg-error-50 text-error-600 dark:bg-error-900/20"),children:["up"===e.trend?(0,a.jsx)(I.Z,{className:"w-3 h-3"}):(0,a.jsx)(C.Z,{className:"w-3 h-3"}),e.change]})]})]},t))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(u,{data:t.sessionChartData})}),(0,a.jsx)("div",{children:(0,a.jsx)(j,{data:t.revenueMixData})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(y,{data:t.predictive.highRiskClients}),(0,a.jsx)(N,{data:t.clinicalData})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(k,{data:t.teamUtilizationData}),(0,a.jsx)(m,{data:t.attendanceData})]})]}):null}},2335:function(e,t,r){"use strict";r.d(t,{HX:function(){return f},Nx:function(){return h},Rn:function(){return m},Su:function(){return o},av:function(){return d},b$:function(){return u},bI:function(){return b},gV:function(){return p},hI:function(){return i},lU:function(){return c},we:function(){return x},wm:function(){return g}});var a=r(64090),n=r(58121),s=r(1221);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[r,l]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{d(!0);let r=(0,n.IO)((0,n.hJ)(s.db,e),...t),a=(0,n.cf)(r,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),l(t),d(!1)},t=>{console.error("Error fetching ".concat(e,":"),t),o(t.message),d(!1)});return()=>a()},[e]),{data:r,loading:i,error:c}}function i(){return l("events")}function d(){return l("clients")}function c(){return l("team_members")}function o(){return l("services")}function u(){return l("programs")}function x(e){let[t,r]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e){i(!1);return}let t=(0,n.IO)((0,n.hJ)(s.db,"events"),(0,n.ar)("clientId","==",e),(0,n.Xo)("startTime","asc")),a=(0,n.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),r(t),i(!1)},e=>{console.error("Error fetching client events:",e),c(e.message),i(!1)});return()=>a()},[e]),{data:t,loading:l,error:d}}function h(e,t){let[r,l]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let r=new Date(e,t,1),a=new Date(e,t+1,0,23,59,59,999),i=(0,n.IO)((0,n.hJ)(s.db,"events"),(0,n.ar)("startTime",">=",r.toISOString()),(0,n.ar)("startTime","<=",a.toISOString()),(0,n.Xo)("startTime","asc")),c=(0,n.cf)(i,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),l(t),d(!1)},e=>{console.error("Error fetching events by month:",e),o(e.message),d(!1)});return()=>c()},[e,t]),{data:r,loading:i,error:c}}function m(e){let[t,r]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!e){r([]),i(!1);return}let t=(0,n.IO)((0,n.hJ)(s.db,"clients",e,"interventionPlans"),(0,n.Xo)("createdAt","desc")),a=(0,n.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),r(t),i(!1)},e=>{console.error("Error fetching intervention plans:",e),c(e.message),i(!1)});return()=>a()},[e]);let o=t.find(e=>"active"===e.status)||null;return{data:t,loading:l,error:d,activePlan:o,getActivePlanForDate:e=>t.find(t=>{if("active"!==t.status)return!1;let r=new Date(t.startDate),a=new Date(t.endDate);return a.setHours(23,59,59,999),e>=r&&e<=a})||null}}function f(){let[e,t]=(0,a.useState)(null),[r,l]=(0,a.useState)(!0),[i,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=(0,n.cf)((0,n.JU)(s.db,"system_settings","config"),e=>{e.exists()?t(e.data()):t(null),l(!1)},e=>{console.error("Error fetching system settings:",e),d(e.message),l(!1)});return()=>e()},[]),{data:e,loading:r,error:i}}function g(e){let[t,r]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e){i(!1);return}let t=(0,n.IO)((0,n.hJ)(s.db,"invoices"),(0,n.ar)("clientId","==",e),(0,n.Xo)("date","desc")),a=(0,n.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),r(t),i(!1)},e=>{console.error("Error fetching client invoices:",e),c(e.message),i(!1)});return()=>a()},[e]),{data:t,loading:l,error:d}}function b(e,t){let[r,l]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let r="".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-01"),a="".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-31"),i=(0,n.IO)((0,n.hJ)(s.db,"invoices"),(0,n.ar)("date",">=",r),(0,n.ar)("date","<=",a),(0,n.Xo)("date","desc")),c=(0,n.cf)(i,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),l(t),d(!1)},e=>{console.error("Error fetching monthly invoices:",e),o(e.message),d(!1)});return()=>c()},[e,t]),{data:r,loading:i,error:c}}function p(e,t){let[r,l]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let r="".concat(e,"-").concat(String(t+1).padStart(2,"0")),a=(0,n.IO)((0,n.hJ)(s.db,"payouts"),(0,n.ar)("month","==",r)),i=(0,n.cf)(a,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),l(t),d(!1)},e=>{console.error("Error fetching monthly payouts:",e),o(e.message),d(!1)});return()=>i()},[e,t]),{data:r,loading:i,error:c}}},1221:function(e,t,r){"use strict";r.d(t,{Fw:function(){return x},I8:function(){return c},db:function(){return o},tO:function(){return u}});var a=r(26142),n=r(27065),s=r(58121),l=r(24905),i=r(76079);let d=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyBLyN1jo8PpJ5OMtkEuC4auhuuviapB3Bs",authDomain:"tempo-app-2.firebaseapp.com",projectId:"tempo-app-2",storageBucket:"tempo-app-2.firebasestorage.app",messagingSenderId:"47813899076",appId:"1:47813899076:web:cd597912a0755195241d11"}):(0,a.C6)()[0],c=(0,n.v0)(d),o=(0,s.ad)(d),u=(0,l.cF)(d),x=(0,i.KL)(d)}},function(e){e.O(0,[4358,139,5233,2616,2971,8069,1744],function(){return e(e.s=66742)}),_N_E=e.O()}]);