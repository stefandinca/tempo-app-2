(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3643],{74030:function(e,t,r){Promise.resolve().then(r.bind(r,7186))},98998:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},44715:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},69475:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3428:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])},61172:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},65561:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},77329:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]])},80031:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]])},66912:function(e,t,r){"use strict";r.d(t,{Ej:function(){return d},tM:function(){return p},tu:function(){return u}});var a=r(3827),n=r(64090),l=r(1221),s=r(58121),i=r(18994),o=r(98998),c=r(10207);function d(){let{isAuthenticated:e,clientId:t,loading:r}=(0,c.jT)(),[a,i]=(0,n.useState)(null),[o,d]=(0,n.useState)([]),[u,p]=(0,n.useState)([]),[h,m]=(0,n.useState)([]),[x,f]=(0,n.useState)([]),[g,y]=(0,n.useState)(!0),[b,k]=(0,n.useState)(null);return(0,n.useEffect)(()=>{r&&y(!0)},[r]),(0,n.useEffect)(()=>{if(r)return;if(!e||!t){y(!1);return}y(!0),k(null);let a=(0,s.hJ)(l.db,"clients"),n=(0,s.IO)(a,(0,s.ar)("__name__","==",t)),o=null,c=null,u=null,h=null,x=(0,s.cf)(n,e=>{if(e.empty){k("Portal session invalid or expired."),y(!1);return}let r=e.docs[0];i({id:r.id,...r.data()}),o&&o();let a=(0,s.IO)((0,s.hJ)(l.db,"events"),(0,s.ar)("clientId","==",t),(0,s.Xo)("startTime","asc"));o=(0,s.cf)(a,e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),d(t)},e=>{console.error("Sessions fetch error:",e)}),c&&c(),c=(0,s.cf)((0,s.hJ)(l.db,"services"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),p(t)}),u&&u(),u=(0,s.cf)((0,s.hJ)(l.db,"programs"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),m(t)}),h&&h();let n=(0,s.IO)((0,s.hJ)(l.db,"clients",t,"evaluations"),(0,s.ar)("status","==","completed")),x=(0,s.IO)((0,s.hJ)(l.db,"clients",t,"vbmapp_evaluations"),(0,s.ar)("status","==","completed")),g=[],b=[],v=()=>{f([...g,...b].sort((e,t)=>{let r=new Date(e.completedAt||e.createdAt).getTime();return new Date(t.completedAt||t.createdAt).getTime()-r})),y(!1)};h=(0,s.cf)(n,e=>{g=e.docs.map(e=>({id:e.id,...e.data()})),v()}),(0,s.cf)(x,e=>{b=e.docs.map(e=>({id:e.id,...e.data()})),v()})},e=>{console.error("Client fetch error:",e),k(e.message),y(!1)});return()=>{x(),o&&o(),c&&c(),u&&u(),h&&h()}},[e,t,r]),{data:a,sessions:o,services:u,programs:h,evaluations:x,loading:g,error:b}}function u(){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,a.jsx)(i.Z,{className:"w-10 h-10 animate-spin mb-4"}),(0,a.jsx)("p",{children:"Loading your portal..."})]})}function p(e){let{message:t}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center px-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-error-50 dark:bg-error-900/20 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(o.Z,{className:"w-8 h-8 text-error-500"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Access Error"}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm mt-1 max-w-xs mx-auto",children:t}),(0,a.jsx)("a",{href:"/parent",className:"mt-6 text-primary-600 font-bold hover:underline",children:"Back to Login"})]})}},7186:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var a=r(3827),n=r(64090),l=r(69475),s=r(65561),i=r(80031),o=r(77329),c=r(3428),d=r(18994),u=r(61172),p=r(44715),h=r(66912),m=r(1221),x=r(58121),f=r(75504),g=r(12535);let y=[{id:"assessment",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},{id:"report",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},{id:"consent",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"},{id:"other",color:"bg-neutral-100 text-neutral-700 dark:bg-neutral-800 dark:text-neutral-400"}];function b(){let{t:e,i18n:t}=(0,g.$G)(),r=t.language.startsWith("ro")?"ro-RO":"en-US",{data:b,loading:k,error:v}=(0,h.Ej)(),[j,w]=(0,n.useState)([]),[_,N]=(0,n.useState)(!0),[S,I]=(0,n.useState)("all");if((0,n.useEffect)(()=>{if(!(null==b?void 0:b.id)){N(!1);return}let e=(0,x.IO)((0,x.hJ)(m.db,"clients",b.id,"documents"),(0,x.ar)("sharedWithParent","==",!0),(0,x.Xo)("uploadedAt","desc")),t=(0,x.cf)(e,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),w(t),N(!1)},e=>{console.error("[ParentDocs] Error fetching documents:",e),N(!1)});return()=>t()},[null==b?void 0:b.id]),k)return(0,a.jsx)(h.tu,{});if(v||!b)return(0,a.jsx)(h.tM,{message:v||"Could not load documents."});let Z="all"===S?j:j.filter(e=>e.category===S);return(0,a.jsxs)("div",{className:"p-4 space-y-6 animate-in fade-in slide-in-from-right-4 duration-500 pb-24",children:[(0,a.jsxs)("header",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:e("parent_portal.docs.title")}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm",children:1===j.length?e("parent_portal.docs.subtitle_single",{name:b.name}):e("parent_portal.docs.subtitle",{count:j.length,name:b.name})})]}),j.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>I("all"),className:(0,f.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors","all"===S?"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-400":"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400"),children:e("parent_portal.docs.all")}),y.map(t=>{let r=j.filter(e=>e.category===t.id).length;return 0===r?null:(0,a.jsxs)("button",{onClick:()=>I(t.id),className:(0,f.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",S===t.id?t.color:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400"),children:[e("parent_portal.docs.categories.".concat(t.id))," (",r,")"]},t.id)})]}),_?(0,a.jsxs)("div",{className:"py-16 flex flex-col items-center justify-center",children:[(0,a.jsx)(d.Z,{className:"w-8 h-8 animate-spin text-primary-500 mb-4"}),(0,a.jsx)("p",{className:"text-neutral-500",children:e("common.loading")})]}):0===Z.length?(0,a.jsxs)("div",{className:"py-16 text-center bg-white dark:bg-neutral-900 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(u.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:0===j.length?e("parent_portal.docs.no_docs"):e("parent_portal.docs.no_matching")}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm mt-1",children:0===j.length?e("parent_portal.docs.no_docs_subtitle"):e("parent_portal.docs.no_matching_subtitle")})]}):(0,a.jsx)("div",{className:"space-y-3",children:Z.map(t=>{var n,d,u;let h=y.find(e=>e.id===t.category);return(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 p-4 shadow-sm hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-50 dark:bg-primary-900/20 rounded-xl flex items-center justify-center text-primary-500 flex-shrink-0",children:(u=t.fileType).includes("pdf")?(0,a.jsx)(l.Z,{className:"w-5 h-5"}):u.includes("image")?(0,a.jsx)(s.Z,{className:"w-5 h-5"}):u.includes("sheet")||u.includes("excel")?(0,a.jsx)(i.Z,{className:"w-5 h-5"}):u.includes("presentation")||u.includes("powerpoint")?(0,a.jsx)(o.Z,{className:"w-5 h-5"}):(0,a.jsx)(c.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,a.jsx)("h4",{className:"font-semibold text-neutral-900 dark:text-white",children:t.name}),(0,a.jsx)("span",{className:(0,f.W)("px-2 py-0.5 text-xs font-medium rounded-full",null==h?void 0:h.color),children:e("parent_portal.docs.categories.".concat(t.category))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-neutral-500 mb-2",children:[(0,a.jsx)("span",{children:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(t.fileSize)}),(0,a.jsx)("span",{children:"â€¢"}),(0,a.jsx)("span",{children:(null===(d=t.uploadedAt)||void 0===d?void 0:null===(n=d.toDate)||void 0===n?void 0:n.call(d))?new Date(t.uploadedAt.toDate()).toLocaleDateString(r,{year:"numeric",month:"long",day:"numeric"}):e("parent_portal.docs.recently_uploaded")})]}),t.description&&(0,a.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:t.description})]}),(0,a.jsxs)("a",{href:t.downloadUrl,target:"_blank",rel:"noopener noreferrer",download:t.fileName,className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors flex-shrink-0",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e("parent_portal.docs.download")})]})]})},t.id)})})]})}},10207:function(e,t,r){"use strict";r.d(t,{Sp:function(){return u},gx:function(){return c},jT:function(){return d}});var a=r(3827),n=r(64090),l=r(27065),s=r(1221),i=r(58121);let o=(0,n.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[p,h]=(0,n.useState)(null),[m,x]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,l.Aj)(s.I8,async e=>{if(null==e?void 0:e.isAnonymous){c(e);let t=localStorage.getItem("parent_client_id"),r=localStorage.getItem("parent_client_name"),a=localStorage.getItem("parent_uid");if(t){if(a!==e.uid){console.log("[ParentAuth] UID mismatch or new session. Re-registering with client...");try{let r=(0,i.JU)(s.db,"clients",t);await (0,i.r7)(r,{parentUids:(0,i.vr)(e.uid)}),console.log("[ParentAuth] Re-registered successfully."),localStorage.setItem("parent_uid",e.uid)}catch(e){console.error("[ParentAuth] Failed to re-register UID with client:",e)}}u(t),h(r)}else u(null),h(null);x(!1)}else if(localStorage.getItem("parent_client_code")&&!e){console.log("[ParentAuth] No active session, but found stored code. Auto-logging in...");try{await (0,l.XB)(s.I8);return}catch(e){console.error("[ParentAuth] Auto-login failed:",e),x(!1)}}else c(null),u(null),h(null),x(!1)});return()=>e()},[]);let f=(0,n.useCallback)(async(e,t,r)=>{try{let a=s.I8.currentUser;a&&a.isAnonymous||(a=(await (0,l.XB)(s.I8)).user);let n=(0,i.JU)(s.db,"clients",e);await (0,i.r7)(n,{parentUids:(0,i.vr)(a.uid)}),localStorage.setItem("parent_uid",a.uid),localStorage.setItem("parent_client_id",e),localStorage.setItem("parent_client_name",t),localStorage.setItem("parent_client_code",r.toUpperCase()),c(a),u(e),h(t),console.log("[ParentAuth] Successfully authenticated parent with UID:",a.uid)}catch(e){throw console.error("[ParentAuth] Error authenticating:",e),e}},[]),g=(0,n.useCallback)(async()=>{try{localStorage.removeItem("parent_uid"),localStorage.removeItem("parent_client_id"),localStorage.removeItem("parent_client_name"),localStorage.removeItem("parent_client_code"),await (0,l.w7)(s.I8),c(null),u(null),h(null)}catch(e){console.error("[ParentAuth] Error signing out:",e)}},[]);return(0,a.jsx)(o.Provider,{value:{user:r,clientId:d,clientName:p,loading:m,isAuthenticated:null!==r&&null!==d,authenticateWithCode:f,signOut:g},children:t})}function d(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useParentAuth must be used within ParentAuthProvider");return e}function u(){return(0,n.useContext)(o)}},1221:function(e,t,r){"use strict";r.d(t,{Fw:function(){return p},I8:function(){return c},db:function(){return d},tO:function(){return u}});var a=r(26142),n=r(27065),l=r(58121),s=r(24905),i=r(76079);let o=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyBLyN1jo8PpJ5OMtkEuC4auhuuviapB3Bs",authDomain:"tempo-app-2.firebaseapp.com",projectId:"tempo-app-2",storageBucket:"tempo-app-2.firebasestorage.app",messagingSenderId:"47813899076",appId:"1:47813899076:web:cd597912a0755195241d11"}):(0,a.C6)()[0],c=(0,n.v0)(o),d=(0,l.ad)(o),u=(0,s.cF)(o),p=(0,i.KL)(o)}},function(e){e.O(0,[4358,139,5050,8234,2971,8069,1744],function(){return e(e.s=74030)}),_N_E=e.O()}]);