(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3643],{74030:function(e,t,r){Promise.resolve().then(r.bind(r,7186))},98998:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},44715:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},69475:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3428:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])},61172:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},65561:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},18994:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},77329:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]])},80031:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(87461).Z)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]])},66912:function(e,t,r){"use strict";r.d(t,{Ej:function(){return c},tM:function(){return h},tu:function(){return u}});var n=r(3827),a=r(64090),l=r(1221),s=r(58121),i=r(27065),o=r(18994),d=r(98998);function c(){let[e,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),[o,d]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[h,m]=(0,a.useState)(!0),[x,p]=(0,a.useState)(null),[f,g]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=(0,i.Aj)(l.I8,async e=>{if(e)console.log("[PortalContext] Auth restored, UID:",e.uid),g(!0);else if(localStorage.getItem("parent_uid"),localStorage.getItem("parent_client_code"))try{console.log("[PortalContext] Re-establishing anonymous auth...");let e=(await (0,i.XB)(l.I8)).user.uid;console.log("[PortalContext] New anonymous UID:",e);let t=localStorage.getItem("parent_client_id");if(t)try{await (0,s.r7)((0,s.JU)(l.db,"clients",t),{parentUids:(0,s.vr)(e)}),console.log("[PortalContext] Added new UID to parentUids")}catch(e){console.error("[PortalContext] Failed to update parentUids:",e)}localStorage.setItem("parent_uid",e),g(!0)}catch(e){console.error("[PortalContext] Failed to restore auth:",e),p("Authentication failed. Please log in again."),m(!1)}else g(!0)});return()=>e()},[]),(0,a.useEffect)(()=>{if(!f)return;let e=localStorage.getItem("parent_client_code");if(!e){p("No client code found. Please log in."),m(!1);return}let r=(0,s.IO)((0,s.hJ)(l.db,"clients"),(0,s.ar)("clientCode","==",e.toUpperCase())),a=null,i=null,o=null,c=(0,s.cf)(r,e=>{if(e.empty){p("Portal session invalid or expired."),m(!1);return}let r=e.docs[0],c=r.id;t({id:c,...r.data()}),a&&a();let h=(0,s.IO)((0,s.hJ)(l.db,"events"),(0,s.ar)("clientId","==",c),(0,s.Xo)("startTime","asc"));a=(0,s.cf)(h,e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),n(t)},e=>{console.error("Sessions fetch error:",e)}),i&&i(),i=(0,s.cf)((0,s.hJ)(l.db,"services"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),d(t)}),o&&o(),o=(0,s.cf)((0,s.hJ)(l.db,"programs"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),u(t),m(!1)})},e=>{console.error("Client fetch error:",e),p(e.message),m(!1)});return()=>{c(),a&&a(),i&&i(),o&&o()}},[f]),{data:e,sessions:r,services:o,programs:c,loading:h,error:x}}function u(){return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,n.jsx)(o.Z,{className:"w-10 h-10 animate-spin mb-4"}),(0,n.jsx)("p",{children:"Loading your portal..."})]})}function h(e){let{message:t}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center px-6",children:[(0,n.jsx)("div",{className:"w-16 h-16 bg-error-50 dark:bg-error-900/20 rounded-full flex items-center justify-center mb-4",children:(0,n.jsx)(d.Z,{className:"w-8 h-8 text-error-500"})}),(0,n.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Access Error"}),(0,n.jsx)("p",{className:"text-neutral-500 text-sm mt-1 max-w-xs mx-auto",children:t}),(0,n.jsx)("a",{href:"/parent",className:"mt-6 text-primary-600 font-bold hover:underline",children:"Back to Login"})]})}},7186:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(3827),a=r(64090),l=r(69475),s=r(65561),i=r(80031),o=r(77329),d=r(3428),c=r(18994),u=r(61172),h=r(44715),m=r(66912),x=r(1221),p=r(58121),f=r(75504);let g=[{id:"assessment",label:"Assessment",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},{id:"report",label:"Report",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},{id:"consent",label:"Consent Form",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"},{id:"other",label:"Other",color:"bg-neutral-100 text-neutral-700 dark:bg-neutral-800 dark:text-neutral-400"}];function y(){let{data:e,loading:t,error:r}=(0,m.Ej)(),[y,b]=(0,a.useState)([]),[k,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)("all");if((0,a.useEffect)(()=>{if(!(null==e?void 0:e.id)){j(!1);return}let t=(0,p.IO)((0,p.hJ)(x.db,"clients",e.id,"documents"),(0,p.ar)("sharedWithParent","==",!0),(0,p.Xo)("uploadedAt","desc"));console.log("[ParentDocs] Setting up documents listener for client:",e.id);let r=(0,p.cf)(t,e=>{console.log("[ParentDocs] Received snapshot, docs count:",e.size);let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),b(t),j(!1)},e=>{console.error("[ParentDocs] Error fetching documents:",e),console.error("[ParentDocs] Error code:",e.code),console.error("[ParentDocs] Error message:",e.message),"permission-denied"===e.code&&console.error("[ParentDocs] Permission denied - user may need to re-authenticate"),j(!1)});return()=>r()},[null==e?void 0:e.id]),t)return(0,n.jsx)(m.tu,{});if(r||!e)return(0,n.jsx)(m.tM,{message:r||"Could not load documents."});let w="all"===v?y:y.filter(e=>e.category===v);return(0,n.jsxs)("div",{className:"p-4 space-y-6 animate-in fade-in slide-in-from-right-4 duration-500",children:[(0,n.jsxs)("header",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:"Documents"}),(0,n.jsxs)("p",{className:"text-neutral-500 text-sm",children:[y.length," document",1!==y.length?"s":""," available for ",e.name]})]}),y.length>0&&(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,n.jsx)("button",{onClick:()=>N("all"),className:(0,f.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors","all"===v?"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-400":"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400"),children:"All"}),g.map(e=>{let t=y.filter(t=>t.category===e.id).length;return 0===t?null:(0,n.jsxs)("button",{onClick:()=>N(e.id),className:(0,f.W)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",v===e.id?e.color:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400"),children:[e.label," (",t,")"]},e.id)})]}),k?(0,n.jsxs)("div",{className:"py-16 flex flex-col items-center justify-center",children:[(0,n.jsx)(c.Z,{className:"w-8 h-8 animate-spin text-primary-500 mb-4"}),(0,n.jsx)("p",{className:"text-neutral-500",children:"Loading documents..."})]}):0===w.length?(0,n.jsxs)("div",{className:"py-16 text-center bg-white dark:bg-neutral-900 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,n.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,n.jsx)(u.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,n.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:0===y.length?"No documents shared":"No matching documents"}),(0,n.jsx)("p",{className:"text-neutral-500 text-sm mt-1",children:0===y.length?"Reports and assessments will appear here when shared by your therapy team.":"Try selecting a different category."})]}):(0,n.jsx)("div",{className:"space-y-3",children:w.map(e=>{var t,r,a;let c=g.find(t=>t.id===e.category);return(0,n.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 p-4 shadow-sm hover:shadow-md transition-shadow",children:(0,n.jsxs)("div",{className:"flex items-start gap-4",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-primary-50 dark:bg-primary-900/20 rounded-xl flex items-center justify-center text-primary-500 flex-shrink-0",children:(a=e.fileType).includes("pdf")?(0,n.jsx)(l.Z,{className:"w-5 h-5"}):a.includes("image")?(0,n.jsx)(s.Z,{className:"w-5 h-5"}):a.includes("sheet")||a.includes("excel")?(0,n.jsx)(i.Z,{className:"w-5 h-5"}):a.includes("presentation")||a.includes("powerpoint")?(0,n.jsx)(o.Z,{className:"w-5 h-5"}):(0,n.jsx)(d.Z,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,n.jsx)("h4",{className:"font-semibold text-neutral-900 dark:text-white",children:e.name}),(0,n.jsx)("span",{className:(0,f.W)("px-2 py-0.5 text-xs font-medium rounded-full",null==c?void 0:c.color),children:null==c?void 0:c.label})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 text-sm text-neutral-500 mb-2",children:[(0,n.jsx)("span",{children:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(e.fileSize)}),(0,n.jsx)("span",{children:"â€¢"}),(0,n.jsx)("span",{children:(null===(r=e.uploadedAt)||void 0===r?void 0:null===(t=r.toDate)||void 0===t?void 0:t.call(r))?new Date(e.uploadedAt.toDate()).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Recently uploaded"})]}),e.description&&(0,n.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:e.description})]}),(0,n.jsxs)("a",{href:e.downloadUrl,target:"_blank",rel:"noopener noreferrer",download:e.fileName,className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors flex-shrink-0",children:[(0,n.jsx)(h.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Download"})]})]})},e.id)})})]})}},1221:function(e,t,r){"use strict";r.d(t,{Fw:function(){return h},I8:function(){return d},db:function(){return c},tO:function(){return u}});var n=r(26142),a=r(27065),l=r(58121),s=r(24905),i=r(76079);let o=0===(0,n.C6)().length?(0,n.ZF)({apiKey:"AIzaSyBLyN1jo8PpJ5OMtkEuC4auhuuviapB3Bs",authDomain:"tempo-app-2.firebaseapp.com",projectId:"tempo-app-2",storageBucket:"tempo-app-2.firebasestorage.app",messagingSenderId:"47813899076",appId:"1:47813899076:web:cd597912a0755195241d11"}):(0,n.C6)()[0],d=(0,a.v0)(o),c=(0,l.ad)(o),u=(0,s.cF)(o),h=(0,i.KL)(o)},75504:function(e,t,r){"use strict";function n(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,n,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var l=t.length;for(r=0;r<l;r++)t[r]&&(n=e(t[r]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n)}return a}(e))&&(n&&(n+=" "),n+=t);return n}r.d(t,{W:function(){return n}})}},function(e){e.O(0,[4358,139,5233,2971,8069,1744],function(){return e(e.s=74030)}),_N_E=e.O()}]);