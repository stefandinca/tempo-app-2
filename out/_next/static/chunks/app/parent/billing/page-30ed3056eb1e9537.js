(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[648],{55351:function(e,t,n){Promise.resolve().then(n.bind(n,13726))},57976:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(87461).Z)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},66912:function(e,t,n){"use strict";n.d(t,{Ej:function(){return o},tM:function(){return u},tu:function(){return d}});var r=n(3827),a=n(64090),s=n(1221),i=n(58121),l=n(18994),c=n(98998);function o(){let[e,t]=(0,a.useState)(null),[n,r]=(0,a.useState)([]),[l,c]=(0,a.useState)([]),[o,d]=(0,a.useState)([]),[u,x]=(0,a.useState)(!0),[h,m]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=localStorage.getItem("parent_client_code");if(!e){m("No client code found. Please log in."),x(!1);return}let n=(0,i.IO)((0,i.hJ)(s.db,"clients"),(0,i.ar)("clientCode","==",e.toUpperCase())),a=null,l=null,o=null,u=(0,i.cf)(n,e=>{if(e.empty){m("Portal session invalid or expired."),x(!1);return}let n=e.docs[0],u=n.id;t({id:u,...n.data()}),a&&a();let h=(0,i.IO)((0,i.hJ)(s.db,"events"),(0,i.ar)("clientId","==",u),(0,i.Xo)("startTime","asc"));a=(0,i.cf)(h,e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),r(t)},e=>{console.error("Sessions fetch error:",e)}),l&&l(),l=(0,i.cf)((0,i.hJ)(s.db,"services"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),c(t)}),o&&o(),o=(0,i.cf)((0,i.hJ)(s.db,"programs"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),d(t),x(!1)})},e=>{console.error("Client fetch error:",e),m(e.message),x(!1)});return()=>{u(),a&&a(),l&&l(),o&&o()}},[]),{data:e,sessions:n,services:l,programs:o,loading:u,error:h}}function d(){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,r.jsx)(l.Z,{className:"w-10 h-10 animate-spin mb-4"}),(0,r.jsx)("p",{children:"Loading your portal..."})]})}function u(e){let{message:t}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center px-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-error-50 dark:bg-error-900/20 rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)(c.Z,{className:"w-8 h-8 text-error-500"})}),(0,r.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Access Error"}),(0,r.jsx)("p",{className:"text-neutral-500 text-sm mt-1 max-w-xs mx-auto",children:t}),(0,r.jsx)("a",{href:"/parent",className:"mt-6 text-primary-600 font-bold hover:underline",children:"Back to Login"})]})}},13726:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=n(3827),a=n(87461);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var i=n(26490),l=n(57976);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,a.Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);var o=n(69475),d=n(44715);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,a.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var x=n(66912),h=n(2335),m=n(87134),f=n(64090),p=n(75504);function g(){let{data:e,loading:t,error:n}=(0,x.Ej)(),{data:a,loading:g}=(0,h.wm)((null==e?void 0:e.id)||""),[b,v]=(0,f.useState)(null),y=(0,f.useMemo)(()=>a.filter(e=>"issued"===e.status||"overdue"===e.status).reduce((e,t)=>e+t.total,0),[a]),j=(0,f.useMemo)(()=>a.filter(e=>"paid"!==e.status),[a]),w=(0,f.useMemo)(()=>a.filter(e=>"paid"===e.status),[a]);if(t||g)return(0,r.jsx)(x.tu,{});if(n||!e)return(0,r.jsx)(x.tM,{message:n||"Could not load billing data."});let N=async e=>{v(e.id);try{let t={series:e.series,number:e.number,date:e.date,dueDate:e.dueDate,clinic:e.clinic,client:e.client,items:e.items,total:e.total,currency:e.currency,date:new Date(e.date).toLocaleDateString("ro-RO"),dueDate:new Date(e.dueDate).toLocaleDateString("ro-RO")},n=(0,m.q)(t),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="Invoice_".concat(e.series).concat(e.number,".pdf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}catch(e){console.error("Download failed",e),alert("Failed to download invoice.")}finally{v(null)}};return(0,r.jsxs)("div",{className:"p-4 space-y-6 animate-in fade-in slide-in-from-right-4 duration-500 pb-20 font-sans",children:[(0,r.jsxs)("header",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:"Invoices & Payments"}),(0,r.jsx)("p",{className:"text-neutral-500 text-sm",children:"Manage your billing and view history"})]}),(0,r.jsxs)("div",{className:(0,p.W)("rounded-3xl border p-6 shadow-sm overflow-hidden relative",y>0?"bg-warning-50 border-warning-100 dark:bg-warning-900/10 dark:border-warning-900/30":"bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-800"),children:[(0,r.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:(0,r.jsx)(s,{className:"w-24 h-24"})}),(0,r.jsxs)("div",{className:"flex flex-col items-center text-center space-y-2 py-4",children:[(0,r.jsx)("p",{className:"text-xs font-bold text-neutral-400 uppercase tracking-widest",children:"Current Balance"}),(0,r.jsxs)("h2",{className:"text-5xl font-black text-neutral-900 dark:text-white",children:[y.toFixed(2)," RON"]}),(0,r.jsx)("div",{className:(0,p.W)("flex items-center gap-1.5 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider",y>0?"bg-warning-100 text-warning-700":"bg-success-50 text-success-700 dark:bg-success-900/20 dark:text-success-400"),children:y>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{className:"w-3 h-3"})," Payment Pending"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{className:"w-3 h-3"})," All Paid"]})})]}),y>0&&(0,r.jsxs)("button",{onClick:()=>alert("Online payments coming soon."),className:"w-full mt-6 py-4 bg-primary-600 hover:bg-primary-700 text-white rounded-2xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg shadow-primary-500/20",children:["Pay Balance Online",(0,r.jsx)(c,{className:"w-5 h-5"})]})]}),j.length>0&&(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white px-2",children:"Payment Required"}),(0,r.jsx)("div",{className:"space-y-3",children:j.map(e=>(0,r.jsxs)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-xl bg-warning-50 dark:bg-warning-900/20 text-warning-600 flex items-center justify-center",children:(0,r.jsx)(o.Z,{className:"w-6 h-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-bold text-neutral-900 dark:text-white",children:["Invoice #",e.series,"-",e.number]}),(0,r.jsxs)("p",{className:"text-xs text-neutral-500",children:["Issued: ",new Date(e.date).toLocaleDateString()]}),(0,r.jsxs)("p",{className:"text-xs text-error-500 font-medium",children:["Due: ",new Date(e.dueDate).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between sm:justify-end gap-4 w-full sm:w-auto border-t sm:border-0 border-neutral-100 dark:border-neutral-800 pt-3 sm:pt-0",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm font-black text-neutral-900 dark:text-white",children:[e.total.toFixed(2)," RON"]}),(0,r.jsx)("span",{className:"text-[10px] font-bold uppercase text-warning-600",children:"Unpaid"})]}),(0,r.jsx)("button",{onClick:()=>N(e),disabled:b===e.id,className:"p-3 bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700 rounded-xl text-neutral-600 dark:text-neutral-300 transition-colors",title:"Download PDF",children:b===e.id?(0,r.jsx)(i.Z,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)(d.Z,{className:"w-5 h-5"})})]})]},e.id))})]}),(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsxs)("h3",{className:"font-bold text-neutral-900 dark:text-white px-2 flex items-center gap-2",children:[(0,r.jsx)(u,{className:"w-4 h-4 text-neutral-400"}),"Paid History"]}),w.length>0?(0,r.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm overflow-hidden",children:(0,r.jsx)("div",{className:"divide-y divide-neutral-100 dark:divide-neutral-800",children:w.map(e=>(0,r.jsxs)("div",{className:"p-4 flex items-center justify-between hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-success-50 dark:bg-success-900/20 text-success-600 flex items-center justify-center",children:(0,r.jsx)(l.Z,{className:"w-4 h-4"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:["#",e.series,"-",e.number]}),(0,r.jsx)("p",{className:"text-xs text-neutral-500",children:new Date(e.date).toLocaleDateString()})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("p",{className:"text-sm font-bold text-neutral-900 dark:text-white",children:[e.total.toFixed(2)," RON"]}),(0,r.jsx)("button",{onClick:()=>N(e),className:"text-neutral-400 hover:text-primary-600 transition-colors",children:(0,r.jsx)(d.Z,{className:"w-4 h-4"})})]})]},e.id))})}):(0,r.jsxs)("div",{className:"text-center py-10 opacity-50",children:[(0,r.jsx)(s,{className:"w-12 h-12 mx-auto mb-2 text-neutral-300"}),(0,r.jsx)("p",{className:"text-sm text-neutral-500",children:"No payment history available."})]})]}),(0,r.jsx)("p",{className:"text-[10px] text-neutral-400 text-center px-6 leading-relaxed",children:"Payments are synchronized within 24 hours. For urgent billing issues, please contact the clinic administration directly."})]})}},2335:function(e,t,n){"use strict";n.d(t,{HX:function(){return f},Nx:function(){return h},Rn:function(){return m},Su:function(){return d},av:function(){return c},b$:function(){return u},bI:function(){return g},gV:function(){return b},hI:function(){return l},lU:function(){return o},we:function(){return x},wm:function(){return p}});var r=n(64090),a=n(58121),s=n(1221);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[n,i]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null);return(0,r.useEffect)(()=>{c(!0);let n=(0,a.IO)((0,a.hJ)(s.db,e),...t),r=(0,a.cf)(n,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),i(t),c(!1)},t=>{console.error("Error fetching ".concat(e,":"),t),d(t.message),c(!1)});return()=>r()},[e]),{data:n,loading:l,error:o}}function l(){return i("events")}function c(){return i("clients")}function o(){return i("team_members")}function d(){return i("services")}function u(){return i("programs")}function x(e){let[t,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!e){l(!1);return}let t=(0,a.IO)((0,a.hJ)(s.db,"events"),(0,a.ar)("clientId","==",e),(0,a.Xo)("startTime","asc")),r=(0,a.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),n(t),l(!1)},e=>{console.error("Error fetching client events:",e),o(e.message),l(!1)});return()=>r()},[e]),{data:t,loading:i,error:c}}function h(e,t){let[n,i]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let n=new Date(e,t,1),r=new Date(e,t+1,0,23,59,59,999),l=(0,a.IO)((0,a.hJ)(s.db,"events"),(0,a.ar)("startTime",">=",n.toISOString()),(0,a.ar)("startTime","<=",r.toISOString()),(0,a.Xo)("startTime","asc")),o=(0,a.cf)(l,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),i(t),c(!1)},e=>{console.error("Error fetching events by month:",e),d(e.message),c(!1)});return()=>o()},[e,t]),{data:n,loading:l,error:o}}function m(e){let[t,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!e){n([]),l(!1);return}let t=(0,a.IO)((0,a.hJ)(s.db,"clients",e,"interventionPlans"),(0,a.Xo)("createdAt","desc")),r=(0,a.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),n(t),l(!1)},e=>{console.error("Error fetching intervention plans:",e),o(e.message),l(!1)});return()=>r()},[e]);let d=t.find(e=>"active"===e.status)||null;return{data:t,loading:i,error:c,activePlan:d,getActivePlanForDate:e=>t.find(t=>{if("active"!==t.status)return!1;let n=new Date(t.startDate),r=new Date(t.endDate);return r.setHours(23,59,59,999),e>=n&&e<=r})||null}}function f(){let[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=(0,a.cf)((0,a.JU)(s.db,"system_settings","config"),e=>{e.exists()?t(e.data()):t(null),i(!1)},e=>{console.error("Error fetching system settings:",e),c(e.message),i(!1)});return()=>e()},[]),{data:e,loading:n,error:l}}function p(e){let[t,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!e){l(!1);return}let t=(0,a.IO)((0,a.hJ)(s.db,"invoices"),(0,a.ar)("clientId","==",e),(0,a.Xo)("date","desc")),r=(0,a.cf)(t,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),n(t),l(!1)},e=>{console.error("Error fetching client invoices:",e),o(e.message),l(!1)});return()=>r()},[e]),{data:t,loading:i,error:c}}function g(e,t){let[n,i]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let n="".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-01"),r="".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-31"),l=(0,a.IO)((0,a.hJ)(s.db,"invoices"),(0,a.ar)("date",">=",n),(0,a.ar)("date","<=",r),(0,a.Xo)("date","desc")),o=(0,a.cf)(l,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),i(t),c(!1)},e=>{console.error("Error fetching monthly invoices:",e),d(e.message),c(!1)});return()=>o()},[e,t]),{data:n,loading:l,error:o}}function b(e,t){let[n,i]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let n="".concat(e,"-").concat(String(t+1).padStart(2,"0")),r=(0,a.IO)((0,a.hJ)(s.db,"payouts"),(0,a.ar)("month","==",n)),l=(0,a.cf)(r,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),i(t),c(!1)},e=>{console.error("Error fetching monthly payouts:",e),d(e.message),c(!1)});return()=>l()},[e,t]),{data:n,loading:l,error:o}}},1221:function(e,t,n){"use strict";n.d(t,{Fw:function(){return d},I8:function(){return c},db:function(){return o}});var r=n(26142),a=n(27065),s=n(58121),i=n(76079);let l=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyBLyN1jo8PpJ5OMtkEuC4auhuuviapB3Bs",authDomain:"tempo-app-2.firebaseapp.com",projectId:"tempo-app-2",storageBucket:"tempo-app-2.firebasestorage.app",messagingSenderId:"47813899076",appId:"1:47813899076:web:cd597912a0755195241d11"}):(0,r.C6)()[0],c=(0,a.v0)(l),o=(0,s.ad)(l),d=(0,i.KL)(l)},87134:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(92493),a=n(25264);let s=e=>{let t=new r.ZP;t.setFontSize(20),t.text("INVOICE",150,20),t.setFontSize(10),t.text("Series: ".concat(e.series),150,30),t.text("Number: ".concat(e.number),150,35),t.text("Date: ".concat(e.date),150,40),t.text("Due Date: ".concat(e.dueDate),150,45),t.setFontSize(12),t.setFont("helvetica","bold"),t.text(e.clinic.name,14,20),t.setFont("helvetica","normal"),t.setFontSize(10);let n=25;t.text(e.clinic.address,14,n+=5,{maxWidth:80}),n+=(t.splitTextToSize(e.clinic.address,80).length-1)*5,t.text("CUI: ".concat(e.clinic.cui),14,n+=5),t.text("Reg. Com: ".concat(e.clinic.regNo),14,n+=5),t.text("Bank: ".concat(e.clinic.bank),14,n+=5),t.text("IBAN: ".concat(e.clinic.iban),14,n+=5),t.text("Email: ".concat(e.clinic.email),14,n+=5),t.setFont("helvetica","bold"),t.text("Bill To:",150,60),t.setFont("helvetica","normal"),t.text(e.client.name,150,65),e.client.address&&t.text(e.client.address,150,70,{maxWidth:50});let s=Math.max(n+15,90);(0,a.ZP)(t,{startY:s,head:[["Description","Qty","Unit","Price","Amount"]],body:e.items.map(e=>[e.description,e.quantity,e.unit,e.price.toFixed(2),e.amount.toFixed(2)]),theme:"striped",headStyles:{fillColor:[74,144,226]},foot:[["","","","Total","".concat(e.total.toFixed(2)," ").concat(e.currency)]],footStyles:{fillColor:[240,240,240],textColor:[0,0,0],fontStyle:"bold"}});let i=t.lastAutoTable.finalY+20;return t.setFontSize(10),t.text("Thank you for your business!",14,i),t.setFontSize(8),t.text("This invoice was generated automatically by TempoApp.",14,280),t.output("blob")}}},function(e){e.O(0,[358,139,505,125,373,220,672,971,69,744],function(){return e(e.s=55351)}),_N_E=e.O()}]);