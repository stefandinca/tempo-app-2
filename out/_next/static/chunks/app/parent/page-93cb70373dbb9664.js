(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6771],{20445:function(e,t,r){Promise.resolve().then(r.bind(r,68558))},37805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},68558:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(3827),n=r(64090),l=r(47907),s=r(8792),i=r(18994);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r(87461).Z)("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);var c=r(37805),u=r(1221),d=r(58121),m=r(10207);function h(){let[e,t]=(0,n.useState)(""),[r,h]=(0,n.useState)(!1),[p,g]=(0,n.useState)(""),f=(0,l.useRouter)(),x=(0,l.useSearchParams)(),{isAuthenticated:y,loading:b,authenticateWithCode:v}=(0,m.jT)();if((0,n.useEffect)(()=>{!b&&y&&f.replace("/parent/dashboard/")},[y,b,f]),(0,n.useEffect)(()=>{let e=x.get("code");e&&t(e.toUpperCase())},[x]),b||y)return(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 flex items-center justify-center",children:(0,a.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-primary-500"})});let w=async t=>{if(t&&t.preventDefault(),e.length<4){g("Please enter a valid client code.");return}h(!0),g("");try{let t=(0,d.IO)((0,d.hJ)(u.db,"clients"),(0,d.ar)("clientCode","==",e.toUpperCase())),r=await (0,d.PL)(t);if(r.empty){g("Invalid client code. Please check and try again."),h(!1);return}let a=r.docs[0],n=a.data();await v(a.id,n.name,e.toUpperCase()),console.log("[ParentLogin] Atomic authentication successful."),f.push("/parent/dashboard/")}catch(e){console.error("Verification error:",e),g("An error occurred. Please try again."),h(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 flex flex-col items-center justify-center p-4",children:[(0,a.jsx)("span",{className:"sr-only",children:"PARENT_LOGIN_PAGE_ACTIVE"}),(0,a.jsxs)("div",{className:"max-w-md w-full bg-white dark:bg-neutral-900 rounded-3xl shadow-xl border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-8 sm:p-12 text-center",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-primary-100 dark:bg-primary-900/30 rounded-2xl flex items-center justify-center text-primary-600 mb-6",children:(0,a.jsx)(o,{className:"w-8 h-8"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white mb-2",children:"Parent Portal Access"}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm mb-8",children:"Enter the unique client code provided by your clinic to access your child's therapy journey."}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("input",{type:"text",placeholder:"Enter Client Code",className:"w-full px-6 py-4 bg-neutral-100 dark:bg-neutral-800 border-none rounded-2xl text-center text-xl font-mono tracking-[0.5em] uppercase focus:ring-2 focus:ring-primary-500 transition-all placeholder:text-neutral-400 placeholder:tracking-normal placeholder:font-sans placeholder:text-base",value:e,onChange:e=>t(e.target.value.slice(0,8)),maxLength:8,autoFocus:!0})}),p&&(0,a.jsx)("p",{className:"text-error-500 text-sm",children:p}),(0,a.jsx)("button",{type:"submit",disabled:r,className:"w-full py-4 bg-primary-600 hover:bg-primary-700 text-white rounded-2xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg shadow-primary-500/20 disabled:opacity-70",children:r?(0,a.jsx)(i.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:["Access Portal",(0,a.jsx)(c.Z,{className:"w-5 h-5"})]})})]})]}),(0,a.jsx)("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 p-6 text-center border-t border-neutral-100 dark:border-neutral-800",children:(0,a.jsx)("p",{className:"text-xs text-neutral-500 leading-relaxed",children:"Don't have a code? Please contact your clinic administrator or therapy coordinator."})})]}),(0,a.jsx)(s.default,{href:"/login/",className:"mt-8 text-sm text-neutral-500 hover:text-primary-600 transition-colors",children:"Staff Login"})]})}function p(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 flex items-center justify-center",children:(0,a.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-primary-500"})}),children:(0,a.jsx)(h,{})})}},10207:function(e,t,r){"use strict";r.d(t,{Sp:function(){return d},gx:function(){return c},jT:function(){return u}});var a=r(3827),n=r(64090),l=r(27065),s=r(1221),i=r(58121);let o=(0,n.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[m,h]=(0,n.useState)(null),[p,g]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,l.Aj)(s.I8,async e=>{if(null==e?void 0:e.isAnonymous){c(e);let t=localStorage.getItem("parent_client_id"),r=localStorage.getItem("parent_client_name"),a=localStorage.getItem("parent_uid");if(t){if(a!==e.uid){console.log("[ParentAuth] UID mismatch or new session. Re-registering with client...");try{let r=(0,i.JU)(s.db,"clients",t);await (0,i.r7)(r,{parentUids:(0,i.vr)(e.uid)}),console.log("[ParentAuth] Re-registered successfully."),localStorage.setItem("parent_uid",e.uid)}catch(e){console.error("[ParentAuth] Failed to re-register UID with client:",e)}}d(t),h(r)}else d(null),h(null);g(!1)}else if(localStorage.getItem("parent_client_code")&&!e){console.log("[ParentAuth] No active session, but found stored code. Auto-logging in...");try{await (0,l.XB)(s.I8);return}catch(e){console.error("[ParentAuth] Auto-login failed:",e),g(!1)}}else c(null),d(null),h(null),g(!1)});return()=>e()},[]);let f=(0,n.useCallback)(async(e,t,r)=>{try{let a=s.I8.currentUser;a&&a.isAnonymous||(a=(await (0,l.XB)(s.I8)).user);let n=(0,i.JU)(s.db,"clients",e);await (0,i.r7)(n,{parentUids:(0,i.vr)(a.uid)}),localStorage.setItem("parent_uid",a.uid),localStorage.setItem("parent_client_id",e),localStorage.setItem("parent_client_name",t),localStorage.setItem("parent_client_code",r.toUpperCase()),c(a),d(e),h(t),console.log("[ParentAuth] Successfully authenticated parent with UID:",a.uid)}catch(e){throw console.error("[ParentAuth] Error authenticating:",e),e}},[]),x=(0,n.useCallback)(async()=>{try{localStorage.removeItem("parent_uid"),localStorage.removeItem("parent_client_id"),localStorage.removeItem("parent_client_name"),localStorage.removeItem("parent_client_code"),await (0,l.w7)(s.I8),c(null),d(null),h(null)}catch(e){console.error("[ParentAuth] Error signing out:",e)}},[]);return(0,a.jsx)(o.Provider,{value:{user:r,clientId:u,clientName:m,loading:p,isAuthenticated:null!==r&&null!==u,authenticateWithCode:f,signOut:x},children:t})}function u(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useParentAuth must be used within ParentAuthProvider");return e}function d(){return(0,n.useContext)(o)}},1221:function(e,t,r){"use strict";r.d(t,{Fw:function(){return m},I8:function(){return c},db:function(){return u},tO:function(){return d}});var a=r(26142),n=r(27065),l=r(58121),s=r(24905),i=r(76079);let o=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyBLyN1jo8PpJ5OMtkEuC4auhuuviapB3Bs",authDomain:"tempo-app-2.firebaseapp.com",projectId:"tempo-app-2",storageBucket:"tempo-app-2.firebasestorage.app",messagingSenderId:"47813899076",appId:"1:47813899076:web:cd597912a0755195241d11"}):(0,a.C6)()[0],c=(0,n.v0)(o),u=(0,l.ad)(o),d=(0,s.cF)(o),m=(0,i.KL)(o)}},function(e){e.O(0,[4358,139,5050,901,2971,8069,1744],function(){return e(e.s=20445)}),_N_E=e.O()}]);