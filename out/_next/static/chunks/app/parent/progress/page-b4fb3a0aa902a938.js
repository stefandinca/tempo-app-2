(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8579],{84384:function(e,t,r){Promise.resolve().then(r.bind(r,91006))},95160:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]])},66912:function(e,t,r){"use strict";r.d(t,{Ej:function(){return o},tM:function(){return x},tu:function(){return u}});var s=r(3827),a=r(64090),l=r(1221),n=r(58121),i=r(18994),c=r(98998),d=r(10207);function o(){let{isAuthenticated:e,clientId:t,loading:r}=(0,d.jT)(),[s,i]=(0,a.useState)(null),[c,o]=(0,a.useState)([]),[u,x]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[p,g]=(0,a.useState)([]),[b,f]=(0,a.useState)(!0),[j,v]=(0,a.useState)(null);return(0,a.useEffect)(()=>{r&&f(!0)},[r]),(0,a.useEffect)(()=>{if(r)return;if(!e||!t){f(!1);return}f(!0),v(null);let s=(0,n.hJ)(l.db,"clients"),a=(0,n.IO)(s,(0,n.ar)("__name__","==",t)),c=null,d=null,u=null,m=null,p=(0,n.cf)(a,e=>{if(e.empty){v("Portal session invalid or expired."),f(!1);return}let r=e.docs[0];i({id:r.id,...r.data()}),c&&c();let s=(0,n.IO)((0,n.hJ)(l.db,"events"),(0,n.ar)("clientId","==",t),(0,n.Xo)("startTime","asc"));c=(0,n.cf)(s,e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),o(t)},e=>{console.error("Sessions fetch error:",e)}),d&&d(),d=(0,n.cf)((0,n.hJ)(l.db,"services"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),x(t)}),u&&u(),u=(0,n.cf)((0,n.hJ)(l.db,"programs"),e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),h(t)}),m&&m();let a=(0,n.IO)((0,n.hJ)(l.db,"clients",t,"evaluations"),(0,n.ar)("status","==","completed"),(0,n.Xo)("completedAt","desc"));m=(0,n.cf)(a,e=>{let t=[];e.forEach(e=>t.push({id:e.id,...e.data()})),g(t),f(!1)},e=>{console.error("Evaluations fetch error:",e),f(!1)})},e=>{console.error("Client fetch error:",e),v(e.message),f(!1)});return()=>{p(),c&&c(),d&&d(),u&&u(),m&&m()}},[e,t,r]),{data:s,sessions:c,services:u,programs:m,evaluations:p,loading:b,error:j}}function u(){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,s.jsx)(i.Z,{className:"w-10 h-10 animate-spin mb-4"}),(0,s.jsx)("p",{children:"Loading your portal..."})]})}function x(e){let{message:t}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center px-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-error-50 dark:bg-error-900/20 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)(c.Z,{className:"w-8 h-8 text-error-500"})}),(0,s.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"Access Error"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mt-1 max-w-xs mx-auto",children:t}),(0,s.jsx)("a",{href:"/parent",className:"mt-6 text-primary-600 font-bold hover:underline",children:"Back to Login"})]})}},91006:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _}});var s=r(3827),a=r(64090),l=r(87461);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,l.Z)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);var i=r(69475),c=r(14562),d=r(95160),o=r(29733);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,l.Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);var x=r(66912),m=r(10775),h=r(27271),p=r(85159),g=r(23441),b=r(97307),f=r(75504);let j=[{key:"minus",label:"−",color:"error",description:"Incorrect"},{key:"zero",label:"0",color:"neutral",description:"No Response"},{key:"prompted",label:"P",color:"warning",description:"Prompted"},{key:"plus",label:"+",color:"success",description:"Correct"}];function v(e){let t=e.minus+e.zero+e.prompted+e.plus;return 0===t?0:Math.round(e.plus/t*100)}function w(e){let{programId:t,programTitle:r,programDescription:l,sessionHistory:n}=e,[i,c]=(0,a.useState)(!1),d=[...n].sort((e,t)=>t.date.getTime()-e.date.getTime()),u=d[0],x=(null==u?void 0:u.scores)||{minus:0,zero:0,prompted:0,plus:0},w=n.reduce((e,t)=>({minus:e.minus+t.scores.minus,zero:e.zero+t.scores.zero,prompted:e.prompted+t.scores.prompted,plus:e.plus+t.scores.plus}),{minus:0,zero:0,prompted:0,plus:0}),N=w.minus+w.zero+w.prompted+w.plus,y=v(w);v(x);let k=function(e){if(e.length<2)return"insufficient";let t=e.slice(-3),r=e.slice(-6,-3);if(0===r.length)return"insufficient";let s=t.reduce((e,t)=>e+v(t.scores),0)/t.length-r.reduce((e,t)=>e+v(t.scores),0)/r.length;return s>5?"improving":s<-5?"declining":"stable"}(n),S=(e,t)=>{let r={error:{bg:"bg-error-50 dark:bg-error-900/20 border-error-200 dark:border-error-800",activeBg:"bg-error-500 border-error-600",text:"text-error-600 dark:text-error-400"},neutral:{bg:"bg-neutral-100 dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700",activeBg:"bg-neutral-500 border-neutral-600",text:"text-neutral-600 dark:text-neutral-400"},warning:{bg:"bg-warning-50 dark:bg-warning-900/20 border-warning-200 dark:border-warning-800",activeBg:"bg-warning-500 border-warning-600",text:"text-warning-600 dark:text-warning-400"},success:{bg:"bg-success-50 dark:bg-success-900/20 border-success-200 dark:border-success-800",activeBg:"bg-success-500 border-success-600",text:"text-success-600 dark:text-success-400"}};return r[e]||r.neutral},I=(()=>{switch(k){case"improving":return{icon:o.Z,label:"Improving",color:"text-success-600",bg:"bg-success-50 dark:bg-success-900/20"};case"declining":return{icon:m.Z,label:"Needs Focus",color:"text-warning-600",bg:"bg-warning-50 dark:bg-warning-900/20"};case"stable":return{icon:h.Z,label:"Stable",color:"text-primary-600",bg:"bg-primary-50 dark:bg-primary-900/20"};default:return null}})();return(0,s.jsxs)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b border-neutral-100 dark:border-neutral-800",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:r}),l&&(0,s.jsx)("p",{className:"text-xs text-neutral-500 mt-0.5 line-clamp-2",children:l})]}),I&&(0,s.jsxs)("div",{className:(0,f.W)("flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold",I.bg,I.color),children:[(0,s.jsx)(I.icon,{className:"w-3.5 h-3.5"}),I.label]})]})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("p",{className:"text-[10px] font-semibold text-neutral-400 uppercase tracking-wider mb-3",children:"Latest Session Scores"}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-3",children:j.map(e=>{let{key:t,label:r,color:a,description:l}=e,n=x[t],i=S(a,n);return(0,s.jsxs)("div",{className:(0,f.W)("h-14 rounded-xl border-2 flex flex-col items-center justify-center select-none",n>0?i.activeBg+" text-white":i.bg+" "+i.text),title:l,children:[(0,s.jsx)("span",{className:"text-lg font-bold leading-none",children:r}),(0,s.jsx)("span",{className:"text-xs font-medium mt-0.5 opacity-80",children:n})]},t)})}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"text-neutral-500",children:["Sessions: ",(0,s.jsx)("span",{className:"font-bold text-neutral-700 dark:text-neutral-300",children:n.length})]}),(0,s.jsxs)("span",{className:"text-neutral-500",children:["Total Trials: ",(0,s.jsx)("span",{className:"font-bold text-neutral-700 dark:text-neutral-300",children:N})]})]}),(0,s.jsxs)("span",{className:"text-neutral-500",children:["Overall: ",(0,s.jsxs)("span",{className:(0,f.W)("font-bold",y>=80?"text-success-600":y>=50?"text-warning-600":N>0?"text-error-600":"text-neutral-400"),children:[y,"%"]})]})]}),N>0&&(0,s.jsx)("div",{className:"mt-2 h-2 bg-neutral-200 dark:bg-neutral-700 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:(0,f.W)("h-full transition-all duration-300 rounded-full",y>=80?"bg-success-500":y>=50?"bg-warning-500":"bg-error-500"),style:{width:"".concat(y,"%")}})})]}),n.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>c(!i),className:"w-full px-4 py-3 flex items-center justify-between border-t border-neutral-100 dark:border-neutral-800 hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors",children:[(0,s.jsxs)("span",{className:"text-xs font-semibold text-neutral-500 uppercase tracking-wider",children:["Session History (",n.length,")"]}),i?(0,s.jsx)(p.Z,{className:"w-4 h-4 text-neutral-400"}):(0,s.jsx)(g.Z,{className:"w-4 h-4 text-neutral-400"})]}),i&&(0,s.jsx)("div",{className:"px-4 pb-4 space-y-2 animate-in slide-in-from-top-2 duration-200",children:d.map((e,t)=>{let r=v(e.scores),a=e.scores.minus+e.scores.zero+e.scores.prompted+e.scores.plus;return(0,s.jsxs)("div",{className:(0,f.W)("flex items-center justify-between py-2 px-3 rounded-lg border",0===t?"bg-primary-50/50 dark:bg-primary-900/10 border-primary-100 dark:border-primary-900/30":"bg-neutral-50 dark:bg-neutral-800/50 border-neutral-100 dark:border-neutral-800"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 text-neutral-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:e.date.toLocaleDateString("en-US",{month:"short",day:"numeric",year:e.date.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}),(0,s.jsx)("p",{className:"text-[10px] text-neutral-500",children:e.sessionType})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("span",{className:"text-[10px] font-bold text-error-500",children:["−",e.scores.minus]}),(0,s.jsxs)("span",{className:"text-[10px] font-bold text-neutral-400",children:["0:",e.scores.zero]}),(0,s.jsxs)("span",{className:"text-[10px] font-bold text-warning-500",children:["P",e.scores.prompted]}),(0,s.jsxs)("span",{className:"text-[10px] font-bold text-success-500",children:["+",e.scores.plus]})]}),(0,s.jsxs)("div",{className:(0,f.W)("px-2 py-0.5 rounded-full text-[10px] font-bold",r>=80?"bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400":r>=50?"bg-warning-100 text-warning-700 dark:bg-warning-900/30 dark:text-warning-400":a>0?"bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-400":"bg-neutral-100 text-neutral-500"),children:[r,"%"]})]})]},e.sessionId)})})]})]})}var N=r(37805),y=r(50171);function k(e){let{evaluations:t,onSelect:r}=e;return 0===t.length?(0,s.jsxs)("div",{className:"py-20 text-center bg-white dark:bg-neutral-900 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(d.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,s.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"No evaluations yet"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mt-1 max-w-xs mx-auto",children:"Completed evaluations will appear here."})]}):(0,s.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,s.jsx)("button",{onClick:()=>r(e),className:"w-full text-left bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm hover:shadow-md transition-all group",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-20 h-20 flex-shrink-0 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl overflow-hidden",children:(0,s.jsx)(y.E,{evaluation:e,className:"w-full h-full"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"px-2 py-0.5 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400 text-[10px] font-bold uppercase tracking-wider rounded",children:e.type}),(0,s.jsx)("span",{className:"text-xs text-neutral-500",children:new Date(e.completedAt||e.createdAt).toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"})})]}),(0,s.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white truncate",children:"Evaluation Report"}),(0,s.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:["Overall Score: ",(0,s.jsxs)("span",{className:"font-bold text-primary-600",children:[e.overallPercentage,"%"]})]})]}),(0,s.jsx)("div",{className:"text-neutral-300 group-hover:text-primary-500 transition-colors",children:(0,s.jsx)(N.Z,{className:"w-5 h-5"})})]})},e.id))})}var S=r(53879),I=r(44715),P=r(48953);function E(e){let{evaluation:t,previousEvaluation:r,allEvaluations:l,clientData:n,onBack:i}=e,c=(0,a.useMemo)(()=>Object.values(t.categorySummaries).sort((e,t)=>e.categoryKey.localeCompare(t.categoryKey)),[t]),d=(0,a.useMemo)(()=>[...c].sort((e,t)=>t.percentage-e.percentage).slice(0,3),[c]),x=(0,a.useMemo)(()=>r?c.map(e=>{let t=r.categorySummaries[e.categoryKey],s=t?e.percentage-t.percentage:0;return{...e,diff:s}}).filter(e=>e.diff>0).sort((e,t)=>t.diff-e.diff).slice(0,3):[],[c,r]);return(0,s.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right duration-300",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:i,className:"p-2 -ml-2 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-500 transition-colors",children:(0,s.jsx)(S.Z,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:"Evaluation Details"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[(0,s.jsx)(b.Z,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:new Date(t.completedAt||t.createdAt).toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"})})]})]}),(0,s.jsx)("button",{onClick:()=>{(0,P.G)(t,n,r,l,!0)},className:"ml-auto p-2 rounded-xl bg-primary-50 dark:bg-primary-900/20 text-primary-600 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors",title:"Download PDF Report",children:(0,s.jsx)(I.Z,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-primary-500 to-primary-700 rounded-3xl p-6 text-white shadow-lg shadow-primary-500/20",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-primary-100 text-sm font-medium mb-1",children:"Overall Progress"}),(0,s.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,s.jsxs)("h3",{className:"text-4xl font-bold",children:[t.overallPercentage,"%"]}),r&&(0,s.jsxs)("span",{className:"text-primary-200 text-sm font-medium flex items-center gap-1",children:[(0,s.jsx)(o.Z,{className:"w-3 h-3"}),t.overallPercentage>r.overallPercentage?"+":"",t.overallPercentage-r.overallPercentage,"%"]})]}),(0,s.jsxs)("p",{className:"text-primary-200 text-sm mt-1",children:[t.overallScore," / ",t.overallMaxScore," total points"]})]}),(0,s.jsx)("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center backdrop-blur-sm",children:(0,s.jsx)(u,{className:"w-8 h-8 text-white"})})]})}),(0,s.jsxs)("div",{className:"bg-white dark:bg-neutral-900 rounded-3xl p-4 border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-neutral-900 dark:text-white mb-4 px-2",children:"Skill Profile"}),(0,s.jsx)(y.Z,{evaluation:t,previousEvaluation:r,size:"sm",showLegend:!1})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-neutral-900 dark:text-white px-1",children:x.length>0?"Top Improvements":"Strongest Areas"}),(0,s.jsx)("div",{className:"grid gap-3",children:(x.length>0?x:d).map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm flex items-center gap-4",children:[(0,s.jsx)("div",{className:(0,f.W)("w-10 h-10 rounded-xl flex items-center justify-center font-bold",x.length>0?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400"),children:e.categoryKey}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-bold text-neutral-900 dark:text-white",children:e.categoryName}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("div",{className:"flex-1 h-1.5 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:(0,f.W)("h-full rounded-full",x.length>0?"bg-primary-500":"bg-success-500"),style:{width:"".concat(e.percentage,"%")}})}),(0,s.jsx)("span",{className:"text-xs font-bold text-neutral-600 dark:text-neutral-400",children:x.length>0?"+".concat(e.diff,"%"):"".concat(e.percentage,"%")})]})]})]},e.categoryKey))})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-neutral-900 dark:text-white px-1",children:"Detailed Breakdown"}),(0,s.jsx)("div",{className:"bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm overflow-hidden",children:c.map((e,t)=>(0,s.jsxs)("div",{className:(0,f.W)("p-4 flex items-center gap-4 hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors",0!==t&&"border-t border-neutral-100 dark:border-neutral-800"),children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-lg bg-neutral-100 dark:bg-neutral-800 flex items-center justify-center font-bold text-neutral-500 text-sm",children:e.categoryKey}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,s.jsx)("p",{className:"font-medium text-neutral-900 dark:text-white text-sm truncate pr-2",children:e.categoryName}),(0,s.jsxs)("span",{className:(0,f.W)("text-xs font-bold",e.percentage>=80?"text-success-600":e.percentage>=50?"text-warning-600":"text-neutral-500"),children:[e.percentage,"%"]})]}),(0,s.jsx)("div",{className:"h-1.5 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:(0,f.W)("h-full rounded-full transition-all",e.percentage>=80?"bg-success-500":e.percentage>=50?"bg-warning-500":"bg-neutral-400"),style:{width:"".concat(e.percentage,"%")}})})]})]},e.categoryKey))})]})]})}function _(){let{data:e,sessions:t,programs:r,evaluations:l,loading:m,error:h}=(0,x.Ej)(),[p,g]=(0,a.useState)("programs"),[b,j]=(0,a.useState)(null),v=(0,a.useMemo)(()=>b&&b.previousEvaluationId&&l&&l.find(e=>e.id===b.previousEvaluationId)||null,[b,l]),N=(0,a.useMemo)(()=>{if(!t||!r)return[];let e=new Map,s=e=>new Date(e?e.seconds?1e3*e.seconds:e:0);return t.forEach(t=>{let a=t.programIds||[],l=t.programScores||{},n=s(t.startTime);a.forEach(s=>{let a=l[s];if(!a||!(a.minus>0||a.zero>0||a.prompted>0||a.plus>0))return;let i=r.find(e=>e.id===s);i&&(e.has(s)||e.set(s,{id:s,title:i.title||"Unnamed Program",description:i.description,sessionHistory:[]}),e.get(s).sessionHistory.push({sessionId:t.id,date:n,scores:a,sessionType:t.type||"Therapy Session"}))})}),Array.from(e.values()).map(e=>({...e,sessionHistory:e.sessionHistory.sort((e,t)=>e.date.getTime()-t.date.getTime())})).filter(e=>e.sessionHistory.length>0)},[t,r]),y=(0,a.useMemo)(()=>{if(0===N.length)return{totalPrograms:0,totalSessions:0,totalTrials:0,avgSuccessRate:0};let e=0,t=0,r=new Set;return N.forEach(s=>{s.sessionHistory.forEach(s=>{r.add(s.sessionId);let a=s.scores.minus+s.scores.zero+s.scores.prompted+s.scores.plus;e+=a,t+=s.scores.plus})}),{totalPrograms:N.length,totalSessions:r.size,totalTrials:e,avgSuccessRate:e>0?Math.round(t/e*100):0}},[N]);return m?(0,s.jsx)(x.tu,{}):h||!e?(0,s.jsx)(x.tM,{message:h||"Could not load progress data."}):b?(0,s.jsx)("div",{className:"p-4 pb-24",children:(0,s.jsx)(E,{evaluation:b,previousEvaluation:v,allEvaluations:l,clientData:e,onBack:()=>j(null)})}):(0,s.jsxs)("div",{className:"p-4 space-y-6 animate-in fade-in slide-in-from-right-4 duration-500 pb-24",children:[(0,s.jsxs)("header",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:"Progress Tracking"}),(0,s.jsxs)("p",{className:"text-neutral-500 text-sm",children:["Monitor ",e.name,"'s therapy progress"]})]}),(0,s.jsxs)("div",{className:"flex p-1 bg-neutral-100 dark:bg-neutral-900 rounded-xl",children:[(0,s.jsxs)("button",{onClick:()=>g("programs"),className:(0,f.W)("flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2","programs"===p?"bg-white dark:bg-neutral-800 text-primary-600 shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,s.jsx)(n,{className:"w-4 h-4"}),"Programs"]}),(0,s.jsxs)("button",{onClick:()=>g("evaluations"),className:(0,f.W)("flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2","evaluations"===p?"bg-white dark:bg-neutral-800 text-primary-600 shadow-sm":"text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),"Evaluations"]})]}),"programs"===p?(0,s.jsxs)(s.Fragment,{children:[N.length>0?(0,s.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:(0,s.jsx)(c.Z,{className:"w-5 h-5 text-primary-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:y.totalPrograms}),(0,s.jsx)("p",{className:"text-[10px] text-neutral-500 uppercase font-semibold tracking-wider",children:"Programs"})]})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-teal-100 dark:bg-teal-900/30 rounded-xl flex items-center justify-center",children:(0,s.jsx)(d.Z,{className:"w-5 h-5 text-teal-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:y.totalSessions}),(0,s.jsx)("p",{className:"text-[10px] text-neutral-500 uppercase font-semibold tracking-wider",children:"Sessions"})]})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center",children:(0,s.jsx)(o.Z,{className:"w-5 h-5 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:y.totalTrials}),(0,s.jsx)("p",{className:"text-[10px] text-neutral-500 uppercase font-semibold tracking-wider",children:"Trials"})]})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:(0,f.W)("w-10 h-10 rounded-xl flex items-center justify-center",y.avgSuccessRate>=80?"bg-success-100 dark:bg-success-900/30":y.avgSuccessRate>=50?"bg-warning-100 dark:bg-warning-900/30":"bg-error-100 dark:bg-error-900/30"),children:(0,s.jsx)(u,{className:(0,f.W)("w-5 h-5",y.avgSuccessRate>=80?"text-success-600":y.avgSuccessRate>=50?"text-warning-600":"text-error-600")})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:[y.avgSuccessRate,"%"]}),(0,s.jsx)("p",{className:"text-[10px] text-neutral-500 uppercase font-semibold tracking-wider",children:"Success"})]})]})})]}):(0,s.jsxs)("div",{className:"py-20 text-center bg-white dark:bg-neutral-900 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-neutral-50 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(d.Z,{className:"w-8 h-8 text-neutral-300"})}),(0,s.jsx)("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:"No progress data yet"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mt-1 max-w-xs mx-auto",children:"Program scores will appear here once therapists begin tracking progress during sessions."})]}),N.length>0&&(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xs font-bold text-neutral-400 uppercase tracking-widest px-1 mb-4",children:"Program Progress"}),(0,s.jsx)("div",{className:"space-y-4",children:N.map(e=>(0,s.jsx)(w,{programId:e.id,programTitle:e.title,programDescription:e.description,sessionHistory:e.sessionHistory},e.id))})]}),(0,s.jsxs)("section",{className:"bg-neutral-50 dark:bg-neutral-800/50 rounded-2xl p-4 border border-neutral-100 dark:border-neutral-800",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-neutral-500 uppercase tracking-wider mb-3",children:"Understanding Scores"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded bg-error-500 flex items-center justify-center text-white font-bold text-[10px]",children:"−"}),(0,s.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Incorrect response"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded bg-neutral-500 flex items-center justify-center text-white font-bold text-[10px]",children:"0"}),(0,s.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"No response"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded bg-warning-500 flex items-center justify-center text-white font-bold text-[10px]",children:"P"}),(0,s.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Prompted/Assisted"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded bg-success-500 flex items-center justify-center text-white font-bold text-[10px]",children:"+"}),(0,s.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Correct/Independent"})]})]})]})]}):(0,s.jsx)(k,{evaluations:l||[],onSelect:j})]})}},10207:function(e,t,r){"use strict";r.d(t,{Sp:function(){return u},gx:function(){return d},jT:function(){return o}});var s=r(3827),a=r(64090),l=r(27065),n=r(1221),i=r(58121);let c=(0,a.createContext)(void 0);function d(e){let{children:t}=e,[r,d]=(0,a.useState)(null),[o,u]=(0,a.useState)(null),[x,m]=(0,a.useState)(null),[h,p]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=(0,l.Aj)(n.I8,async e=>{if(null==e?void 0:e.isAnonymous){d(e);let t=localStorage.getItem("parent_client_id"),r=localStorage.getItem("parent_client_name"),s=localStorage.getItem("parent_uid");if(t){if(s!==e.uid){console.log("[ParentAuth] UID mismatch or new session. Re-registering with client...");try{let r=(0,i.JU)(n.db,"clients",t);await (0,i.r7)(r,{parentUids:(0,i.vr)(e.uid)}),console.log("[ParentAuth] Re-registered successfully."),localStorage.setItem("parent_uid",e.uid)}catch(e){console.error("[ParentAuth] Failed to re-register UID with client:",e)}}u(t),m(r)}else u(null),m(null);p(!1)}else if(localStorage.getItem("parent_client_code")&&!e){console.log("[ParentAuth] No active session, but found stored code. Auto-logging in...");try{await (0,l.XB)(n.I8);return}catch(e){console.error("[ParentAuth] Auto-login failed:",e),p(!1)}}else d(null),u(null),m(null),p(!1)});return()=>e()},[]);let g=(0,a.useCallback)(async(e,t)=>{try{let r=n.I8.currentUser;r&&r.isAnonymous||(r=(await (0,l.XB)(n.I8)).user);let s=(0,i.JU)(n.db,"clients",e);await (0,i.r7)(s,{parentUids:(0,i.vr)(r.uid)}),localStorage.setItem("parent_uid",r.uid),localStorage.setItem("parent_client_id",e),localStorage.setItem("parent_client_name",t),d(r),u(e),m(t),console.log("[ParentAuth] Successfully authenticated parent with UID:",r.uid)}catch(e){throw console.error("[ParentAuth] Error authenticating:",e),e}},[]),b=(0,a.useCallback)(async()=>{try{localStorage.removeItem("parent_uid"),localStorage.removeItem("parent_client_id"),localStorage.removeItem("parent_client_name"),localStorage.removeItem("parent_client_code"),await (0,l.w7)(n.I8),d(null),u(null),m(null)}catch(e){console.error("[ParentAuth] Error signing out:",e)}},[]);return(0,s.jsx)(c.Provider,{value:{user:r,clientId:o,clientName:x,loading:h,isAuthenticated:null!==r&&null!==o,authenticateWithCode:g,signOut:b},children:t})}function o(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useParentAuth must be used within ParentAuthProvider");return e}function u(){return(0,a.useContext)(c)}},1221:function(e,t,r){"use strict";r.d(t,{Fw:function(){return x},I8:function(){return d},db:function(){return o},tO:function(){return u}});var s=r(26142),a=r(27065),l=r(58121),n=r(24905),i=r(76079);let c=0===(0,s.C6)().length?(0,s.ZF)({apiKey:"AIzaSyBLyN1jo8PpJ5OMtkEuC4auhuuviapB3Bs",authDomain:"tempo-app-2.firebaseapp.com",projectId:"tempo-app-2",storageBucket:"tempo-app-2.firebasestorage.app",messagingSenderId:"47813899076",appId:"1:47813899076:web:cd597912a0755195241d11"}):(0,s.C6)()[0],d=(0,a.v0)(c),o=(0,l.ad)(c),u=(0,n.cF)(c),x=(0,i.KL)(c)}},function(e){e.O(0,[4358,139,2505,3125,5050,699,1486,5674,4639,2971,8069,1744],function(){return e(e.s=84384)}),_N_E=e.O()}]);