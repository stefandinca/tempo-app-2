(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[621],{14023:function(e,t,r){Promise.resolve().then(r.bind(r,11957))},43345:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},46578:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},37805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},10527:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},29733:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},11957:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var a=r(3827),n=r(97307),l=r(37805),s=r(26490),i=r(10527),d=r(29733),o=r(8792),c=r(66912),u=r(2335),m=r(17273),x=r(82924),h=r(64090),g=r(75504);function f(){var e,t;let{data:r,sessions:f,loading:b,error:p}=(0,c.Ej)(),{data:v}=(0,u.lU)(),{data:w,loading:j}=(0,u.wm)((null==r?void 0:r.id)||""),[N,y]=(0,h.useState)(null),[k,S]=(0,h.useState)(!1),C=(0,h.useMemo)(()=>w.filter(e=>"issued"===e.status||"overdue"===e.status).reduce((e,t)=>e+t.total,0),[w]);if(b||j)return(0,a.jsx)(c.tu,{});if(p||!r)return(0,a.jsx)(c.tM,{message:p||"Could not load child data."});let A=e=>new Date(e?e.seconds?1e3*e.seconds:e:0),Z=new Date,I=(f||[]).filter(e=>A(e.startTime)>=Z).sort((e,t)=>A(e.startTime).getTime()-A(t.startTime).getTime())[0],_=I?(t=I.therapistId,(v||[]).find(e=>e.id===t)):null,D=new Date().getMonth(),P=(f||[]).filter(e=>A(e.startTime).getMonth()===D),T=P.filter(e=>"completed"===e.status);return(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 font-sans",children:[(0,a.jsxs)("section",{className:"px-4 py-6",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:["\uD83D\uDC4B Welcome back, ",(null===(e=r.parentName)||void 0===e?void 0:e.split(" ")[0])||"Parent","!"]}),(0,a.jsxs)("p",{className:"text-neutral-500 text-sm mt-1",children:["Viewing portal for: ",(0,a.jsx)("span",{className:"font-bold text-primary-600",children:r.name})]})]}),(0,a.jsx)("section",{className:"px-4",children:I?(0,a.jsxs)("div",{onClick:()=>{y(I),S(!0)},className:"bg-primary-600 rounded-3xl p-6 text-white shadow-lg shadow-primary-500/30 relative overflow-hidden cursor-pointer active:scale-[0.98] transition-transform",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:(0,a.jsx)(n.Z,{className:"w-24 h-24"})}),(0,a.jsx)("p",{className:"text-primary-100 text-xs font-bold uppercase tracking-wider mb-1",children:"Next Session"}),(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4",children:[A(I.startTime).toLocaleDateString("en-US",{weekday:"long"}),", ",A(I.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-md rounded-2xl p-3 border border-white/10",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center font-bold",style:{backgroundColor:(null==_?void 0:_.color)||"rgba(255,255,255,0.2)"},children:(null==_?void 0:_.initials)||"??"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-bold",children:I.type}),(0,a.jsxs)("p",{className:"text-xs text-primary-100",children:["with ",(null==_?void 0:_.name)||"Assigned Therapist"]})]}),(0,a.jsx)("div",{className:"ml-auto p-2 bg-white text-primary-600 rounded-xl",children:(0,a.jsx)(l.Z,{className:"w-5 h-5"})})]})]}):(0,a.jsxs)("div",{className:"bg-neutral-100 dark:bg-neutral-800 rounded-3xl p-8 text-center border border-dashed border-neutral-300 dark:border-neutral-700",children:[(0,a.jsx)(s.Z,{className:"w-10 h-10 text-neutral-400 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium",children:"No upcoming sessions scheduled."})]})}),(0,a.jsxs)("section",{className:"px-4 grid grid-cols-2 gap-4",children:[(0,a.jsxs)(o.default,{href:"/parent/billing/",className:(0,g.W)("col-span-2 p-5 rounded-3xl border transition-all shadow-sm flex items-center justify-between group",C>0?"bg-warning-50 border-warning-100 dark:bg-warning-900/10 dark:border-warning-900/30":"bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-800"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:(0,g.W)("w-12 h-12 rounded-2xl flex items-center justify-center transition-colors",C>0?"bg-warning-100 text-warning-600":"bg-neutral-100 text-neutral-400"),children:(0,a.jsx)(i.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-neutral-500 text-xs font-medium uppercase tracking-widest",children:"Balance Due"}),(0,a.jsxs)("h3",{className:"text-2xl font-black text-neutral-900 dark:text-white",children:[C.toFixed(2)," RON"]})]})]}),(0,a.jsx)("div",{className:"p-2 bg-white dark:bg-neutral-800 rounded-xl shadow-sm group-hover:translate-x-1 transition-transform",children:(0,a.jsx)(l.Z,{className:"w-5 h-5 text-neutral-400"})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 p-5 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-success-50 dark:bg-success-900/20 rounded-xl flex items-center justify-center text-success-600 mb-3",children:(0,a.jsx)(d.Z,{className:"w-5 h-5"})}),(0,a.jsx)("p",{className:"text-neutral-500 text-xs font-medium",children:"Overall Progress"}),(0,a.jsxs)("h3",{className:"text-2xl font-bold text-neutral-900 dark:text-white mt-1",children:[r.progress||0,"%"]}),(0,a.jsx)("p",{className:"text-[10px] text-success-600 font-bold mt-1",children:"+4% this month"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 p-5 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-secondary-50 dark:bg-secondary-900/20 rounded-xl flex items-center justify-center text-secondary-600 mb-3",children:(0,a.jsx)(n.Z,{className:"w-5 h-5"})}),(0,a.jsx)("p",{className:"text-neutral-500 text-xs font-medium",children:"Sessions (Feb)"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-neutral-900 dark:text-white mt-1",children:P.length}),(0,a.jsxs)("p",{className:"text-[10px] text-neutral-400 font-bold mt-1",children:[T.length," completed"]})]})]}),(0,a.jsx)(x.Z,{clientName:r.name}),(0,a.jsx)(m.Z,{event:N,isOpen:k,onClose:()=>S(!1)})]})}},82924:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var a=r(3827),n=r(64090),l=r(8792),s=r(97307),i=r(46578),d=r(10527),o=r(69475),c=r(43345),u=r(37805),m=r(14589),x=r(20854);let h={schedule:s.Z,attendance:i.Z,billing:d.Z,client:o.Z,team:o.Z,system:c.Z};function g(e){let{clientName:t}=e,{notifications:r,loading:s,markAsRead:i}=(0,x.useNotifications)(),d=(0,n.useMemo)(()=>r.slice(0,3),[r]);if(s)return(0,a.jsxs)("section",{className:"px-4 space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Recent Alerts"})}),(0,a.jsx)("div",{className:"space-y-3 pb-8",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-neutral-900 p-4 rounded-2xl border border-neutral-200 dark:border-neutral-800 animate-pulse",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-neutral-200 dark:bg-neutral-700 rounded-xl"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-full"})]})]})},e))})]});if(0===d.length)return(0,a.jsxs)("section",{className:"px-4 space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Recent Alerts"})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-900 p-6 rounded-2xl border border-neutral-200 dark:border-neutral-800 text-center",children:[(0,a.jsx)(c.Z,{className:"w-10 h-10 text-neutral-300 dark:text-neutral-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"No notifications yet"}),(0,a.jsx)("p",{className:"text-xs text-neutral-400 dark:text-neutral-500 mt-1",children:"You'll see updates about schedules and billing here"})]})]});let o=async e=>{let t=d.find(t=>t.id===e);t&&!t.read&&await i(e)};return(0,a.jsxs)("section",{className:"px-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-bold text-neutral-900 dark:text-white",children:"Recent Alerts"}),(0,a.jsx)(l.default,{href:"/parent/schedule/",className:"text-sm font-bold text-primary-600 hover:text-primary-700 dark:hover:text-primary-400",children:"View All"})]}),(0,a.jsx)("div",{className:"space-y-3 pb-8",children:d.map(e=>{var t,r,n;let s=h[e.category]||c.Z,i=m.p[e.category],d=(null===(r=e.actions)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.route)||"/parent/schedule/";return(0,a.jsxs)(l.default,{href:d,onClick:()=>o(e.id),className:"\n                bg-white dark:bg-neutral-900 p-4 rounded-2xl border shadow-sm flex items-start gap-4\n                hover:border-primary-200 dark:hover:border-primary-800 transition-colors group\n                ".concat(e.read?"border-neutral-200 dark:border-neutral-800":"border-primary-200 dark:border-primary-800/50 bg-primary-50/30 dark:bg-primary-900/10","\n              "),children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ".concat(i.bgColor),children:(0,a.jsx)(s,{className:"w-6 h-6 ".concat(i.color)})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-1",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-neutral-900 dark:text-white",children:e.title}),(0,a.jsx)("span",{className:"text-xs text-neutral-400 dark:text-neutral-500 whitespace-nowrap",children:(0,m.S)(e.createdAt)})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 line-clamp-2",children:e.message}),(null===(n=e.actions)||void 0===n?void 0:n[0])&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-1 text-xs font-medium text-primary-600 dark:text-primary-400 group-hover:underline",children:[e.actions[0].label,(0,a.jsx)(u.Z,{className:"w-3 h-3"})]})]})]},e.id)})})]})}},18628:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return c},useAuth:function(){return u}});var a=r(3827),n=r(64090),l=r(27065),s=r(1221),i=r(58121),d=r(47907);let o=(0,n.createContext)({});function c(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[u,m]=(0,n.useState)(null),[x,h]=(0,n.useState)(null),[g,f]=(0,n.useState)(!0),b=(0,d.useRouter)();(0,n.useEffect)(()=>{let e=null,t=(0,l.Aj)(s.I,async t=>{c(t),e&&(e(),e=null),t?e=(0,i.cf)((0,i.JU)(s.db,"team_members",t.uid),e=>{if(e.exists()){let t=e.data();m(t),h(t.role),f(!1)}else(0,i.cf)((0,i.JU)(s.db,"clients",t.uid),e=>{e.exists()?(m(e.data()),h("Parent")):(m(null),h(null)),f(!1)})}):(m(null),h(null),f(!1))});return()=>{t(),e&&e()}},[b]);let p=async(e,t)=>{await (0,l.e5)(s.I,e,t)},v=async()=>{await (0,l.w7)(s.I),b.push("/login")};return(0,a.jsx)(o.Provider,{value:{user:r,userData:u,userRole:x,loading:g,signIn:p,signOut:v},children:!g&&t})}let u=()=>(0,n.useContext)(o)},20854:function(e,t,r){"use strict";r.r(t),r.d(t,{NotificationProvider:function(){return c},useNotifications:function(){return u}});var a=r(3827),n=r(64090),l=r(58121),s=r(1221),i=r(18628),d=r(10207);let o=(0,n.createContext)(void 0);function c(e){let{children:t}=e,{user:r}=function(){let e=(0,i.useAuth)(),t=(0,d.Sp)();return(null==e?void 0:e.user)&&!e.loading?{user:e.user,isParent:!1,isStaff:!0,loading:!1}:(null==t?void 0:t.user)&&t.isAuthenticated&&!t.loading?{user:t.user,isParent:!0,isStaff:!1,loading:!1}:{user:null,isParent:!1,isStaff:!1,loading:(null==e?void 0:e.loading)||(null==t?void 0:t.loading)||!1}}(),[c,u]=(0,n.useState)([]),[m,x]=(0,n.useState)(!0),[h,g]=(0,n.useState)(null),[f,b]=(0,n.useState)(!0),[p,v]=(0,n.useState)(null),[w,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!r){u([]),x(!1);return}x(!0);let e=(0,l.IO)((0,l.hJ)(s.db,"notifications"),(0,l.ar)("recipientId","==",r.uid),(0,l.Xo)("createdAt","desc"),(0,l.b9)(20)),t=(0,l.cf)(e,e=>{u(e.docs.map(e=>{var t,r,a;return{id:e.id,...e.data(),createdAt:(null===(a=e.data().createdAt)||void 0===a?void 0:null===(r=a.toDate)||void 0===r?void 0:null===(t=r.call(a))||void 0===t?void 0:t.toISOString())||e.data().createdAt}})),x(!1),g(null),b(20===e.docs.length),v(e.docs[e.docs.length-1]||null)},e=>{console.error("Error fetching notifications:",e),g(e.message),x(!1)});return()=>t()},[r]);let N=(0,n.useMemo)(()=>c.filter(e=>!e.read).length,[c]),y=(0,n.useCallback)(async e=>{await (0,l.r7)((0,l.JU)(s.db,"notifications",e),{read:!0,readAt:l.EK.now()})},[]),k=(0,n.useCallback)(async()=>{let e=c.filter(e=>!e.read);await Promise.all(e.map(e=>(0,l.r7)((0,l.JU)(s.db,"notifications",e.id),{read:!0,readAt:l.EK.now()})))},[c]),S=(0,n.useCallback)(e=>"all"===e?c:"unread"===e?c.filter(e=>!e.read):c.filter(t=>t.category===e),[c]),C=(0,n.useCallback)(e=>"all"===e?c.length:"unread"===e?c.filter(e=>!e.read).length:c.filter(t=>t.category===e).length,[c]),A=(0,n.useCallback)(e=>{let t=e||c,r=new Date,a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),n=new Date(a.getTime()-864e5),l=new Date(a.getTime()-6048e5),s={today:[],yesterday:[],thisWeek:[],older:[]};return t.forEach(e=>{let t=new Date(e.createdAt);t>=a?s.today.push(e):t>=n?s.yesterday.push(e):t>=l?s.thisWeek.push(e):s.older.push(e)}),s},[c]),Z=(0,n.useCallback)(async()=>{if(!r||!p||!f)return;let e=(0,l.IO)((0,l.hJ)(s.db,"notifications"),(0,l.ar)("recipientId","==",r.uid),(0,l.Xo)("createdAt","desc"),(0,l.TQ)(p),(0,l.b9)(20)),t=await (0,l.PL)(e),a=t.docs.map(e=>{var t,r,a;return{id:e.id,...e.data(),createdAt:(null===(a=e.data().createdAt)||void 0===a?void 0:null===(r=a.toDate)||void 0===r?void 0:null===(t=r.call(a))||void 0===t?void 0:t.toISOString())||e.data().createdAt}});u(e=>[...e,...a]),b(20===t.docs.length),v(t.docs[t.docs.length-1]||null)},[r,p,f]);return(0,a.jsx)(o.Provider,{value:{notifications:c,unreadCount:N,loading:m,error:h,markAsRead:y,markAllAsRead:k,loadMore:Z,hasMore:f,isDropdownOpen:w,setDropdownOpen:j,filterByCategory:S,getGroupedNotifications:A,getCategoryCount:C},children:t})}function u(){let e=(0,n.useContext)(o);if(!e)throw Error("useNotifications must be used within NotificationProvider");return e}},10207:function(e,t,r){"use strict";r.d(t,{Sp:function(){return c},gx:function(){return o}});var a=r(3827),n=r(64090),l=r(27065),s=r(1221),i=r(58121);let d=(0,n.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,n.useState)(null),[c,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(null),[h,g]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,l.Aj)(s.I,async e=>{if(null==e?void 0:e.isAnonymous){o(e);let t=localStorage.getItem("parent_client_id"),r=localStorage.getItem("parent_client_name"),a=localStorage.getItem("parent_uid");t&&a===e.uid?(u(t),x(r)):(u(null),x(null))}else o(null),u(null),x(null);g(!1)});return()=>e()},[]);let f=(0,n.useCallback)(async(e,t)=>{try{let r=s.I.currentUser;r&&r.isAnonymous||(r=(await (0,l.XB)(s.I)).user);let a=(0,i.JU)(s.db,"clients",e);await (0,i.r7)(a,{parentUids:(0,i.vr)(r.uid)}),localStorage.setItem("parent_uid",r.uid),localStorage.setItem("parent_client_id",e),localStorage.setItem("parent_client_name",t),o(r),u(e),x(t),console.log("[ParentAuth] Successfully authenticated parent with UID:",r.uid)}catch(e){throw console.error("[ParentAuth] Error authenticating:",e),e}},[]),b=(0,n.useCallback)(async()=>{try{localStorage.removeItem("parent_uid"),localStorage.removeItem("parent_client_id"),localStorage.removeItem("parent_client_name"),localStorage.removeItem("parent_client_code"),await (0,l.w7)(s.I),o(null),u(null),x(null)}catch(e){console.error("[ParentAuth] Error signing out:",e)}},[]);return(0,a.jsx)(d.Provider,{value:{user:r,clientId:c,clientName:m,loading:h,isAuthenticated:null!==r&&null!==c,authenticateWithCode:f,signOut:b},children:t})}function c(){return(0,n.useContext)(d)}},14589:function(e,t,r){"use strict";r.d(t,{S:function(){return n},p:function(){return a}});let a={schedule:{label:"Schedule",color:"text-primary-500",bgColor:"bg-primary-100 dark:bg-primary-900/30",iconName:"Calendar"},attendance:{label:"Attendance",color:"text-success-500",bgColor:"bg-success-100 dark:bg-success-900/30",iconName:"CheckCircle"},team:{label:"Team",color:"text-purple-500",bgColor:"bg-purple-100 dark:bg-purple-900/30",iconName:"Users"},billing:{label:"Billing",color:"text-warning-500",bgColor:"bg-warning-100 dark:bg-warning-900/30",iconName:"CreditCard"},client:{label:"Client",color:"text-teal-500",bgColor:"bg-teal-100 dark:bg-teal-900/30",iconName:"User"},system:{label:"System",color:"text-error-500",bgColor:"bg-error-100 dark:bg-error-900/30",iconName:"AlertTriangle"}};function n(e){let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/1e3),a=Math.floor(r/60),n=Math.floor(a/60),l=Math.floor(n/24);return r<60?"Just now":a<60?"".concat(a,"m ago"):n<24?"".concat(n,"h ago"):1===l?"Yesterday":l<7?"".concat(l,"d ago"):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}},function(e){e.O(0,[358,139,373,258,901,993,971,69,744],function(){return e(e.s=14023)}),_N_E=e.O()}]);